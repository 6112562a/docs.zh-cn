---
title: 优化性能：二维图形和图像处理
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- graphics [WPF], performance
- drawing [WPF], optimizing performance
- imaging [WPF], optimizing performance
- shapes [WPF], optimizing performance
- 2D graphics [WPF]
- images [WPF], optimizing performance
ms.assetid: e335601e-28c8-4d64-ba27-778fffd55f72
ms.openlocfilehash: 59ac7a5aa8b0591c51cdb6ee0d6435649e22fade
ms.sourcegitcommit: 267d092663aba36b6b2ea853034470aea493bfae
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/21/2020
ms.locfileid: "80111213"
---
# <a name="optimizing-performance-2d-graphics-and-imaging"></a><span data-ttu-id="1d3d5-102">优化性能：二维图形和图像处理</span><span class="sxs-lookup"><span data-stu-id="1d3d5-102">Optimizing Performance: 2D Graphics and Imaging</span></span>
[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="1d3d5-103">提供了多种可按应用程序要求进行优化的二维图形和图像处理功能。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-103">provides a wide range of 2D graphics and imaging functionality that can be optimized for your application requirements.</span></span> <span data-ttu-id="1d3d5-104">本主题提供有关这些方面性能优化的信息。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-104">This topic provides information about performance optimization in those areas.</span></span>  

<a name="Drawing_and_Shapes"></a>
## <a name="drawing-and-shapes"></a><span data-ttu-id="1d3d5-105">绘图和形状</span><span class="sxs-lookup"><span data-stu-id="1d3d5-105">Drawing and Shapes</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="1d3d5-106">提供<xref:System.Windows.Media.Drawing>和<xref:System.Windows.Shapes.Shape>对象来表示图形绘图内容。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-106">provides both <xref:System.Windows.Media.Drawing> and <xref:System.Windows.Shapes.Shape> objects to represent graphical drawing content.</span></span> <span data-ttu-id="1d3d5-107">但是，<xref:System.Windows.Media.Drawing>对象比<xref:System.Windows.Shapes.Shape>对象更简单的构造，并提供更好的性能特征。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-107">However, <xref:System.Windows.Media.Drawing> objects are simpler constructs than <xref:System.Windows.Shapes.Shape> objects and provide better performance characteristics.</span></span>  
  
 <span data-ttu-id="1d3d5-108">A<xref:System.Windows.Shapes.Shape>允许您将图形形状绘制到屏幕。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-108">A <xref:System.Windows.Shapes.Shape> allows you to draw a graphical shape to the screen.</span></span> <span data-ttu-id="1d3d5-109">由于对象派生自类，<xref:System.Windows.FrameworkElement><xref:System.Windows.Shapes.Shape>因此可以在面板和大多数控件内使用对象。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-109">Because they are derived from the <xref:System.Windows.FrameworkElement> class, <xref:System.Windows.Shapes.Shape> objects can be used inside panels and most controls.</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="1d3d5-110">为图形和绘制服务提供多层访问。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-110">offers several layers of access to graphics and rendering services.</span></span> <span data-ttu-id="1d3d5-111">在顶层，<xref:System.Windows.Shapes.Shape>对象易于使用，并提供许多有用的功能，如布局和事件处理。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-111">At the top layer, <xref:System.Windows.Shapes.Shape> objects are easy to use and provide many useful features, such as layout and event handling.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="1d3d5-112">提供了许多现成可用的形状对象。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-112">provides a number of ready-to-use shape objects.</span></span> <span data-ttu-id="1d3d5-113">所有形状对象都从<xref:System.Windows.Shapes.Shape>类继承。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-113">All shape objects inherit from the <xref:System.Windows.Shapes.Shape> class.</span></span> <span data-ttu-id="1d3d5-114">可用的形状对象包括<xref:System.Windows.Shapes.Ellipse> <xref:System.Windows.Shapes.Line> <xref:System.Windows.Shapes.Path>、、、<xref:System.Windows.Shapes.Polygon><xref:System.Windows.Shapes.Polyline>和<xref:System.Windows.Shapes.Rectangle>。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-114">Available shape objects include <xref:System.Windows.Shapes.Ellipse>, <xref:System.Windows.Shapes.Line>, <xref:System.Windows.Shapes.Path>, <xref:System.Windows.Shapes.Polygon>, <xref:System.Windows.Shapes.Polyline>, and <xref:System.Windows.Shapes.Rectangle>.</span></span>  
  
 <span data-ttu-id="1d3d5-115"><xref:System.Windows.Media.Drawing>另一方面，对象不派生自类<xref:System.Windows.FrameworkElement>，并为渲染形状、图像和文本提供较轻的实现。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-115"><xref:System.Windows.Media.Drawing> objects, on the other hand, do not derive from the <xref:System.Windows.FrameworkElement> class and provide a lighter-weight implementation for rendering shapes, images, and text.</span></span>  
  
 <span data-ttu-id="1d3d5-116">有四种类型的<xref:System.Windows.Media.Drawing>对象：</span><span class="sxs-lookup"><span data-stu-id="1d3d5-116">There are four types of <xref:System.Windows.Media.Drawing> objects:</span></span>  
  
- <span data-ttu-id="1d3d5-117"><xref:System.Windows.Media.GeometryDrawing>绘制形状。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-117"><xref:System.Windows.Media.GeometryDrawing> Draws a shape.</span></span>  
  
- <span data-ttu-id="1d3d5-118"><xref:System.Windows.Media.ImageDrawing>绘制图像。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-118"><xref:System.Windows.Media.ImageDrawing> Draws an image.</span></span>  
  
- <span data-ttu-id="1d3d5-119"><xref:System.Windows.Media.GlyphRunDrawing>绘制文本。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-119"><xref:System.Windows.Media.GlyphRunDrawing> Draws text.</span></span>  
  
- <span data-ttu-id="1d3d5-120"><xref:System.Windows.Media.DrawingGroup>绘制其他图形。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-120"><xref:System.Windows.Media.DrawingGroup> Draws other drawings.</span></span> <span data-ttu-id="1d3d5-121">使用图形组将其他图形合并到单个复合图形。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-121">Use a drawing group to combine other drawings into a single composite drawing.</span></span>  
  
 <span data-ttu-id="1d3d5-122">该<xref:System.Windows.Media.GeometryDrawing>对象用于渲染几何内容。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-122">The <xref:System.Windows.Media.GeometryDrawing> object is used to render geometry content.</span></span> <span data-ttu-id="1d3d5-123">从<xref:System.Windows.Media.Geometry>它派生的类和具体类（如<xref:System.Windows.Media.CombinedGeometry>和<xref:System.Windows.Media.EllipseGeometry> <xref:System.Windows.Media.PathGeometry>）提供了一种渲染 2D 图形以及提供命中测试和剪切支持的方法。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-123">The <xref:System.Windows.Media.Geometry> class and the concrete classes which derive from it, such as <xref:System.Windows.Media.CombinedGeometry>, <xref:System.Windows.Media.EllipseGeometry>, and <xref:System.Windows.Media.PathGeometry>, provide a means for rendering 2D graphics, as well as providing hit-testing and clipping support.</span></span> <span data-ttu-id="1d3d5-124">几何对象可用于定义控件的区域或定义应用于图像的剪裁区域等。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-124">Geometry objects can be used to define the region of a control, for example, or to define the clip region to apply to an image.</span></span> <span data-ttu-id="1d3d5-125">几何对象可以是简单区域（例如矩形和圆形），或者是由两个或多个几何对象创建的复合区域。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-125">Geometry objects can be simple regions, such as rectangles and circles, or composite regions created from two or more geometry objects.</span></span> <span data-ttu-id="1d3d5-126">可以通过组合<xref:System.Windows.Media.PathSegment>派生对象（如<xref:System.Windows.Media.ArcSegment>、<xref:System.Windows.Media.BezierSegment>和<xref:System.Windows.Media.QuadraticBezierSegment>）来创建更复杂的几何区域。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-126">More complex geometric regions can be created by combining <xref:System.Windows.Media.PathSegment>-derived objects, such as <xref:System.Windows.Media.ArcSegment>, <xref:System.Windows.Media.BezierSegment>, and <xref:System.Windows.Media.QuadraticBezierSegment>.</span></span>  
  
 <span data-ttu-id="1d3d5-127">从表面上看，<xref:System.Windows.Media.Geometry>类和<xref:System.Windows.Shapes.Shape>类非常相似。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-127">On the surface, the <xref:System.Windows.Media.Geometry> class and the <xref:System.Windows.Shapes.Shape> class are quite similar.</span></span> <span data-ttu-id="1d3d5-128">两者都用于 2D 图形的渲染，并且都有从它们派生的类似具体类，例如 和<xref:System.Windows.Media.EllipseGeometry><xref:System.Windows.Shapes.Ellipse>。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-128">Both are used in the rendering of 2D graphics and both have similar concrete classes which derive from them, for example, <xref:System.Windows.Media.EllipseGeometry> and <xref:System.Windows.Shapes.Ellipse>.</span></span> <span data-ttu-id="1d3d5-129">但是，这两个类集之间存在重大区别。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-129">However, there are important differences between these two sets of classes.</span></span> <span data-ttu-id="1d3d5-130">首先，<xref:System.Windows.Media.Geometry>类缺乏<xref:System.Windows.Shapes.Shape>类的某些功能，例如绘制自身的能力。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-130">For one, the <xref:System.Windows.Media.Geometry> class lacks some of the functionality of the <xref:System.Windows.Shapes.Shape> class, such as the ability to draw itself.</span></span> <span data-ttu-id="1d3d5-131">若要绘制几何对象，必须使用另一个类（例如 DrawingContext、Drawing 或 Path（值得注意的是 Path 是一个 Shape））来执行绘制操作。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-131">To draw a geometry object, another class such as DrawingContext, Drawing, or a Path (it is worth noting that a Path is a Shape) must be used to perform the drawing operation.</span></span> <span data-ttu-id="1d3d5-132">填充、笔划和笔划粗细等绘制属性位于绘制几何对象的类上，而形状对象中包含这些属性。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-132">Rendering properties such as fill, stroke, and the stroke thickness are on the class which draws the geometry object, while a shape object contains these properties.</span></span> <span data-ttu-id="1d3d5-133">可以这样来理解这种差别：几何对象定义区域（例如圆形），而形状对象定义区域、定义如何填充区域和设置区域边框并参与布局系统。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-133">One way to think of this difference is that a geometry object defines a region, a circle for example, while a shape object defines a region, defines how that region is filled and outlined, and participates in the layout system.</span></span>  
  
 <span data-ttu-id="1d3d5-134">由于<xref:System.Windows.Shapes.Shape>对象派生自类<xref:System.Windows.FrameworkElement>，因此使用它们可以在应用程序中显著增加更多的内存消耗。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-134">Since <xref:System.Windows.Shapes.Shape> objects derive from the <xref:System.Windows.FrameworkElement> class, using them can add significantly more memory consumption in your application.</span></span> <span data-ttu-id="1d3d5-135">如果真的不需要图形内容的功能，<xref:System.Windows.FrameworkElement>请考虑使用较轻<xref:System.Windows.Media.Drawing>的对象。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-135">If you really do not need the <xref:System.Windows.FrameworkElement> features for your graphical content, consider using the lighter-weight <xref:System.Windows.Media.Drawing> objects.</span></span>  
  
 <span data-ttu-id="1d3d5-136">有关<xref:System.Windows.Media.Drawing>对象的详细信息，请参阅[绘制对象概述](../graphics-multimedia/drawing-objects-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-136">For more information on <xref:System.Windows.Media.Drawing> objects, see [Drawing Objects Overview](../graphics-multimedia/drawing-objects-overview.md).</span></span>  
  
<a name="StreamGeometry_Objects"></a>
## <a name="streamgeometry-objects"></a><span data-ttu-id="1d3d5-137">StreamGeometry 对象</span><span class="sxs-lookup"><span data-stu-id="1d3d5-137">StreamGeometry Objects</span></span>  
 <span data-ttu-id="1d3d5-138">该<xref:System.Windows.Media.StreamGeometry>对象是创建几何形状的轻量级<xref:System.Windows.Media.PathGeometry>替代方法。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-138">The <xref:System.Windows.Media.StreamGeometry> object is a lightweight alternative to <xref:System.Windows.Media.PathGeometry> for creating geometric shapes.</span></span> <span data-ttu-id="1d3d5-139">当您需要<xref:System.Windows.Media.StreamGeometry>描述复杂的几何体时，请使用 。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-139">Use a <xref:System.Windows.Media.StreamGeometry> when you need to describe a complex geometry.</span></span> <span data-ttu-id="1d3d5-140"><xref:System.Windows.Media.StreamGeometry>针对处理许多<xref:System.Windows.Media.PathGeometry>对象进行了优化，与使用许多单个<xref:System.Windows.Media.PathGeometry>对象相比，性能更好。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-140"><xref:System.Windows.Media.StreamGeometry> is optimized for handling many <xref:System.Windows.Media.PathGeometry> objects and performs better when compared to using many individual <xref:System.Windows.Media.PathGeometry> objects.</span></span>  
  
 <span data-ttu-id="1d3d5-141">下面的示例使用属性语法在 中<xref:System.Windows.Media.StreamGeometry>[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]创建三角形。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-141">The following example uses attribute syntax to create a triangular <xref:System.Windows.Media.StreamGeometry> in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span>  
  
 [!code-xaml[GeometriesMiscSnippets_snip#StreamGeometryTriangleExampleWholePage](~/samples/snippets/xaml/VS_Snippets_Wpf/GeometriesMiscSnippets_snip/XAML/StreamGeometryExample.xaml#streamgeometrytriangleexamplewholepage)]  
  
 <span data-ttu-id="1d3d5-142">有关<xref:System.Windows.Media.StreamGeometry>对象的详细信息，请参阅[使用流几何创建形状](../graphics-multimedia/how-to-create-a-shape-using-a-streamgeometry.md)。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-142">For more information on <xref:System.Windows.Media.StreamGeometry> objects, see [Create a Shape Using a StreamGeometry](../graphics-multimedia/how-to-create-a-shape-using-a-streamgeometry.md).</span></span>  
  
<a name="DrawingVisual_Objects"></a>
## <a name="drawingvisual-objects"></a><span data-ttu-id="1d3d5-143">DrawingVisual 对象</span><span class="sxs-lookup"><span data-stu-id="1d3d5-143">DrawingVisual Objects</span></span>  
 <span data-ttu-id="1d3d5-144">该<xref:System.Windows.Media.DrawingVisual>对象是一个轻量级绘图类，用于渲染形状、图像或文本。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-144">The <xref:System.Windows.Media.DrawingVisual> object is a lightweight drawing class that is used to render shapes, images, or text.</span></span> <span data-ttu-id="1d3d5-145">此类之所以为轻量类是因为它不提供布局或事件处理，从而性能得以提升。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-145">This class is considered lightweight because it does not provide layout or event handling, which improves its performance.</span></span> <span data-ttu-id="1d3d5-146">因此，绘图非常适用于背景和剪贴画。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-146">For this reason, drawings are ideal for backgrounds and clip art.</span></span> <span data-ttu-id="1d3d5-147">有关详细信息，请参阅[使用 DrawingVisual 对象](../graphics-multimedia/using-drawingvisual-objects.md)。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-147">For more information, see [Using DrawingVisual Objects](../graphics-multimedia/using-drawingvisual-objects.md).</span></span>  
  
<a name="Images"></a>
## <a name="images"></a><span data-ttu-id="1d3d5-148">映像</span><span class="sxs-lookup"><span data-stu-id="1d3d5-148">Images</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="1d3d5-149">与早期版本的 Windows 中的映像功能相比，映像提供了显著改进。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-149">imaging provides a significant improvement over the imaging capabilities in previous versions of Windows.</span></span> <span data-ttu-id="1d3d5-150">显示位图或在公共控件上使用图像等图像处理功能以前主要由 Microsoft Windows 图形设备接口 (GDI) 或Microsoft Windows GDI+ 应用程序编程接口 (API) 处理。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-150">Imaging capabilities, such as displaying a bitmap or using an image on a common control were primarily handled by the Microsoft Windows Graphics Device Interface (GDI) or Microsoft Windows GDI+ application programming interface (API).</span></span> <span data-ttu-id="1d3d5-151">这些 API 提供基线图像处理功能，但缺少编解码器扩展性支持和高保真图像支持等功能。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-151">These API provided baseline imaging functionality, but lacked features such as support for codec extensibility and high fidelity image support.</span></span> <span data-ttu-id="1d3d5-152">WPF 图像处理 API 已经过重新设计，克服了 GDI 和 GDI+ 的缺点，提供新的 API 集以在应用程序内显示和使用图像。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-152">WPF Imaging API have been redesigned to overcome the shortcomings of GDI and GDI+ and provide a new set of API to display and use images within your applications.</span></span>  
  
 <span data-ttu-id="1d3d5-153">使用图像时，为使性能更佳，请考虑以下建议：</span><span class="sxs-lookup"><span data-stu-id="1d3d5-153">When using images, consider the following recommendations for gaining better performance:</span></span>  
  
- <span data-ttu-id="1d3d5-154">如果应用程序要求显示缩略图，请考虑创建一个缩略版图像。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-154">If your application requires you to display thumbnail images, consider creating a reduced-sized version of the image.</span></span> <span data-ttu-id="1d3d5-155">默认情况下，[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 会加载图像并将其解码到最大尺寸。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-155">By default, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] loads your image and decodes it to its full size.</span></span> <span data-ttu-id="1d3d5-156">如果仅需要缩略版本图像，[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 会先将图像解码为完整尺寸，然后将其缩放为缩略图大小，这个过程是多余的。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-156">If you only want a thumbnail version of the image, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] unnecessary decodes the image to its full-size and then scales it down to a thumbnail size.</span></span> <span data-ttu-id="1d3d5-157">若要避免此多余的过程，可请求 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 将图像解码到缩略图大小，或者请求 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 加载缩略图大小的图像。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-157">To avoid this unnecessary overhead, you can either request [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] to decode the image to a thumbnail size, or request [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] to load a thumbnail size image.</span></span>  
  
- <span data-ttu-id="1d3d5-158">请务必将图像解码到所需大小而不是默认大小。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-158">Always decode the image to desired size and not to the default size.</span></span> <span data-ttu-id="1d3d5-159">如上所述，请求 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 将图像解码为所需大小而不是默认的最大尺寸。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-159">As mentioned above, request [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] to decode your image to a desired size and not the default full size.</span></span> <span data-ttu-id="1d3d5-160">这样不仅会减小应用程序的工作集，还会减慢其执行速度。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-160">You will reduce not only your application's working set, but execution speed as well.</span></span>  
  
- <span data-ttu-id="1d3d5-161">如果可能，请将多个图像合并到单个图像中，例如由多个图像构成的胶卷条。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-161">If possible, combine the images into a single image, such as a film strip composed of multiple images.</span></span>  
  
- <span data-ttu-id="1d3d5-162">有关详细信息，请参阅 [图像概述](../graphics-multimedia/imaging-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-162">For more information, see [Imaging Overview](../graphics-multimedia/imaging-overview.md).</span></span>  
  
### <a name="bitmapscalingmode"></a><span data-ttu-id="1d3d5-163">BitmapScalingMode</span><span class="sxs-lookup"><span data-stu-id="1d3d5-163">BitmapScalingMode</span></span>  
 <span data-ttu-id="1d3d5-164">对任何位图缩放进行动画处理时，默认高质量图像重采样算法有时可能由于消耗过多系统资源导致帧速率下降，从而导致动画明显变慢。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-164">When animating the scale of any bitmap, the default high-quality image re-sampling algorithm can sometimes consume sufficient system resources to cause frame rate degradation, effectively causing animations to stutter.</span></span> <span data-ttu-id="1d3d5-165">通过将<xref:System.Windows.Media.RenderOptions.BitmapScalingMode%2A><xref:System.Windows.Media.RenderOptions>对象的属性设置为，<xref:System.Windows.Media.BitmapScalingMode.LowQuality>您可以在缩放位图时创建更平滑的动画。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-165">By setting the <xref:System.Windows.Media.RenderOptions.BitmapScalingMode%2A> property of the <xref:System.Windows.Media.RenderOptions> object to <xref:System.Windows.Media.BitmapScalingMode.LowQuality> you can create a smoother animation when scaling a bitmap.</span></span> <span data-ttu-id="1d3d5-166"><xref:System.Windows.Media.BitmapScalingMode.LowQuality>模式告诉渲[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]染引擎在处理图像时从质量优化算法切换到速度优化算法。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-166"><xref:System.Windows.Media.BitmapScalingMode.LowQuality> mode tells the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] rendering engine to switch from a quality-optimized algorithm to a speed-optimized algorithm when processing images.</span></span>  
  
 <span data-ttu-id="1d3d5-167">下面的示例演示如何为图像对象设置<xref:System.Windows.Media.BitmapScalingMode>。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-167">The following example shows how to set the <xref:System.Windows.Media.BitmapScalingMode> for an image object.</span></span>  
  
 [!code-csharp[RenderOptions#RenderOptionsSnippet2](~/samples/snippets/csharp/VS_Snippets_Wpf/RenderOptions/CSharp/Window1.xaml.cs#renderoptionssnippet2)]
 [!code-vb[RenderOptions#RenderOptionsSnippet2](~/samples/snippets/visualbasic/VS_Snippets_Wpf/RenderOptions/visualbasic/window1.xaml.vb#renderoptionssnippet2)]  
  
### <a name="cachinghint"></a><span data-ttu-id="1d3d5-168">CachingHint</span><span class="sxs-lookup"><span data-stu-id="1d3d5-168">CachingHint</span></span>  
 <span data-ttu-id="1d3d5-169">默认情况下，[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]不缓存<xref:System.Windows.Media.TileBrush>对象的呈现内容，如<xref:System.Windows.Media.DrawingBrush>和<xref:System.Windows.Media.VisualBrush>。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-169">By default, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] does not cache the rendered contents of <xref:System.Windows.Media.TileBrush> objects, such as <xref:System.Windows.Media.DrawingBrush> and <xref:System.Windows.Media.VisualBrush>.</span></span> <span data-ttu-id="1d3d5-170">在场景中的内容或使用<xref:System.Windows.Media.TileBrush>都不在变化的静态方案中，这是有道理的，因为它可以节省视频内存。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-170">In static scenarios where neither the contents nor use of the <xref:System.Windows.Media.TileBrush> in the scene is changing, this makes sense, since it conserves video memory.</span></span> <span data-ttu-id="1d3d5-171">当以非静态方式使用<xref:System.Windows.Media.TileBrush>具有静态内容的内容时，例如，当静态<xref:System.Windows.Media.DrawingBrush>或<xref:System.Windows.Media.VisualBrush>映射到旋转 3D 对象的表面时，则没有意义。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-171">It does not make as much sense when a <xref:System.Windows.Media.TileBrush> with static content is used in a non-static way—for example, when a static <xref:System.Windows.Media.DrawingBrush> or <xref:System.Windows.Media.VisualBrush> is mapped to the surface of a rotating 3D object.</span></span> <span data-ttu-id="1d3d5-172">的[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]默认行为是重新呈现<xref:System.Windows.Media.DrawingBrush>或<xref:System.Windows.Media.VisualBrush>每个帧的整个内容，即使内容不变。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-172">The default behavior of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is to re-render the entire content of the <xref:System.Windows.Media.DrawingBrush> or <xref:System.Windows.Media.VisualBrush> for every frame, even though the content is unchanging.</span></span>  
  
 <span data-ttu-id="1d3d5-173">通过将<xref:System.Windows.Media.RenderOptions.CachingHint%2A><xref:System.Windows.Media.RenderOptions>对象的属性设置为<xref:System.Windows.Media.CachingHint.Cache>，可以使用平铺画笔对象的缓存版本来提高性能。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-173">By setting the <xref:System.Windows.Media.RenderOptions.CachingHint%2A> property of the <xref:System.Windows.Media.RenderOptions> object to <xref:System.Windows.Media.CachingHint.Cache> you can increase performance by using cached versions of the tiled brush objects.</span></span>  
  
 <span data-ttu-id="1d3d5-174">和 属性值是相对大小值，用于确定何时<xref:System.Windows.Media.TileBrush>应由于比例变化而重新生成对象。 <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMaximum%2A> <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMinimum%2A></span><span class="sxs-lookup"><span data-stu-id="1d3d5-174">The <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMinimum%2A> and <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMaximum%2A> property values are relative size values that determine when the <xref:System.Windows.Media.TileBrush> object should be regenerated due to changes in scale.</span></span> <span data-ttu-id="1d3d5-175">例如，通过将<xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMaximum%2A>属性设置为 2.0，仅当其大小超过当前缓存<xref:System.Windows.Media.TileBrush>大小的两倍时，才需要重新生成 该属性的缓存。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-175">For example, by setting the <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMaximum%2A> property to 2.0, the cache for the <xref:System.Windows.Media.TileBrush> only needs to be regenerated when its size exceeds twice the size of the current cache.</span></span>  
  
 <span data-ttu-id="1d3d5-176">下面的示例演示如何对 使用 缓存提示选项<xref:System.Windows.Media.DrawingBrush>。</span><span class="sxs-lookup"><span data-stu-id="1d3d5-176">The following example shows how to use the caching hint option for a <xref:System.Windows.Media.DrawingBrush>.</span></span>  
  
 [!code-csharp[RenderOptions#RenderOptionsSnippet3](~/samples/snippets/csharp/VS_Snippets_Wpf/RenderOptions/CSharp/Window1.xaml.cs#renderoptionssnippet3)]
 [!code-vb[RenderOptions#RenderOptionsSnippet3](~/samples/snippets/visualbasic/VS_Snippets_Wpf/RenderOptions/visualbasic/window1.xaml.vb#renderoptionssnippet3)]  
  
## <a name="see-also"></a><span data-ttu-id="1d3d5-177">另请参阅</span><span class="sxs-lookup"><span data-stu-id="1d3d5-177">See also</span></span>

- [<span data-ttu-id="1d3d5-178">优化 WPF 应用程序性能</span><span class="sxs-lookup"><span data-stu-id="1d3d5-178">Optimizing WPF Application Performance</span></span>](optimizing-wpf-application-performance.md)
- [<span data-ttu-id="1d3d5-179">规划应用程序性能</span><span class="sxs-lookup"><span data-stu-id="1d3d5-179">Planning for Application Performance</span></span>](planning-for-application-performance.md)
- [<span data-ttu-id="1d3d5-180">利用硬件</span><span class="sxs-lookup"><span data-stu-id="1d3d5-180">Taking Advantage of Hardware</span></span>](optimizing-performance-taking-advantage-of-hardware.md)
- [<span data-ttu-id="1d3d5-181">布局和设计</span><span class="sxs-lookup"><span data-stu-id="1d3d5-181">Layout and Design</span></span>](optimizing-performance-layout-and-design.md)
- [<span data-ttu-id="1d3d5-182">对象行为</span><span class="sxs-lookup"><span data-stu-id="1d3d5-182">Object Behavior</span></span>](optimizing-performance-object-behavior.md)
- [<span data-ttu-id="1d3d5-183">应用程序资源</span><span class="sxs-lookup"><span data-stu-id="1d3d5-183">Application Resources</span></span>](optimizing-performance-application-resources.md)
- [<span data-ttu-id="1d3d5-184">文本</span><span class="sxs-lookup"><span data-stu-id="1d3d5-184">Text</span></span>](optimizing-performance-text.md)
- [<span data-ttu-id="1d3d5-185">数据绑定</span><span class="sxs-lookup"><span data-stu-id="1d3d5-185">Data Binding</span></span>](optimizing-performance-data-binding.md)
- [<span data-ttu-id="1d3d5-186">其他性能建议</span><span class="sxs-lookup"><span data-stu-id="1d3d5-186">Other Performance Recommendations</span></span>](optimizing-performance-other-recommendations.md)
- [<span data-ttu-id="1d3d5-187">动画提示和技巧</span><span class="sxs-lookup"><span data-stu-id="1d3d5-187">Animation Tips and Tricks</span></span>](../graphics-multimedia/animation-tips-and-tricks.md)
