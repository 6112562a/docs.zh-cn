---
title: 优化性能：利用硬件
ms.date: 03/30/2017
helpviewer_keywords:
- graphics [WPF], performance
- hardware rendering pipeline [WPF]
- rendering tiers [WPF]
- graphics rendering tiers [WPF]
- graphics [WPF], rendering tiers
- software rendering pipeline [WPF]
ms.assetid: bfb89bae-7aab-4cac-a26c-a956eda8fce2
ms.openlocfilehash: 13812fa5429bbe33341e51e4b3be14fbbcb361cb
ms.sourcegitcommit: 4d8efe00f2e5ab42e598aff298d13b8c052d9593
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/16/2019
ms.locfileid: "68238455"
---
# <a name="optimizing-performance-taking-advantage-of-hardware"></a><span data-ttu-id="0af8d-102">优化性能：利用硬件</span><span class="sxs-lookup"><span data-stu-id="0af8d-102">Optimizing Performance: Taking Advantage of Hardware</span></span>
<span data-ttu-id="0af8d-103">内部体系结构[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]具有两个呈现管道、 硬件和软件。</span><span class="sxs-lookup"><span data-stu-id="0af8d-103">The internal architecture of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] has two rendering pipelines, hardware and software.</span></span> <span data-ttu-id="0af8d-104">本主题提供有关这些呈现管道，以帮助你做出有关您的应用程序的性能优化的信息。</span><span class="sxs-lookup"><span data-stu-id="0af8d-104">This topic provides information about these rendering pipelines to help you make decisions about performance optimizations of your applications.</span></span>  
  
## <a name="hardware-rendering-pipeline"></a><span data-ttu-id="0af8d-105">硬件呈现管道</span><span class="sxs-lookup"><span data-stu-id="0af8d-105">Hardware Rendering Pipeline</span></span>  
 <span data-ttu-id="0af8d-106">在确定的最重要因素之一[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]性能是它是呈现绑定 — 必须要呈现，成本更高性能的像素越多。</span><span class="sxs-lookup"><span data-stu-id="0af8d-106">One of the most important factors in determining [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] performance is that it is render bound—the more pixels you have to render, the greater the performance cost.</span></span> <span data-ttu-id="0af8d-107">但是，呈现的详细信息可以卸载到[!INCLUDE[TLA#tla_gpu](../../../../includes/tlasharptla-gpu-md.md)]，可以获得更多的性能优势。</span><span class="sxs-lookup"><span data-stu-id="0af8d-107">However, the more rendering that can be offloaded to the [!INCLUDE[TLA#tla_gpu](../../../../includes/tlasharptla-gpu-md.md)], the more performance benefits you can gain.</span></span> <span data-ttu-id="0af8d-108">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]应用程序的硬件呈现管道采用充分利用[!INCLUDE[TLA#tla_dx](../../../../includes/tlasharptla-dx-md.md)]功能支持的最少的硬件上[!INCLUDE[TLA#tla_dx](../../../../includes/tlasharptla-dx-md.md)]版本 7.0。</span><span class="sxs-lookup"><span data-stu-id="0af8d-108">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application hardware rendering pipeline takes full advantage of [!INCLUDE[TLA#tla_dx](../../../../includes/tlasharptla-dx-md.md)] features on hardware that supports a minimum of [!INCLUDE[TLA#tla_dx](../../../../includes/tlasharptla-dx-md.md)] version 7.0.</span></span> <span data-ttu-id="0af8d-109">支持的硬件可以获得更多优化[!INCLUDE[TLA#tla_dx](../../../../includes/tlasharptla-dx-md.md)]版本 7.0 和 PixelShader 2.0 + 功能。</span><span class="sxs-lookup"><span data-stu-id="0af8d-109">Further optimizations can be gained by hardware that supports [!INCLUDE[TLA#tla_dx](../../../../includes/tlasharptla-dx-md.md)] version 7.0 and PixelShader 2.0+ features.</span></span>  
  
## <a name="software-rendering-pipeline"></a><span data-ttu-id="0af8d-110">软件呈现管道</span><span class="sxs-lookup"><span data-stu-id="0af8d-110">Software Rendering Pipeline</span></span>  
 <span data-ttu-id="0af8d-111">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]软件呈现管道是完全受 CPU 限制。</span><span class="sxs-lookup"><span data-stu-id="0af8d-111">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] software rendering pipeline is entirely CPU bound.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="0af8d-112">充分利用 SSE 和 SSE2 指令的设置在 CPU 中来实现优化、 功能完备的软件光栅器。</span><span class="sxs-lookup"><span data-stu-id="0af8d-112">takes advantage of the SSE and SSE2 instruction sets in the CPU to implement an optimized, fully-featured software rasterizer.</span></span> <span data-ttu-id="0af8d-113">回退到软件是无缝应用程序功能不能使用硬件呈现管道呈现任何时间。</span><span class="sxs-lookup"><span data-stu-id="0af8d-113">Fallback to software is seamless any time application functionality cannot be rendered using the hardware rendering pipeline.</span></span>  
  
 <span data-ttu-id="0af8d-114">您会遇到的最大的性能问题时在软件模式下呈现相关填充率，定义为呈现的像素数。</span><span class="sxs-lookup"><span data-stu-id="0af8d-114">The biggest performance issue you will encounter when rendering in software mode is related to fill rate, which is defined as the number of pixels that you are rendering.</span></span> <span data-ttu-id="0af8d-115">如果担心软件呈现模式中的性能，尝试尽量减少重新绘制像素的次数。</span><span class="sxs-lookup"><span data-stu-id="0af8d-115">If you are concerned about performance in software rendering mode, try to minimize the number of times a pixel is redrawn.</span></span> <span data-ttu-id="0af8d-116">例如，如果您的应用程序包含一个蓝色背景，然后通过它呈现略有透明图像，您将呈现所有两次，应用程序中的像素。</span><span class="sxs-lookup"><span data-stu-id="0af8d-116">For example, if you have an application with a blue background, which then renders a slightly transparent image over it, you will render all of the pixels in the application twice.</span></span> <span data-ttu-id="0af8d-117">因此，它将需要两次长呈现具有比有仅蓝色背景图像的应用程序。</span><span class="sxs-lookup"><span data-stu-id="0af8d-117">As a result, it will take twice as long to render the application with the image than if you had only the blue background.</span></span>  
  
### <a name="graphics-rendering-tiers"></a><span data-ttu-id="0af8d-118">图形呈现层</span><span class="sxs-lookup"><span data-stu-id="0af8d-118">Graphics Rendering Tiers</span></span>  
 <span data-ttu-id="0af8d-119">它可能很难预测你的应用程序将在运行的硬件配置。</span><span class="sxs-lookup"><span data-stu-id="0af8d-119">It may be very difficult to predict the hardware configuration that your application will be running on.</span></span> <span data-ttu-id="0af8d-120">但是，你可能想要考虑使用允许无缝切换功能在不同的硬件上运行时，以便它可以充分利用每个不同的硬件配置的应用程序的设计。</span><span class="sxs-lookup"><span data-stu-id="0af8d-120">However, you might want to consider a design that allows your application to seamlessly switch features when running on different hardware, so that it can take full advantage of each different hardware configuration.</span></span>  
  
 <span data-ttu-id="0af8d-121">若要实现此目的，[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]提供功能，以确定在运行时中的系统的图形功能。</span><span class="sxs-lookup"><span data-stu-id="0af8d-121">To achieve this, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides functionality to determine the graphics capability of a system at runtime.</span></span> <span data-ttu-id="0af8d-122">分类为一个三个呈现功能层的视频卡取决于图形功能。</span><span class="sxs-lookup"><span data-stu-id="0af8d-122">Graphics capability is determined by categorizing the video card as one of three rendering capability tiers.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="0af8d-123">公开一个 API，使应用程序能够查询呈现功能层。</span><span class="sxs-lookup"><span data-stu-id="0af8d-123">exposes an API that allows an application to query the rendering capability tier.</span></span> <span data-ttu-id="0af8d-124">然后，你的应用程序可以在运行的时间，具体取决于硬件支持的呈现层采用不同的代码路径。</span><span class="sxs-lookup"><span data-stu-id="0af8d-124">Your application can then take different code paths at run time depending on the rendering tier supported by the hardware.</span></span>  
  
 <span data-ttu-id="0af8d-125">对呈现层级别影响最大的图形硬件功能包括：</span><span class="sxs-lookup"><span data-stu-id="0af8d-125">The features of the graphics hardware that most impact the rendering tier levels are:</span></span>  
  
- <span data-ttu-id="0af8d-126">**视频 RAM** - 图形硬件中的视频内存量决定了可用于合成图形的缓冲区大小和数量。</span><span class="sxs-lookup"><span data-stu-id="0af8d-126">**Video RAM** The amount of video memory on the graphics hardware determines the size and number of buffers that can be used for compositing graphics.</span></span>  
  
- <span data-ttu-id="0af8d-127">**像素着色器** - 像素着色器是基于像素计算效果的图形处理功能。</span><span class="sxs-lookup"><span data-stu-id="0af8d-127">**Pixel Shader** A pixel shader is a graphics processing function that calculates effects on a per-pixel basis.</span></span> <span data-ttu-id="0af8d-128">每个显示帧可能有数百万像素需要处理，具体取决于显示图形的分辨率。</span><span class="sxs-lookup"><span data-stu-id="0af8d-128">Depending on the resolution of the displayed graphics, there could be several million pixels that need to be processed for each display frame.</span></span>  
  
- <span data-ttu-id="0af8d-129">**顶点着色器** - 顶点着色器是对对象的顶点数据执行数学运算的图形处理功能。</span><span class="sxs-lookup"><span data-stu-id="0af8d-129">**Vertex Shader** A vertex shader is a graphics processing function that performs mathematical operations on the vertex data of the object.</span></span>  
  
- <span data-ttu-id="0af8d-130">**多纹理支持** - 多纹理支持是指对 3D 图形对象执行混合操作期间应用两个或更多个不同纹理的功能。</span><span class="sxs-lookup"><span data-stu-id="0af8d-130">**Multitexture Support** Multitexture support refers to the ability to apply two or more distinct textures during a blending operation on a 3D graphics object.</span></span> <span data-ttu-id="0af8d-131">多纹理支持的程度取决于图形硬件中的多纹理单元数。</span><span class="sxs-lookup"><span data-stu-id="0af8d-131">The degree of multitexture support is determined by the number of multitexture units on the graphics hardware.</span></span>  
  
 <span data-ttu-id="0af8d-132">像素着色器、 顶点着色器和多纹理功能用于定义特定[!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)]版本级别，这反过来，用于定义中的不同的呈现层[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="0af8d-132">The pixel shader, vertex shader, and multitexture features are used to define specific [!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)] version levels, which, in turn, are used to define the different rendering tiers in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>  
  
 <span data-ttu-id="0af8d-133">图形硬件的功能决定了 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 应用程序的呈现功能。</span><span class="sxs-lookup"><span data-stu-id="0af8d-133">The features of the graphics hardware determine the rendering capability of a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application.</span></span> <span data-ttu-id="0af8d-134">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 系统定义了 3 个呈现层：</span><span class="sxs-lookup"><span data-stu-id="0af8d-134">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] system defines three rendering tiers:</span></span>  
  
- <span data-ttu-id="0af8d-135">**呈现层 0** - 无图形硬件加速。</span><span class="sxs-lookup"><span data-stu-id="0af8d-135">**Rendering Tier 0** No graphics hardware acceleration.</span></span> <span data-ttu-id="0af8d-136">[!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)]版本级别低于 7.0 版。</span><span class="sxs-lookup"><span data-stu-id="0af8d-136">The [!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)] version level is less than version 7.0.</span></span>  
  
- <span data-ttu-id="0af8d-137">**呈现层 1**部分的图形硬件加速。</span><span class="sxs-lookup"><span data-stu-id="0af8d-137">**Rendering Tier 1** Partial graphics hardware acceleration.</span></span> <span data-ttu-id="0af8d-138">[!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)]版本级别为大于或等于版本 7.0，并**较小**比 9.0 版。</span><span class="sxs-lookup"><span data-stu-id="0af8d-138">The [!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)] version level is greater than or equal to version 7.0, and **lesser** than version 9.0.</span></span>  
  
- <span data-ttu-id="0af8d-139">**呈现层 2** - 大多数图形功能都使用图形硬件加速。</span><span class="sxs-lookup"><span data-stu-id="0af8d-139">**Rendering Tier 2** Most graphics features use graphics hardware acceleration.</span></span> <span data-ttu-id="0af8d-140">[!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)] 版本级别高于或等于 9.0。</span><span class="sxs-lookup"><span data-stu-id="0af8d-140">The [!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)] version level is greater than or equal to version 9.0.</span></span>  
  
 <span data-ttu-id="0af8d-141">有关详细信息[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]呈现层，请参阅[图形呈现层](graphics-rendering-tiers.md)。</span><span class="sxs-lookup"><span data-stu-id="0af8d-141">For more information on [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] rendering tiers, see [Graphics Rendering Tiers](graphics-rendering-tiers.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0af8d-142">请参阅</span><span class="sxs-lookup"><span data-stu-id="0af8d-142">See also</span></span>

- [<span data-ttu-id="0af8d-143">优化 WPF 应用程序性能</span><span class="sxs-lookup"><span data-stu-id="0af8d-143">Optimizing WPF Application Performance</span></span>](optimizing-wpf-application-performance.md)
- [<span data-ttu-id="0af8d-144">规划应用程序性能</span><span class="sxs-lookup"><span data-stu-id="0af8d-144">Planning for Application Performance</span></span>](planning-for-application-performance.md)
- [<span data-ttu-id="0af8d-145">布局和示例</span><span class="sxs-lookup"><span data-stu-id="0af8d-145">Layout and Design</span></span>](optimizing-performance-layout-and-design.md)
- [<span data-ttu-id="0af8d-146">2D 图形和图像处理</span><span class="sxs-lookup"><span data-stu-id="0af8d-146">2D Graphics and Imaging</span></span>](optimizing-performance-2d-graphics-and-imaging.md)
- [<span data-ttu-id="0af8d-147">对象行为</span><span class="sxs-lookup"><span data-stu-id="0af8d-147">Object Behavior</span></span>](optimizing-performance-object-behavior.md)
- [<span data-ttu-id="0af8d-148">应用程序资源</span><span class="sxs-lookup"><span data-stu-id="0af8d-148">Application Resources</span></span>](optimizing-performance-application-resources.md)
- [<span data-ttu-id="0af8d-149">文本</span><span class="sxs-lookup"><span data-stu-id="0af8d-149">Text</span></span>](optimizing-performance-text.md)
- [<span data-ttu-id="0af8d-150">数据绑定</span><span class="sxs-lookup"><span data-stu-id="0af8d-150">Data Binding</span></span>](optimizing-performance-data-binding.md)
- [<span data-ttu-id="0af8d-151">其他性能建议</span><span class="sxs-lookup"><span data-stu-id="0af8d-151">Other Performance Recommendations</span></span>](optimizing-performance-other-recommendations.md)
