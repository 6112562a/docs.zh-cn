---
title: WPF 安全策略 — 平台安全性
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- platform security model [WPF]
- Common Language Runtime (CLR) security features
- operating system security model [WPF]
- Internet Explorer security features [WPF]
- Security-Critical method
- CLR security features [WPF]
- security model [WPF]
- security model [WPF], platform
- WPF [WPF], about security model
- Windows Presentation Foundation [WPF], about security model
- security model [WPF], operating system
ms.assetid: 2a39a054-3e2a-4659-bcb7-8bcea490ba31
ms.openlocfilehash: 42b1596082fe3e682a6fa806412ab5837b087bf9
ms.sourcegitcommit: 24a4a8eb6d8cfe7b8549fb6d823076d7c697e0c6
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/23/2019
ms.locfileid: "68400712"
---
# <a name="wpf-security-strategy---platform-security"></a><span data-ttu-id="0a600-102">WPF 安全策略 — 平台安全性</span><span class="sxs-lookup"><span data-stu-id="0a600-102">WPF Security Strategy - Platform Security</span></span>
<span data-ttu-id="0a600-103">虽然 Windows Presentation Foundation (WPF) 提供各种安全服务, 但它还利用基础平台 (包括操作系统、CLR 和[!INCLUDE[TLA2#tla_ie](../../../includes/tla2sharptla-ie-md.md)]) 的安全功能。</span><span class="sxs-lookup"><span data-stu-id="0a600-103">While Windows Presentation Foundation (WPF) provides a variety of security services, it also leverages the security features of the underlying platform, which includes the operating system, the CLR, and [!INCLUDE[TLA2#tla_ie](../../../includes/tla2sharptla-ie-md.md)].</span></span> <span data-ttu-id="0a600-104">这些层组合在一起旨在提供 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 强大且深层防御的安全模型，尝试避免任何单点故障，如下图所示：</span><span class="sxs-lookup"><span data-stu-id="0a600-104">These layers combine to provide [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] a strong, defense-in-depth security model that attempts to avoid any single point of failure, as shown in the following figure:</span></span>  
  
 ![显示 WPF 安全模型的关系图。](./media/wpf-security-strategy-platform-security/windows-presentation-foundation-security.png)  
  
 <span data-ttu-id="0a600-106">本主题的其余部分主要讨论与 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 相关的各个层。</span><span class="sxs-lookup"><span data-stu-id="0a600-106">The remainder of this topic discusses the features in each of these layers that pertain to [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] specifically.</span></span>  

<a name="Operating_System_Security"></a>   
## <a name="operating-system-security"></a><span data-ttu-id="0a600-107">操作系统安全</span><span class="sxs-lookup"><span data-stu-id="0a600-107">Operating System Security</span></span>  
 <span data-ttu-id="0a600-108">          [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 要求的操作系统最低级别是 [!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="0a600-108">The minimum level of operating system that is required by [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] is [!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)].</span></span> <span data-ttu-id="0a600-109">的核心[!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)]提供了几种安全功能, 这些功能构成了所有 Windows 应用程序的安全基础, [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]包括用构建的应用程序。</span><span class="sxs-lookup"><span data-stu-id="0a600-109">The core of [!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)] provides several security features that form the security foundation for all Windows applications, including those built with [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)].</span></span> [!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)] <span data-ttu-id="0a600-110">包含 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 的安全功能并对其进行了进一步扩展。</span><span class="sxs-lookup"><span data-stu-id="0a600-110">incorporates the security features of [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] and extends them further.</span></span> <span data-ttu-id="0a600-111">本主题详细介绍了对 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 至关重要的这些安全功能，以及 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 如何与这些功能集成从而提供深层防御方面的知识。</span><span class="sxs-lookup"><span data-stu-id="0a600-111">This topic discusses the breadth of these security features that are important to [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)], as well as how [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] integrates with them to provide further defense-in-depth.</span></span>  
  
<a name="Microsoft_Windows_XP_Service_Pack_2__SP2_"></a>   
### <a name="microsoft-windows-xp-service-pack-2-sp2"></a><span data-ttu-id="0a600-112">Microsoft Windows XP Service Pack 2 (SP2)</span><span class="sxs-lookup"><span data-stu-id="0a600-112">Microsoft Windows XP Service Pack 2 (SP2)</span></span>  
 <span data-ttu-id="0a600-113">除了对 Windows 进行一般的检查和强化外, 本主题还将介绍三[!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)]个关键功能:</span><span class="sxs-lookup"><span data-stu-id="0a600-113">In addition to a general review and strengthening of Windows, there are three key features from [!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)] that we will discuss in this topic:</span></span>  
  
- <span data-ttu-id="0a600-114">/GS 编译</span><span class="sxs-lookup"><span data-stu-id="0a600-114">/GS compilation</span></span>  
  
- [!INCLUDE[TLA#tla_win_update](../../../includes/tlasharptla-win-update-md.md)]<span data-ttu-id="0a600-115">。</span><span class="sxs-lookup"><span data-stu-id="0a600-115">.</span></span>  
  
#### <a name="gs-compilation"></a><span data-ttu-id="0a600-116">/GS 编译</span><span class="sxs-lookup"><span data-stu-id="0a600-116">/GS Compilation</span></span>  
 [!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)]<span data-ttu-id="0a600-117">通过重新编译许多核心系统库 (包括所有[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]依赖项 (如 CLR) 来提供保护, 以帮助缓解缓冲区溢出。</span><span class="sxs-lookup"><span data-stu-id="0a600-117">provides protection by recompiling many core system libraries, including all of the [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] dependencies such as the CLR, to help mitigate buffer overruns.</span></span> <span data-ttu-id="0a600-118">通过使用/GS 形参和 C/C++ 命令行编译器可实现这一点。</span><span class="sxs-lookup"><span data-stu-id="0a600-118">This is achieved by using the /GS parameter with the C/C++ command-line compiler.</span></span> <span data-ttu-id="0a600-119">虽然应显式避免缓冲区溢出，但 /GS 编译针对由它们无意或恶意创建的潜在漏洞提供了深层防御示例。</span><span class="sxs-lookup"><span data-stu-id="0a600-119">Although buffer overruns should be explicitly avoided, /GS compilation provides an example of a defense-in-depth against potential vulnerabilities that are inadvertently or maliciously created by them.</span></span>  
  
 <span data-ttu-id="0a600-120">以前，缓冲区溢出已导致出现了许多影响较大的安全漏洞。</span><span class="sxs-lookup"><span data-stu-id="0a600-120">Historically, buffer overruns have been the cause of many high-impact security exploits.</span></span> <span data-ttu-id="0a600-121">当攻击者利用代码漏洞时就会发生缓冲区溢出，代码漏洞可让注入的恶意代码通过缓冲区边界写入。</span><span class="sxs-lookup"><span data-stu-id="0a600-121">A buffer overrun occurs when an attacker takes advantage of a code vulnerability that allows the injection of malicious code that writes past the boundaries of a buffer.</span></span> <span data-ttu-id="0a600-122">从而让攻击者可以通过重写导致执行攻击者代码的函数返回地址执行代码进程。</span><span class="sxs-lookup"><span data-stu-id="0a600-122">This then allows an attacker to hijack the process in which the code is executing by overwriting the return address of a function to cause the execution of the attacker's code.</span></span> <span data-ttu-id="0a600-123">结果，恶意代码可以执行具有截获进程相同特权的任意代码。</span><span class="sxs-lookup"><span data-stu-id="0a600-123">The result is malicious code that executes arbitrary code with the same privileges as the hijacked process.</span></span>  
  
 <span data-ttu-id="0a600-124">在较高级别，/GS 编译器标志通过注入特殊安全 cookie 保护部分潜在缓冲区溢出，从而保护具有本地字符串缓冲区的函数返回地址。</span><span class="sxs-lookup"><span data-stu-id="0a600-124">At a high level, the /GS compiler flag protects against some potential buffer overruns by injecting a special security cookie to protect the return address of a function that has local string buffers.</span></span> <span data-ttu-id="0a600-125">函数返回后，安全 cookie 将与其上一个值进行比较。</span><span class="sxs-lookup"><span data-stu-id="0a600-125">After a function returns, the security cookie is compared with its previous value.</span></span> <span data-ttu-id="0a600-126">如果值已更改，可能已发生缓冲区溢出，并且该进程已停止并显示错误条件。</span><span class="sxs-lookup"><span data-stu-id="0a600-126">If the value has changed, a buffer overrun may have occurred and the process is stopped with an error condition.</span></span> <span data-ttu-id="0a600-127">停止的进程将阻止执行潜在的恶意代码。</span><span class="sxs-lookup"><span data-stu-id="0a600-127">Stopping the process prevents the execution of potentially malicious code.</span></span> <span data-ttu-id="0a600-128">有关更多详细信息, 请参阅[/gs (缓冲区安全检查)](/cpp/build/reference/gs-buffer-security-check) 。</span><span class="sxs-lookup"><span data-stu-id="0a600-128">See [/GS (Buffer Security Check)](/cpp/build/reference/gs-buffer-security-check) for more details.</span></span>  
  
 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="0a600-129">已使用/GS 标志进行编译，旨在对 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 应用程序增加另一层防御。</span><span class="sxs-lookup"><span data-stu-id="0a600-129">is compiled with the /GS flag to add yet another layer of defense to [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications.</span></span>  
  
#### <a name="microsoft-windows-update-enhancements"></a><span data-ttu-id="0a600-130">Microsoft Windows Update 增强功能</span><span class="sxs-lookup"><span data-stu-id="0a600-130">Microsoft Windows Update Enhancements</span></span>  
 [!INCLUDE[TLA#tla_win_update](../../../includes/tlasharptla-win-update-md.md)] <span data-ttu-id="0a600-131">也对 [!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)] 进行了改进，以简化用于下载和安装更新的过程。</span><span class="sxs-lookup"><span data-stu-id="0a600-131">was also improved in [!INCLUDE[TLA2#tla_winxpsp2](../../../includes/tla2sharptla-winxpsp2-md.md)] to simplify the process for downloading and installing updates.</span></span> <span data-ttu-id="0a600-132">这些更改通过帮助确保其系统（尤其是设计到安全更新）处于最新状态，显著地增强了 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 客户的安全。</span><span class="sxs-lookup"><span data-stu-id="0a600-132">These changes significantly enhance security for [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] customers by helping to ensure that their systems are up-to-date, particularly with respect to security updates.</span></span>  
  
<a name="Windows_Vista"></a>   
### <a name="windows-vista"></a><span data-ttu-id="0a600-133">Windows Vista</span><span class="sxs-lookup"><span data-stu-id="0a600-133">Windows Vista</span></span>  
 [!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)] <span data-ttu-id="0a600-134">上的 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 用户将从操作系统其他的安全增强功能中受益，这些功能包括“Least-Privilege User Access(最小特权用户访问)”、代码完整性检查以及特权隔离。</span><span class="sxs-lookup"><span data-stu-id="0a600-134">users on [!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)] will benefit from the operating system's additional security enhancements, including "Least-Privilege User Access", code integrity checks, and privilege isolation.</span></span>  
  
#### <a name="user-account-control-uac"></a><span data-ttu-id="0a600-135">用户帐户控制 (UAC)</span><span class="sxs-lookup"><span data-stu-id="0a600-135">User Account Control (UAC)</span></span>  
 <span data-ttu-id="0a600-136">目前, Windows 用户倾向于以管理员权限运行, 因为许多应用程序都需要它们进行安装或执行, 或者两者都需要。</span><span class="sxs-lookup"><span data-stu-id="0a600-136">Today, Windows users tend to run with administrator privileges because many applications require them for either installation or execution, or both.</span></span> <span data-ttu-id="0a600-137">其中一个示例就是，可以将默认应用程序设置写入到注册表。</span><span class="sxs-lookup"><span data-stu-id="0a600-137">Being able to write default application settings to the Registry is one example.</span></span>  
  
 <span data-ttu-id="0a600-138">使用管理员特权运行实际上就是指应用程序从授予管理员特权的进程执行。</span><span class="sxs-lookup"><span data-stu-id="0a600-138">Running with administrator privileges really means that applications execute from processes that are granted administrator privileges.</span></span> <span data-ttu-id="0a600-139">此方法的安全影响在于，可截获使用管理员特权运行的进程的任何恶意代码都将自动继承这些特权，包括对关键系统资源的访问权限。</span><span class="sxs-lookup"><span data-stu-id="0a600-139">The security impact of this is that any malicious code that hijacks a process running with administrator privileges will automatically inherit those privileges, including access to critical system resources.</span></span>  
  
 <span data-ttu-id="0a600-140">保护计算机免受此安全威胁的一种方法就是使用所需的最少特权数运行应用程序。</span><span class="sxs-lookup"><span data-stu-id="0a600-140">One way to protect against this security threat is to run applications with the least amount of privileges that are required.</span></span> <span data-ttu-id="0a600-141">这就是通常所说的最低特权原则，也是 [!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)] 操作系统的核心功能。</span><span class="sxs-lookup"><span data-stu-id="0a600-141">This is known as the principle of least privilege, and is a core feature of the [!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)] operating system.</span></span> <span data-ttu-id="0a600-142">此功能称为用户帐户控制 (UAC)，被 [!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)] UAC 使用，主要有两种使用方式：</span><span class="sxs-lookup"><span data-stu-id="0a600-142">This feature is called User Account Control (UAC), and is used by [!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)] UAC in two key ways:</span></span>  
  
- <span data-ttu-id="0a600-143">若要在默认情况下使用 UAC 特权运行大多数应用程序，即使用户是管理员，也只有需要使用管理员特权的应用程序才会使用管理员特权运行。</span><span class="sxs-lookup"><span data-stu-id="0a600-143">To run most applications with UAC privileges by default, even if the user is an administrator; only applications that need administrator privileges will run with administrator privileges.</span></span> <span data-ttu-id="0a600-144">要使用管理特权运行，必须以应用程序清单形式或作为安全策略中的一个条目显式标记应用程序。</span><span class="sxs-lookup"><span data-stu-id="0a600-144">To run with administrative privileges, applications must be explicitly marked in either their application manifest or as an entry in security policy.</span></span>  
  
- <span data-ttu-id="0a600-145">提供兼容性解决方案(如虚拟化)。</span><span class="sxs-lookup"><span data-stu-id="0a600-145">To provide compatibility solutions like virtualization.</span></span> <span data-ttu-id="0a600-146">例如，许多应用程序尝试写入受限位置，例如 C:\Program Files。</span><span class="sxs-lookup"><span data-stu-id="0a600-146">For example, many applications try to write to restricted locations like C:\Program Files.</span></span> <span data-ttu-id="0a600-147">对于在 UAC 中执行的应用程序，存在基于用户的可选位置无需管理员特权就能写入。</span><span class="sxs-lookup"><span data-stu-id="0a600-147">For applications executing under UAC, an alternative per-user location exists that does not require administrator privileges to write to.</span></span> <span data-ttu-id="0a600-148">对于在 UAC 中运行的应用程序，UAC 可虚拟化 C:\Program Files，这样认为其写入到其中的应用程序实际上是写入到基于用户的可选位置。</span><span class="sxs-lookup"><span data-stu-id="0a600-148">For applications running under UAC, UAC virtualizes C:\Program Files so that applications who think they are writing to it are actually writing to the alternative, per-user location.</span></span> <span data-ttu-id="0a600-149">这种兼容性工作可使操作系统来运行许多以前无法在 UAC 中运行的应用程序。</span><span class="sxs-lookup"><span data-stu-id="0a600-149">This kind of compatibility work enables the operating system to run many applications that couldn't previously run in UAC.</span></span>  
  
#### <a name="code-integrity-checks"></a><span data-ttu-id="0a600-150">代码完整性检查</span><span class="sxs-lookup"><span data-stu-id="0a600-150">Code Integrity Checks</span></span>  
 [!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)] <span data-ttu-id="0a600-151">集成了更深入的代码完整性检查，有助于防止恶意代码在负载/运行时注入到系统文件或内核。</span><span class="sxs-lookup"><span data-stu-id="0a600-151">incorporates deeper code integrity checks to help prevent malicious code from being injected into system files or into the kernel at load/run time.</span></span> <span data-ttu-id="0a600-152">这超出了系统文件保护。</span><span class="sxs-lookup"><span data-stu-id="0a600-152">This goes beyond system file protection.</span></span>  
  
<a name="Limited_Rights_Process_for_Browser_Hosted_Applications"></a>   
### <a name="limited-rights-process-for-browser-hosted-applications"></a><span data-ttu-id="0a600-153">浏览器承载的应用程序的受限权限进程</span><span class="sxs-lookup"><span data-stu-id="0a600-153">Limited Rights Process for Browser-Hosted Applications</span></span>  
 <span data-ttu-id="0a600-154">浏览器承载的 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 应用程序在 Internet 区域沙箱内执行。</span><span class="sxs-lookup"><span data-stu-id="0a600-154">Browser-hosted [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications execute within the Internet zone sandbox.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="0a600-155">与 [!INCLUDE[TLA#tla_ie](../../../includes/tlasharptla-ie-md.md)] 集成扩展了此保护，可提供其他支持。</span><span class="sxs-lookup"><span data-stu-id="0a600-155">integration with [!INCLUDE[TLA#tla_ie](../../../includes/tlasharptla-ie-md.md)] extends this protection with additional support.</span></span>  
  
#### <a name="internet-explorer-6-service-pack-2-and-internet-explorer-7-for-xp"></a><span data-ttu-id="0a600-156">Internet Explorer 6 Service Pack 2 和适用于 XP 的 Internet Explorer 7</span><span class="sxs-lookup"><span data-stu-id="0a600-156">Internet Explorer 6 Service Pack 2 and Internet Explorer 7 for XP</span></span>  
 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="0a600-157">通过限制 [!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)] 的进程特权利用操作系统安全提供进一步的保护。</span><span class="sxs-lookup"><span data-stu-id="0a600-157">leverages operating system security by limiting process privileges for [!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)] for further protection.</span></span> <span data-ttu-id="0a600-158">在启动浏览器承载的 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 应用程序之前，操作系统会创建一个宿主进程，用于删除进程令牌中不必要的特权。</span><span class="sxs-lookup"><span data-stu-id="0a600-158">Before a browser-hosted [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] application is launched, the operating system creates a host process that removes unnecessary privileges from the process token.</span></span> <span data-ttu-id="0a600-159">删除的特权的部分示例包括：关闭用户的计算机、加载驱动程序以及读取计算机上所有文件的访问权限的能力。</span><span class="sxs-lookup"><span data-stu-id="0a600-159">Some examples of privileges that are removed include the ability to shut down the user's machine, load drivers, and read access to all files on the machine.</span></span>  
  
#### <a name="internet-explorer-7-for-vista"></a><span data-ttu-id="0a600-160">适用于 Vista 的 Internet Explorer 7</span><span class="sxs-lookup"><span data-stu-id="0a600-160">Internet Explorer 7 for Vista</span></span>  
 <span data-ttu-id="0a600-161">在 [!INCLUDE[TLA#tla_ie7](../../../includes/tlasharptla-ie7-md.md)] 中，[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 应用程序以受保护模式运行。</span><span class="sxs-lookup"><span data-stu-id="0a600-161">In [!INCLUDE[TLA#tla_ie7](../../../includes/tlasharptla-ie7-md.md)], [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications run in protected mode.</span></span> <span data-ttu-id="0a600-162">具体而言，[!INCLUDE[TLA#tla_xbap#plural](../../../includes/tlasharptla-xbapsharpplural-md.md)] 以中等级别的完整性运行。</span><span class="sxs-lookup"><span data-stu-id="0a600-162">Specifically, [!INCLUDE[TLA#tla_xbap#plural](../../../includes/tlasharptla-xbapsharpplural-md.md)] run with medium-level integrity.</span></span>  
  
#### <a name="defense-in-depth-layer"></a><span data-ttu-id="0a600-163">深层防御层</span><span class="sxs-lookup"><span data-stu-id="0a600-163">Defense-In-Depth Layer</span></span>  
 <span data-ttu-id="0a600-164">由于 [!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)] 通常都是通过 Internet 区域权限集设置的沙盒，因此，删除这些权限不会损害 [!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)] 的兼容性。</span><span class="sxs-lookup"><span data-stu-id="0a600-164">Since [!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)] are generally sandboxed by the Internet zone permission set, removing these privileges does not harm [!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)] from a compatibility perspective.</span></span> <span data-ttu-id="0a600-165">反而会创建一个附加的深层防御层；如果经过沙箱处理的应用程序能够利用其他层截获此进程，该进程将仍然只有有限特权。</span><span class="sxs-lookup"><span data-stu-id="0a600-165">Instead, an additional defense-in-depth layer is created; if a sandboxed application is able to exploit other layers and hijack the process, the process will still only have limited privileges.</span></span>  
  
 <span data-ttu-id="0a600-166">请参阅[使用最低权限的用户帐户](https://docs.microsoft.com/previous-versions/tn-archive/cc700846%28v=technet.10%29)。</span><span class="sxs-lookup"><span data-stu-id="0a600-166">See [Using a Least-Privileged User Account](https://docs.microsoft.com/previous-versions/tn-archive/cc700846%28v=technet.10%29).</span></span>  
  
<a name="Common_Language_Runtime_Security"></a>   
## <a name="common-language-runtime-security"></a><span data-ttu-id="0a600-167">公共语言运行时的安全性</span><span class="sxs-lookup"><span data-stu-id="0a600-167">Common Language Runtime Security</span></span>  
 <span data-ttu-id="0a600-168">公共语言运行时 (CLR) 提供了许多重要的安全优势, 包括验证和验证、代码访问安全性 (CAS) 和安全关键方法。</span><span class="sxs-lookup"><span data-stu-id="0a600-168">The common language runtime (CLR) offers a number of key security benefits that include validation and verification, Code Access Security (CAS), and the Security Critical Methodology.</span></span>  
  
<a name="Validation_and_Verification"></a>   
### <a name="validation-and-verification"></a><span data-ttu-id="0a600-169">确认和验证</span><span class="sxs-lookup"><span data-stu-id="0a600-169">Validation and Verification</span></span>  
 <span data-ttu-id="0a600-170">为了提供程序集隔离和完整性, CLR 使用验证过程。</span><span class="sxs-lookup"><span data-stu-id="0a600-170">To provide assembly isolation and integrity, the CLR uses a process of validation.</span></span> <span data-ttu-id="0a600-171">CLR 验证通过验证指向程序集外部地址的可移植可执行 (PE) 文件格式来确保程序集的隔离。</span><span class="sxs-lookup"><span data-stu-id="0a600-171">CLR validation ensures that assemblies are isolated by validating their Portable Executable (PE) file format for addresses that point outside the assembly.</span></span> <span data-ttu-id="0a600-172">CLR 验证还验证嵌入到程序集内的元数据的完整性。</span><span class="sxs-lookup"><span data-stu-id="0a600-172">CLR validation also validates the integrity of the metadata that is embedded within an assembly.</span></span>  
  
 <span data-ttu-id="0a600-173">为了确保类型安全, 帮助防止常见安全问题 (例如缓冲区溢出), 并通过子进程隔离启用沙盒, CLR 安全使用验证概念。</span><span class="sxs-lookup"><span data-stu-id="0a600-173">To ensure type safety, help prevent common security issues (e.g. buffer overruns), and enable sandboxing through sub-process isolation, CLR security uses the concept of verification.</span></span>  
  
 <span data-ttu-id="0a600-174">托管应用程序被编译为 Microsoft 中间语言 (MSIL)。</span><span class="sxs-lookup"><span data-stu-id="0a600-174">Managed applications are compiled into Microsoft Intermediate Language (MSIL).</span></span> <span data-ttu-id="0a600-175">当执行托管应用程序中的方法时，将采用实时 (JIT) 编译方式把 MSIL 编译为本机代码。</span><span class="sxs-lookup"><span data-stu-id="0a600-175">When methods in a managed application are executed, its MSIL is compiled into native code through Just-In-Time (JIT) compilation.</span></span> <span data-ttu-id="0a600-176">JIT 编译包括的验证过程将应用许多众多安全和可靠规则，从而确保代码不会：</span><span class="sxs-lookup"><span data-stu-id="0a600-176">JIT compilation includes a verification process that applies many safety and robustness rules that ensure code does not:</span></span>  
  
- <span data-ttu-id="0a600-177">违反类型合约</span><span class="sxs-lookup"><span data-stu-id="0a600-177">Violate type contracts</span></span>  
  
- <span data-ttu-id="0a600-178">引入缓冲区溢出</span><span class="sxs-lookup"><span data-stu-id="0a600-178">Introduce buffer overruns</span></span>  
  
- <span data-ttu-id="0a600-179">随意访问内存。</span><span class="sxs-lookup"><span data-stu-id="0a600-179">Wildly access memory.</span></span>  
  
 <span data-ttu-id="0a600-180">不允许不符合验证规则的托管代码执行，除非它被视为受信任代码。</span><span class="sxs-lookup"><span data-stu-id="0a600-180">Managed code that does not conform to verification rules is not allowed to execute, unless it is considered trusted code.</span></span>  
  
 <span data-ttu-id="0a600-181">可验证代码的优点是 .NET Framework [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]生成的主要原因。</span><span class="sxs-lookup"><span data-stu-id="0a600-181">The advantage of verifiable code is a key reason why [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] builds on the .NET Framework.</span></span> <span data-ttu-id="0a600-182">从使用验证代码而言，利用潜在漏洞的可能性明显降低。</span><span class="sxs-lookup"><span data-stu-id="0a600-182">To the extent that verifiable code is used, the possibility of exploiting possible vulnerabilities is greatly lowered.</span></span>  
  
<a name="Code_Access_Security"></a>   
### <a name="code-access-security"></a><span data-ttu-id="0a600-183">代码访问安全性</span><span class="sxs-lookup"><span data-stu-id="0a600-183">Code Access Security</span></span>  
 <span data-ttu-id="0a600-184">客户端计算机公开了托管应用程序可以访问的各种资源，包括文件系统、注册表、打印服务、用户界面、反射和环境变量。</span><span class="sxs-lookup"><span data-stu-id="0a600-184">A client machine exposes a wide variety of resources that a managed application can have access to, including the file system, the Registry, printing services, the user interface, reflection, and environment variables.</span></span> <span data-ttu-id="0a600-185">在托管应用程序可以访问客户端计算机上的任何资源之前, 它必须具有 .NET Framework 的权限。</span><span class="sxs-lookup"><span data-stu-id="0a600-185">Before a managed application can access any of the resources on a client machine, it must have .NET Framework permission to do so.</span></span> <span data-ttu-id="0a600-186">CA 中的权限是的<xref:System.Security.CodeAccessPermission>子类;CA 为托管应用程序可以访问的每个资源实现一个子类。</span><span class="sxs-lookup"><span data-stu-id="0a600-186">A permission in CAS is a subclass of the <xref:System.Security.CodeAccessPermission>; CAS implements one subclass for each resource that managed applications can access.</span></span>  
  
 <span data-ttu-id="0a600-187">CA 在开始执行时授予托管应用程序的权限集称为权限集, 由应用程序提供的证据确定。</span><span class="sxs-lookup"><span data-stu-id="0a600-187">The set of permissions that a managed application is granted by CAS when it starts executing is known as a permission set and is determined by evidence provided by the application.</span></span> <span data-ttu-id="0a600-188">对于 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 应用程序，提供的证据为从中启动应用程序的位置或区域。</span><span class="sxs-lookup"><span data-stu-id="0a600-188">For [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications, the evidence that is provided is the location, or zone, from which the applications are launched.</span></span> <span data-ttu-id="0a600-189">CA 标识以下区域:</span><span class="sxs-lookup"><span data-stu-id="0a600-189">CAS identifies the following zones:</span></span>  
  
- <span data-ttu-id="0a600-190">**我的电脑**。</span><span class="sxs-lookup"><span data-stu-id="0a600-190">**My Computer**.</span></span> <span data-ttu-id="0a600-191">从客户端计算机（完全受信任）上启动的应用程序。</span><span class="sxs-lookup"><span data-stu-id="0a600-191">Applications launched from the client machine (Fully Trusted).</span></span>  
  
- <span data-ttu-id="0a600-192">**本地 Intranet**。</span><span class="sxs-lookup"><span data-stu-id="0a600-192">**Local Intranet**.</span></span> <span data-ttu-id="0a600-193">从 Intranet 启动的应用程序。</span><span class="sxs-lookup"><span data-stu-id="0a600-193">Applications launched from the intranet.</span></span> <span data-ttu-id="0a600-194">（某种程度上受信任）。</span><span class="sxs-lookup"><span data-stu-id="0a600-194">(Somewhat Trusted).</span></span>  
  
- <span data-ttu-id="0a600-195">**Internet**。</span><span class="sxs-lookup"><span data-stu-id="0a600-195">**Internet**.</span></span> <span data-ttu-id="0a600-196">从 Intranet 启动的应用程序。</span><span class="sxs-lookup"><span data-stu-id="0a600-196">Applications launched from the Internet.</span></span> <span data-ttu-id="0a600-197">（最不受信任）。</span><span class="sxs-lookup"><span data-stu-id="0a600-197">(Least Trusted).</span></span>  
  
- <span data-ttu-id="0a600-198">**受信任的站点**。</span><span class="sxs-lookup"><span data-stu-id="0a600-198">**Trusted Sites**.</span></span> <span data-ttu-id="0a600-199">由受信任用户标识的应用程序。</span><span class="sxs-lookup"><span data-stu-id="0a600-199">Applications identified by a user as being trusted.</span></span> <span data-ttu-id="0a600-200">（最不受信任）。</span><span class="sxs-lookup"><span data-stu-id="0a600-200">(Least Trusted).</span></span>  
  
- <span data-ttu-id="0a600-201">**不受信任的站点**。</span><span class="sxs-lookup"><span data-stu-id="0a600-201">**Untrusted Sites**.</span></span> <span data-ttu-id="0a600-202">由不受信任的用户标识的应用程序。</span><span class="sxs-lookup"><span data-stu-id="0a600-202">Applications identified by a user as being untrusted.</span></span> <span data-ttu-id="0a600-203">（不受信任）。</span><span class="sxs-lookup"><span data-stu-id="0a600-203">(Untrusted).</span></span>  
  
 <span data-ttu-id="0a600-204">对于其中的每个区域, CA 都提供预定义的权限集, 该权限集包含与每个相关联的信任级别相匹配的权限。</span><span class="sxs-lookup"><span data-stu-id="0a600-204">For each of these zones, CAS provides a predefined permission set that includes the permissions which matches the level of trust associated with each.</span></span> <span data-ttu-id="0a600-205">这些问题包括：</span><span class="sxs-lookup"><span data-stu-id="0a600-205">These include:</span></span>  
  
- <span data-ttu-id="0a600-206">**FullTrust**。</span><span class="sxs-lookup"><span data-stu-id="0a600-206">**FullTrust**.</span></span> <span data-ttu-id="0a600-207">对于从**我的电脑**区域启动的应用程序。</span><span class="sxs-lookup"><span data-stu-id="0a600-207">For applications launched from the **My Computer** zone.</span></span> <span data-ttu-id="0a600-208">将授予全部可能的权限。</span><span class="sxs-lookup"><span data-stu-id="0a600-208">All possible permissions are granted.</span></span>  
  
- <span data-ttu-id="0a600-209">**LocalIntranet**。</span><span class="sxs-lookup"><span data-stu-id="0a600-209">**LocalIntranet**.</span></span> <span data-ttu-id="0a600-210">对于从**本地 Intranet**区域启动的应用程序。</span><span class="sxs-lookup"><span data-stu-id="0a600-210">For applications launched from the **Local Intranet** zone.</span></span> <span data-ttu-id="0a600-211">将授予权限的子集，以提供对客户端计算机资源适度的访问权限，包括隔离存储、用户界面的无限制访问、无限制使用文件对话框、有限的反射和有限访问环境变量。</span><span class="sxs-lookup"><span data-stu-id="0a600-211">A subset of permissions are granted to provide moderate access to a client machine’s resources, including isolated storage, unrestricted UI access, unrestricted file dialogs, limited reflection, limited access to environment variables.</span></span> <span data-ttu-id="0a600-212">不提供对关键资源（如注册表）的权限。</span><span class="sxs-lookup"><span data-stu-id="0a600-212">Permissions for critical resources like the Registry are not provided.</span></span>  
  
- <span data-ttu-id="0a600-213">**Internet**。</span><span class="sxs-lookup"><span data-stu-id="0a600-213">**Internet**.</span></span> <span data-ttu-id="0a600-214">适用于从**Internet**或**受信任的站点**区域启动的应用程序。</span><span class="sxs-lookup"><span data-stu-id="0a600-214">For applications launched from the **Internet** or **Trusted Sites** zone.</span></span> <span data-ttu-id="0a600-215">将授予权限的子集，以提供对客户端计算机资源有限的访问权限，包括隔离存储、仅限打开文件和有限的用户界面。</span><span class="sxs-lookup"><span data-stu-id="0a600-215">A subset of permissions are granted to provided limited access to a client machine’s resources, including isolated storage, file open only, and limited UI.</span></span> <span data-ttu-id="0a600-216">实质上, 此权限集将应用程序与客户端计算机隔离开来。</span><span class="sxs-lookup"><span data-stu-id="0a600-216">Essentially, this permission set isolates applications from the client machine.</span></span>  
  
 <span data-ttu-id="0a600-217">标识为来自**不受信任的站点**区域的应用程序将不会被 ca 授予任何权限。</span><span class="sxs-lookup"><span data-stu-id="0a600-217">Applications identified as being from the **Untrusted Sites** zone are granted no permissions by CAS at all.</span></span> <span data-ttu-id="0a600-218">因此，对它们而言，就不存在预定义的权限集。</span><span class="sxs-lookup"><span data-stu-id="0a600-218">Consequently, a predefined permission set does not exist for them.</span></span>  
  
 <span data-ttu-id="0a600-219">下图说明了区域、权限集、权限和资源之间的关系:</span><span class="sxs-lookup"><span data-stu-id="0a600-219">The following figure illustrates the relationship between zones, permission sets, permissions, and resources:</span></span>  
  
 ![显示 CAS 权限集的关系图。](./media/wpf-security-strategy-platform-security/code-access-security-permissions-relationship.png)  
  
 <span data-ttu-id="0a600-221">Internet 区域安全沙盒的限制同样适用于 XBAP 从系统库导入的任何代码, 包括[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="0a600-221">The restrictions of the Internet zone security sandbox apply equally to any code that an XBAP imports from a system library, including [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)].</span></span> <span data-ttu-id="0a600-222">这可确保代码的每一位都是锁定的，即便 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 也是如此。</span><span class="sxs-lookup"><span data-stu-id="0a600-222">This ensures that every bit of the code is locked down, even [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)].</span></span> <span data-ttu-id="0a600-223">遗憾的是, 为了能够执行, XBAP 需要执行需要比 Internet 区域安全沙盒启用的权限更多的功能。</span><span class="sxs-lookup"><span data-stu-id="0a600-223">Unfortunately, to be able to execute, an XBAP needs to execute functionality that requires more permissions than those enabled by the Internet zone security sandbox.</span></span>  
  
 <span data-ttu-id="0a600-224">请考虑包含以下页面的 XBAP 应用程序:</span><span class="sxs-lookup"><span data-stu-id="0a600-224">Consider an XBAP application that includes the following page:</span></span>  
  
 [!code-csharp[WPFPlatformSecuritySnippets#Permission](~/samples/snippets/csharp/VS_Snippets_Wpf/WPFPlatformSecuritySnippets/CSharp/Page1.xaml.cs#permission)]
 [!code-vb[WPFPlatformSecuritySnippets#Permission](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WPFPlatformSecuritySnippets/VisualBasic/Page1.xaml.vb#permission)]  
  
 <span data-ttu-id="0a600-225">若要执行此 XBAP, 基础[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]代码必须执行比可用于调用 XBAP 的功能更多的功能, 包括:</span><span class="sxs-lookup"><span data-stu-id="0a600-225">To execute this XBAP, the underlying [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] code must execute more functionality than is available to the calling XBAP, including:</span></span>  
  
- <span data-ttu-id="0a600-226">创建用于呈现的窗口句柄 (HWND)</span><span class="sxs-lookup"><span data-stu-id="0a600-226">Creating a window handle (HWND) for rendering</span></span>  
  
- <span data-ttu-id="0a600-227">调度消息</span><span class="sxs-lookup"><span data-stu-id="0a600-227">Dispatching messages</span></span>  
  
- <span data-ttu-id="0a600-228">加载 Tahoma 字体</span><span class="sxs-lookup"><span data-stu-id="0a600-228">Loading the Tahoma font</span></span>  
  
 <span data-ttu-id="0a600-229">从安全角度而言，允许从沙盒应用程序直接访问上述任何操作将会导致灾难性后果。</span><span class="sxs-lookup"><span data-stu-id="0a600-229">From a security point of view, allowing direct access to any of these operations from the sandboxed application would be catastrophic.</span></span>  
  
 <span data-ttu-id="0a600-230">而 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 通过允许代表沙盒应用程序使用提升的特权来执行这些操作可解决这种情况。</span><span class="sxs-lookup"><span data-stu-id="0a600-230">Fortunately, [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] caters to this situation by allowing these operations to execute with elevated privileges on behalf of the sandboxed application.</span></span> <span data-ttu-id="0a600-231">尽管对[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] XBAP 的应用程序域的有限 Internet 区域安全权限检查所有操作 (与其他系统[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]库相同), 但也会向其授予包含所有可能权限的权限集。</span><span class="sxs-lookup"><span data-stu-id="0a600-231">While all [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] operations are checked against the limited Internet zone security permissions of the application domain of the XBAP, [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] (as with other system libraries) is granted a permission set that includes all possible permissions.</span></span>
  
 <span data-ttu-id="0a600-232">这就要求 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 接收提升的特权，同时阻止这些特权由宿主应用程序域的 Internet 区域权限集管理。</span><span class="sxs-lookup"><span data-stu-id="0a600-232">This requires that [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] receives elevated privileges while preventing those privileges from being governed by the Internet zone permission set of the host application domain.</span></span>  
  
 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="0a600-233">使用权限的**Assert**方法实现此功能。</span><span class="sxs-lookup"><span data-stu-id="0a600-233">does this by using the **Assert** method of a permission.</span></span> <span data-ttu-id="0a600-234">以下代码演示了这种方法。</span><span class="sxs-lookup"><span data-stu-id="0a600-234">The following code shows how this happens.</span></span>  
  
 [!code-csharp[WPFPlatformSecuritySnippets#Permission](~/samples/snippets/csharp/VS_Snippets_Wpf/WPFPlatformSecuritySnippets/CSharp/Page1.xaml.cs#permission)]
 [!code-vb[WPFPlatformSecuritySnippets#Permission](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WPFPlatformSecuritySnippets/VisualBasic/Page1.xaml.vb#permission)]  
  
 <span data-ttu-id="0a600-235">**断言**实质上是阻止由 XBAP 的 Internet [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]区域权限限制所需的无限制权限。</span><span class="sxs-lookup"><span data-stu-id="0a600-235">The **Assert** essentially prevents the unlimited permissions required by [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] from being restricted by the Internet zone permissions of the XBAP.</span></span>  
  
 <span data-ttu-id="0a600-236">从平台的角度来[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]看, 负责正确使用**assert** ; 不正确地使用**断言**可能会使恶意代码提升特权。</span><span class="sxs-lookup"><span data-stu-id="0a600-236">From a platform perspective, [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] is responsible for using **Assert** correctly; an incorrect use of **Assert** could enable malicious code to elevate privileges.</span></span> <span data-ttu-id="0a600-237">因此, 只需在需要时调用**断言**, 并确保沙盒限制保持不变, 这一点非常重要。</span><span class="sxs-lookup"><span data-stu-id="0a600-237">Consequently, it is important then to only call **Assert** when needed, and to ensure that sandbox restrictions remain intact.</span></span> <span data-ttu-id="0a600-238">例如，禁止沙盒代码打开任意文件，但允许其使用字体。</span><span class="sxs-lookup"><span data-stu-id="0a600-238">For example, sandboxed code is not allowed to open random files, but it is allowed to use fonts.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="0a600-239">使沙盒应用程序能够通过调用**Assert**来使用字体功能, [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]并使能够代表经过沙箱处理的应用程序读取已知包含这些字体的文件。</span><span class="sxs-lookup"><span data-stu-id="0a600-239">enables sandboxed applications to use font functionality by calling **Assert**, and for [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] to read files known to contain those fonts on behalf of the sandboxed application.</span></span>  
  
<a name="ClickOnce_Deployment"></a>   
### <a name="clickonce-deployment"></a><span data-ttu-id="0a600-240">ClickOnce 部署</span><span class="sxs-lookup"><span data-stu-id="0a600-240">ClickOnce Deployment</span></span>  
 <span data-ttu-id="0a600-241">ClickOnce 是一种全面的部署技术, 包含在 .NET Framework 中, 并[!INCLUDE[TLA#tla_visualstu](../../../includes/tlasharptla-visualstu-md.md)]与集成 (有关详细信息, 请参阅[ClickOnce 安全和部署](/visualstudio/deployment/clickonce-security-and-deployment))。</span><span class="sxs-lookup"><span data-stu-id="0a600-241">ClickOnce is a comprehensive deployment technology that is included with .NET Framework, and integrates with [!INCLUDE[TLA#tla_visualstu](../../../includes/tlasharptla-visualstu-md.md)] (see [ClickOnce security and deployment](/visualstudio/deployment/clickonce-security-and-deployment) for detailed information).</span></span> <span data-ttu-id="0a600-242">独立[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]应用程序可使用 clickonce 进行部署, 而浏览器承载的应用程序必须使用 clickonce 进行部署。</span><span class="sxs-lookup"><span data-stu-id="0a600-242">Standalone [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications can be deployed using ClickOnce, while browser-hosted applications must be deployed with ClickOnce.</span></span>  
  
 <span data-ttu-id="0a600-243">使用 ClickOnce 部署的应用程序在代码访问安全性 (CAS) 上给予了附加的安全层;实质上, ClickOnce 部署的应用程序会请求所需的权限。</span><span class="sxs-lookup"><span data-stu-id="0a600-243">Applications deployed using ClickOnce are given an additional security layer over Code Access Security (CAS); essentially, ClickOnce deployed applications request the permissions that they need.</span></span> <span data-ttu-id="0a600-244">如果它们不超过在其中部署应用程序的区域的权限集，几乎仅授予它们这些权限。</span><span class="sxs-lookup"><span data-stu-id="0a600-244">They are granted only those permissions if they do not exceed the set of permissions for the zone from which the application is deployed.</span></span> <span data-ttu-id="0a600-245">通过将权限集减少到仅需要的权限集, 即使它们小于启动区域的权限集提供的权限集, 应用程序有权访问的资源数也会降至最低。</span><span class="sxs-lookup"><span data-stu-id="0a600-245">By reducing the set of permissions to only those that are needed, even if they are less than those provided by the launch zone's permission set, the number of resources that the application has access to is reduced to a bare minimum.</span></span> <span data-ttu-id="0a600-246">因此，如果截获到应用程序，将可以降低对客户端计算机的潜在损坏几率。</span><span class="sxs-lookup"><span data-stu-id="0a600-246">Consequently, if the application is hijacked, the potential for damage to the client machine is reduced.</span></span>  
  
<a name="Security_Critical_Methodology"></a>   
### <a name="security-critical-methodology"></a><span data-ttu-id="0a600-247">安全-关键方法</span><span class="sxs-lookup"><span data-stu-id="0a600-247">Security-Critical Methodology</span></span>  
 <span data-ttu-id="0a600-248">使用[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]权限启用用于 XBAP 应用程序的 Internet 区域沙盒的代码必须保持最高的安全审核和控制度。</span><span class="sxs-lookup"><span data-stu-id="0a600-248">The [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] code that uses permissions to enable the Internet zone sandbox for XBAP applications must be held to highest possible degree of security audit and control.</span></span> <span data-ttu-id="0a600-249">为了满足此要求, .NET Framework 为管理提升特权的代码提供了新支持。</span><span class="sxs-lookup"><span data-stu-id="0a600-249">To facilitate this requirement, .NET Framework provides new support for managing code that elevates privilege.</span></span> <span data-ttu-id="0a600-250">具体而言, CLR 使你能够标识提升权限的代码, 并使用对<xref:System.Security.SecurityCriticalAttribute>其进行标记; 任何未<xref:System.Security.SecurityCriticalAttribute>标记为的代码都将使用此方法变得*透明*。</span><span class="sxs-lookup"><span data-stu-id="0a600-250">Specifically, the CLR enables you to identify code that elevates privilege and mark it with the <xref:System.Security.SecurityCriticalAttribute>; any code not marked with <xref:System.Security.SecurityCriticalAttribute> becomes *transparent* using this methodology.</span></span> <span data-ttu-id="0a600-251">反之，禁止未标有 <xref:System.Security.SecurityCriticalAttribute> 的托管代码提升特权。</span><span class="sxs-lookup"><span data-stu-id="0a600-251">Conversely, managed code that is not marked with <xref:System.Security.SecurityCriticalAttribute> is prevented from elevating privilege.</span></span>  
  
 <span data-ttu-id="0a600-252">安全关键方法允许将提升特权的[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]代码组织到*安全关键内核*中, 并使剩余部分透明。</span><span class="sxs-lookup"><span data-stu-id="0a600-252">The Security-Critical Methodology allows the organization of [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] code that elevates privilege into *security-critical kernel*, with the remainder being transparent.</span></span> <span data-ttu-id="0a600-253">隔离安全关键代码可使[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]工程团队将附加的安全分析和源控制重点放在安全关键内核之上, 而不是标准安全实践 (请参阅[WPF 安全策略-安全性)工程](wpf-security-strategy-security-engineering.md))。</span><span class="sxs-lookup"><span data-stu-id="0a600-253">Isolating the security-critical code enables the [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] engineering team focus an additional security analysis and source control on the security-critical kernel above and beyond standard security practices (see [WPF Security Strategy - Security Engineering](wpf-security-strategy-security-engineering.md)).</span></span>  
  
 <span data-ttu-id="0a600-254">请注意, .NET Framework 允许受信任的代码通过允许开发人员编写标记<xref:System.Security.AllowPartiallyTrustedCallersAttribute>为 (APTCA) 并部署到用户的全局程序集缓存 (GAC) 的托管程序集来扩展 XBAP Internet 区域沙盒。</span><span class="sxs-lookup"><span data-stu-id="0a600-254">Note that .NET Framework permits trusted code to extend the XBAP Internet zone sandbox by allowing developers to write managed assemblies that are marked with <xref:System.Security.AllowPartiallyTrustedCallersAttribute> (APTCA) and deployed to the user's Global Assembly Cache (GAC).</span></span> <span data-ttu-id="0a600-255">将程序集标记为 APTCA 是高度敏感的安全操作，因为它允许任何代码调用该程序集，包括来自 Internet 的恶意代码。</span><span class="sxs-lookup"><span data-stu-id="0a600-255">Marking an assembly with APTCA is a highly sensitive security operation as it allows any code to call that assembly, including malicious code from the Internet.</span></span> <span data-ttu-id="0a600-256">执行此操作时，要特别注意并且必须采用最佳做法，用户必须选择信任该软件才能完成安装。</span><span class="sxs-lookup"><span data-stu-id="0a600-256">Extreme caution and best practices must be used when doing this and users must choose to trust that software in order for it to be installed.</span></span>  
  
<a name="Microsoft_Internet_Explorer_Security"></a>   
## <a name="microsoft-internet-explorer-security"></a><span data-ttu-id="0a600-257">Microsoft Internet Explorer 安全</span><span class="sxs-lookup"><span data-stu-id="0a600-257">Microsoft Internet Explorer Security</span></span>  
 <span data-ttu-id="0a600-258">除减少安全问题和简化安全配置外，[!INCLUDE[TLA#tla_ie6sp2](../../../includes/tlasharptla-ie6sp2-md.md)] 还包含好几个增强安全的功能，从而提高了 [!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)] 用户的安全。</span><span class="sxs-lookup"><span data-stu-id="0a600-258">Beyond reducing security issues and simplifying security configuration, [!INCLUDE[TLA#tla_ie6sp2](../../../includes/tlasharptla-ie6sp2-md.md)] contains several features that security improvements that enhance security for users of [!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)].</span></span> <span data-ttu-id="0a600-259">这些功能的主旨是尝试允许用户更好地控制它们的浏览体验。</span><span class="sxs-lookup"><span data-stu-id="0a600-259">The thrust of these features attempts to allow users greater control over their browsing experience.</span></span>  
  
 <span data-ttu-id="0a600-260">在 [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] 之前，用户可能会受限于以下任一项：</span><span class="sxs-lookup"><span data-stu-id="0a600-260">Prior to [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)], users could be subject to any of the following:</span></span>  
  
- <span data-ttu-id="0a600-261">随机弹出窗口。</span><span class="sxs-lookup"><span data-stu-id="0a600-261">Random popup windows.</span></span>  
  
- <span data-ttu-id="0a600-262">混淆的脚本重定向。</span><span class="sxs-lookup"><span data-stu-id="0a600-262">Confusing script redirection.</span></span>  
  
- <span data-ttu-id="0a600-263">某些网站上出现大量安全对话框。</span><span class="sxs-lookup"><span data-stu-id="0a600-263">Numerous security dialogs on some Web sites.</span></span>  
  
 <span data-ttu-id="0a600-264">在某些情况下, 不受信任的网站将尝试通过欺骗性[!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)]安装或重复显示 Microsoft ActiveX 安装对话框 (即使用户可能已将其取消) 来欺骗用户。</span><span class="sxs-lookup"><span data-stu-id="0a600-264">In some cases, untrustworthy Web sites would try to trick users by spoofing installation [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] or repeatedly showing a Microsoft ActiveX installation dialog box, even though the user may have canceled it.</span></span> <span data-ttu-id="0a600-265">使用这些技术，有可能会有相当多的用户上当受骗，从而导致安装间谍软件应用程序。</span><span class="sxs-lookup"><span data-stu-id="0a600-265">Using these techniques, it is possible that a significant number of users have been tricked into making poor decisions that resulted with the installation of spyware applications.</span></span>  
  
 [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] <span data-ttu-id="0a600-266">包括用于缓解围绕用户启动这些问题类型的多个功能。</span><span class="sxs-lookup"><span data-stu-id="0a600-266">includes several features to mitigate these types of issues, which revolve around the concept of user initiation.</span></span> [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)]<span data-ttu-id="0a600-267">检测用户在操作之前单击了某个链接或页面元素 (称为*用户启动*), 并以不同于页面上脚本触发的类似操作的方式对其进行处理。</span><span class="sxs-lookup"><span data-stu-id="0a600-267">detects when a user has clicked on a link or page element prior to an action, which is known as *user initiation*, and treats it differently than when a similar action is instead triggered by the script on a page.</span></span> <span data-ttu-id="0a600-268">例如, [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)]合并了一个**弹出窗口阻止**程序, 该程序可检测用户在页面创建弹出窗口之前单击按钮的时间。</span><span class="sxs-lookup"><span data-stu-id="0a600-268">As an example, [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] incorporates a **Pop-Up Blocker** that detects when a user clicks a button prior to the page creating a pop-up.</span></span> <span data-ttu-id="0a600-269">此程序可使 [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] 允许大多数没有威胁的弹出窗口，同时阻止用户既没有要求也不需要的弹出窗口。</span><span class="sxs-lookup"><span data-stu-id="0a600-269">This enables [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] to allow most innocuous pop-ups while preventing pop-ups that users neither ask for nor want.</span></span> <span data-ttu-id="0a600-270">阻止的弹出窗口会在新的**信息栏**下捕获, 这允许用户手动替代块并查看弹出窗口。</span><span class="sxs-lookup"><span data-stu-id="0a600-270">Blocked pop-ups are trapped under the new **Information Bar**, which allows the user to manually override the block and view the pop-up.</span></span>  
  
 <span data-ttu-id="0a600-271">相同的用户启动逻辑也适用于**打开**/**保存**安全提示。</span><span class="sxs-lookup"><span data-stu-id="0a600-271">The same user-initiation logic is also applied to **Open**/**Save** security prompts.</span></span> <span data-ttu-id="0a600-272">始终在信息栏下捕获 ActiveX 安装对话框, 除非它们表示从以前安装的控件进行升级。</span><span class="sxs-lookup"><span data-stu-id="0a600-272">ActiveX installation dialog boxes are always trapped under the Information Bar unless they represent an upgrade from a previously installed control.</span></span> <span data-ttu-id="0a600-273">这些度量值组合在一起，可提供用户更安全、更可控的用户体验，因为诱导他们安装不需要的软件或恶意软件的站点受到了保护。</span><span class="sxs-lookup"><span data-stu-id="0a600-273">These measures combine to give users a safer, more controlled user experience since they are protected against sites which harass them to install either unwanted or malicious software.</span></span>  
  
 <span data-ttu-id="0a600-274">这些功能还可以对使用 [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] 浏览网站（允许他们下载和安装 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 应用程序）的用户提供保护。</span><span class="sxs-lookup"><span data-stu-id="0a600-274">These features also protect customers who use [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] to browse to web sites that allow them to download and install [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications.</span></span> <span data-ttu-id="0a600-275">特别是，这是因为 [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] 提供的用户体验更好，降低了安装恶意或“狡猾”的应用程序的几率，而不考虑用于构建它的技术类型，包括 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="0a600-275">In particular, this is because [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] offers a better user experience that reduces the chance for users to install malicious or devious applications irrespective of what technology was used to build it, including [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)].</span></span> [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="0a600-276">使用 ClickOnce 添加到这些保护, 以便通过 Internet 下载其应用程序。</span><span class="sxs-lookup"><span data-stu-id="0a600-276">adds to these protections by using ClickOnce to facilitate downloading of its applications over the Internet.</span></span> <span data-ttu-id="0a600-277">由于 [!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)] 是在 Internet 区域安全沙盒内执行，因此可以无缝地启动它们。</span><span class="sxs-lookup"><span data-stu-id="0a600-277">Since [!INCLUDE[TLA#tla_winfxwebapp#plural](../../../includes/tlasharptla-winfxwebappsharpplural-md.md)] execute within an Internet zone security sandbox, they can be seamlessly launched.</span></span> <span data-ttu-id="0a600-278">另一方面，独立的 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 应用程序需要完全信任才能执行。</span><span class="sxs-lookup"><span data-stu-id="0a600-278">On the other hand, standalone [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications require full trust to execute.</span></span> <span data-ttu-id="0a600-279">对于这些应用程序, ClickOnce 将在启动过程中显示一个安全对话框, 以通知使用应用程序的其他安全要求。</span><span class="sxs-lookup"><span data-stu-id="0a600-279">For these applications, ClickOnce will display a security dialog box during the launch process to notify the use of the application's additional security requirements.</span></span> <span data-ttu-id="0a600-280">但是，必须由用户启动，必须由用户启动的逻辑进行管理并且可以取消。</span><span class="sxs-lookup"><span data-stu-id="0a600-280">However, this must be user-initiated, will also be governed by user initiated logic, and can be canceled.</span></span>  
  
 [!INCLUDE[TLA2#tla_ie7](../../../includes/tla2sharptla-ie7-md.md)]<span data-ttu-id="0a600-281">包含并扩展了作为持续提供安全承诺一部分的 [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] 的安全功能。</span><span class="sxs-lookup"><span data-stu-id="0a600-281">incorporates and extends the security capabilities of [!INCLUDE[TLA2#tla_ie6sp2](../../../includes/tla2sharptla-ie6sp2-md.md)] as part of an ongoing commitment to security.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0a600-282">请参阅</span><span class="sxs-lookup"><span data-stu-id="0a600-282">See also</span></span>

- [<span data-ttu-id="0a600-283">代码访问安全性</span><span class="sxs-lookup"><span data-stu-id="0a600-283">Code Access Security</span></span>](../misc/code-access-security.md)
- [<span data-ttu-id="0a600-284">安全性</span><span class="sxs-lookup"><span data-stu-id="0a600-284">Security</span></span>](security-wpf.md)
- [<span data-ttu-id="0a600-285">WPF 部分信任安全</span><span class="sxs-lookup"><span data-stu-id="0a600-285">WPF Partial Trust Security</span></span>](wpf-partial-trust-security.md)
- [<span data-ttu-id="0a600-286">WPF 安全策略 - 安全工程</span><span class="sxs-lookup"><span data-stu-id="0a600-286">WPF Security Strategy - Security Engineering</span></span>](wpf-security-strategy-security-engineering.md)
