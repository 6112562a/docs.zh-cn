---
title: LINQ to DataSet 概述
ms.date: 03/30/2017
ms.assetid: dc20a8fb-03f6-4b68-9c2b-7f7299e3070b
ms.openlocfilehash: 635f1c17da40095990c238912f9e09ad398e6637
ms.sourcegitcommit: 5b6d778ebb269ee6684fb57ad69a8c28b06235b9
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/08/2019
ms.locfileid: "59073671"
---
# <a name="linq-to-dataset-overview"></a><span data-ttu-id="e145f-102">LINQ to DataSet 概述</span><span class="sxs-lookup"><span data-stu-id="e145f-102">LINQ to DataSet Overview</span></span>
<span data-ttu-id="e145f-103"><xref:System.Data.DataSet> 是更为广泛使用的 [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] 组件之一。</span><span class="sxs-lookup"><span data-stu-id="e145f-103">The <xref:System.Data.DataSet> is one of the more widely used components of [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)].</span></span> <span data-ttu-id="e145f-104">它是 [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] 所基于的断开连接式编程模型的关键元素，使用它可以显式缓存不同数据源中的数据。</span><span class="sxs-lookup"><span data-stu-id="e145f-104">It is a key element of the disconnected programming model that [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] is based on, and it enables you to explicitly cache data from different data sources.</span></span> <span data-ttu-id="e145f-105">在表示层上，<xref:System.Data.DataSet> 与 GUI 控件紧密集成，以进行数据绑定。</span><span class="sxs-lookup"><span data-stu-id="e145f-105">For the presentation tier, the <xref:System.Data.DataSet> is tightly integrated with GUI controls for data-binding.</span></span> <span data-ttu-id="e145f-106">在中间层上，它提供保留数据关系形状的缓存并包括快速简单查询和层次结构导航服务。</span><span class="sxs-lookup"><span data-stu-id="e145f-106">For the middle-tier, it provides a cache that preserves the relational shape of data, and includes fast simple query and hierarchy navigation services.</span></span> <span data-ttu-id="e145f-107">用于减少对数据库的请求数的常用技术是使用 <xref:System.Data.DataSet> 以便在中间层进行缓存。</span><span class="sxs-lookup"><span data-stu-id="e145f-107">A common technique used to lower the number of requests on a database is to use the <xref:System.Data.DataSet> for caching in the middle-tier.</span></span> <span data-ttu-id="e145f-108">例如，考虑数据驱动的 [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Web 应用程序。</span><span class="sxs-lookup"><span data-stu-id="e145f-108">For example, consider a data-driven [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Web application.</span></span> <span data-ttu-id="e145f-109">通常，应用程序的绝大部分数据不会经常更改，属于会话之间或用户之间的公共数据。</span><span class="sxs-lookup"><span data-stu-id="e145f-109">Often, a significant portion of the application data does not change frequently and is common across sessions or users.</span></span> <span data-ttu-id="e145f-110">此数据可以保存在 Web 服务器的内存中，这会减少对数据库的请求数并加速用户的交互。</span><span class="sxs-lookup"><span data-stu-id="e145f-110">This data can be kept in memory on the Web server, which reduces the number of requests against the database and speeds up the user’s interactions.</span></span> <span data-ttu-id="e145f-111">另一个有用特征的<xref:System.Data.DataSet>是它允许应用程序到应用程序空间从一个或多个数据源将数据子集。</span><span class="sxs-lookup"><span data-stu-id="e145f-111">Another useful aspect of the <xref:System.Data.DataSet> is that it allows an application to bring subsets of data from one or more data source into the application space.</span></span> <span data-ttu-id="e145f-112">然后，应用程序可以在内存中操作这些数据，同时保留其关系形状。</span><span class="sxs-lookup"><span data-stu-id="e145f-112">The application can then manipulate the data in-memory, while retaining its relational shape.</span></span>  
  
 <span data-ttu-id="e145f-113"><xref:System.Data.DataSet> 虽然具有突出的优点，但其查询功能也存在限制。</span><span class="sxs-lookup"><span data-stu-id="e145f-113">Despite its prominence, the <xref:System.Data.DataSet> has limited query capabilities.</span></span> <span data-ttu-id="e145f-114"><xref:System.Data.DataTable.Select%2A> 方法可用于筛选和排序，<xref:System.Data.DataRow.GetChildRows%2A> 和 <xref:System.Data.DataRow.GetParentRow%2A> 方法可用于层次结构导航。</span><span class="sxs-lookup"><span data-stu-id="e145f-114">The <xref:System.Data.DataTable.Select%2A> method can be used for filtering and sorting, and the <xref:System.Data.DataRow.GetChildRows%2A> and <xref:System.Data.DataRow.GetParentRow%2A> methods can be used for hierarchy navigation.</span></span> <span data-ttu-id="e145f-115">但对于更复杂的情况，开发人员必须编写自定义查询。</span><span class="sxs-lookup"><span data-stu-id="e145f-115">For anything more complex, however, the developer must write a custom query.</span></span> <span data-ttu-id="e145f-116">这会使应用程序性能低下并且难以维护。</span><span class="sxs-lookup"><span data-stu-id="e145f-116">This can result in applications that perform poorly and are difficult to maintain.</span></span>  
  
 [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] <span data-ttu-id="e145f-117">可以更轻松、 更快地查询缓存中的数据<xref:System.Data.DataSet>对象。</span><span class="sxs-lookup"><span data-stu-id="e145f-117">makes it easier and faster to query over data cached in a <xref:System.Data.DataSet> object.</span></span> <span data-ttu-id="e145f-118">这些查询用编程语言本身表示，而不表示为嵌入在应用程序代码中的字符串。</span><span class="sxs-lookup"><span data-stu-id="e145f-118">These queries are expressed in the programming language itself, rather than as string literals embedded in the application code.</span></span> <span data-ttu-id="e145f-119">这意味着开发人员不必学习单独的查询语言。</span><span class="sxs-lookup"><span data-stu-id="e145f-119">This means that developers do not have to learn a separate query language.</span></span> <span data-ttu-id="e145f-120">此外，[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]使 Visual Studio 开发人员能够更高效地工作，因为 Visual Studio IDE 提供编译时语法检查、 静态类型化和 IntelliSense 支持[!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="e145f-120">Additionally, [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] enables Visual Studio developers to work more productively, because the Visual Studio IDE provides compile-time syntax checking, static typing, and IntelliSense support for [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)].</span></span> [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] <span data-ttu-id="e145f-121">此外可对已从一个或多个数据源合并的数据执行查询。</span><span class="sxs-lookup"><span data-stu-id="e145f-121">can also be used to query over data that has been consolidated from one or more data sources.</span></span> <span data-ttu-id="e145f-122">这可以使许多需要灵活表示和处理数据的方案能够实现。</span><span class="sxs-lookup"><span data-stu-id="e145f-122">This enables many scenarios that require flexibility in how data is represented and handled.</span></span> <span data-ttu-id="e145f-123">具体地说，一般报告、分析和业务智能应用程序将需要这种操作方法。</span><span class="sxs-lookup"><span data-stu-id="e145f-123">In particular, generic reporting, analysis, and business intelligence applications require this method of manipulation.</span></span>  
  
## <a name="querying-datasets-using-linq-to-dataset"></a><span data-ttu-id="e145f-124">使用 LINQ to DataSet 查询数据集</span><span class="sxs-lookup"><span data-stu-id="e145f-124">Querying DataSets Using LINQ to DataSet</span></span>  
 <span data-ttu-id="e145f-125">只有在填充 <xref:System.Data.DataSet> 后，您才能开始使用 [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] 来查询 <xref:System.Data.DataSet> 对象。</span><span class="sxs-lookup"><span data-stu-id="e145f-125">Before you can begin querying a <xref:System.Data.DataSet> object using [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)], you must populate the <xref:System.Data.DataSet>.</span></span> <span data-ttu-id="e145f-126">有几种方法将数据加载到<xref:System.Data.DataSet>，例如，使用<xref:System.Data.Common.DataAdapter>类或[LINQ to SQL](../../../../docs/framework/data/adonet/sql/linq/index.md)。</span><span class="sxs-lookup"><span data-stu-id="e145f-126">There are several ways to load data into a <xref:System.Data.DataSet>, such as using the <xref:System.Data.Common.DataAdapter> class or [LINQ to SQL](../../../../docs/framework/data/adonet/sql/linq/index.md).</span></span> <span data-ttu-id="e145f-127">将数据加载到 <xref:System.Data.DataSet> 对象后，可以开始查询数据。</span><span class="sxs-lookup"><span data-stu-id="e145f-127">After the data has been loaded into a <xref:System.Data.DataSet> object, you can begin to query it.</span></span> <span data-ttu-id="e145f-128">来表述查询使用[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]类似于使用[!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)]对其他[!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)]-启用数据源。</span><span class="sxs-lookup"><span data-stu-id="e145f-128">Formulating queries using [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] is similar to using [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] against other [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)]-enabled data sources.</span></span> [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] <span data-ttu-id="e145f-129">可以针对中的单个表执行查询<xref:System.Data.DataSet>或通过使用多个表针对<xref:System.Linq.Enumerable.Join%2A>和<xref:System.Linq.Enumerable.GroupJoin%2A>标准查询运算符。</span><span class="sxs-lookup"><span data-stu-id="e145f-129">queries can be performed against single tables in a <xref:System.Data.DataSet> or against more than one table by using the <xref:System.Linq.Enumerable.Join%2A> and <xref:System.Linq.Enumerable.GroupJoin%2A> standard query operators.</span></span>  
  
 [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] <span data-ttu-id="e145f-130">对类型化和非类型化的支持查询<xref:System.Data.DataSet>对象。</span><span class="sxs-lookup"><span data-stu-id="e145f-130">queries are supported against both typed and untyped <xref:System.Data.DataSet> objects.</span></span> <span data-ttu-id="e145f-131">如果在应用程序设计时已知 <xref:System.Data.DataSet> 的架构，则建议使用类型化 <xref:System.Data.DataSet>。</span><span class="sxs-lookup"><span data-stu-id="e145f-131">If the schema of the <xref:System.Data.DataSet> is known at application design time, a typed <xref:System.Data.DataSet> is recommended.</span></span> <span data-ttu-id="e145f-132">在类型化 <xref:System.Data.DataSet> 中，表和行对每个列都具有类型化成员，从而使查询更简单并且更具可读性。</span><span class="sxs-lookup"><span data-stu-id="e145f-132">In a typed <xref:System.Data.DataSet>, the tables and rows have typed members for each of the columns, which makes queries simpler and more readable.</span></span>  
  
 <span data-ttu-id="e145f-133">除了 System.Core.dll 中实现的标准查询运算符外，[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] 还添加了多种 <xref:System.Data.DataSet> 特定扩展，从而可以更容易地查询一组 <xref:System.Data.DataRow> 对象。</span><span class="sxs-lookup"><span data-stu-id="e145f-133">In addition to the standard query operators implemented in System.Core.dll, [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] adds several <xref:System.Data.DataSet>-specific extensions that make it easier to query over a set of <xref:System.Data.DataRow> objects.</span></span> <span data-ttu-id="e145f-134">这些 <xref:System.Data.DataSet> 特定扩展包括用于比较行序列的运算符以及用于访问 <xref:System.Data.DataRow> 的列值的方法。</span><span class="sxs-lookup"><span data-stu-id="e145f-134">These <xref:System.Data.DataSet>-specific extensions include operators for comparing sequences of rows, as well as methods that provide access to the column values of a <xref:System.Data.DataRow>.</span></span>  
  
## <a name="n-tier-applications-and-linq-to-dataset"></a><span data-ttu-id="e145f-135">N 层应用程序和 LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="e145f-135">N-tier Applications and LINQ to DataSet</span></span>  
 <span data-ttu-id="e145f-136">N 层数据应用程序是以数据为中心的应用程序，分为多个逻辑层（或层）。</span><span class="sxs-lookup"><span data-stu-id="e145f-136">N-tier data applications are data-centric applications that are separated into multiple logical layers (or tiers).</span></span> <span data-ttu-id="e145f-137">典型的 N 层应用程序包括一个表示层、一个中间层和一个数据层。</span><span class="sxs-lookup"><span data-stu-id="e145f-137">A typical N-tier application includes a presentation tier, a middle tier, and a data tier.</span></span> <span data-ttu-id="e145f-138">将应用程序组件分离到不同的层可提高应用程序的可维护性和可伸缩性。</span><span class="sxs-lookup"><span data-stu-id="e145f-138">Separating application components into separate tiers increases the maintainability and scalability of the application.</span></span> <span data-ttu-id="e145f-139">有关 N 层数据应用程序的详细信息，请参阅[使用 n 层应用程序中的数据集](/visualstudio/data-tools/work-with-datasets-in-n-tier-applications)。</span><span class="sxs-lookup"><span data-stu-id="e145f-139">For more information about N-tier data applications, see [Work with datasets in n-tier applications](/visualstudio/data-tools/work-with-datasets-in-n-tier-applications).</span></span>  
  
 <span data-ttu-id="e145f-140">在 N 层应用程序中，<xref:System.Data.DataSet> 通常用于中间层以缓存 Web 应用程序的信息。</span><span class="sxs-lookup"><span data-stu-id="e145f-140">In N-tier applications, the <xref:System.Data.DataSet> is often used in the middle-tier to cache information for a Web application.</span></span> <span data-ttu-id="e145f-141">[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] 查询功能通过扩展方法实现，并扩展现有的 ADO.NET 2.0 <xref:System.Data.DataSet>。</span><span class="sxs-lookup"><span data-stu-id="e145f-141">The [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] querying functionality is implemented through extension methods and extends the existing ADO.NET 2.0 <xref:System.Data.DataSet>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e145f-142">请参阅</span><span class="sxs-lookup"><span data-stu-id="e145f-142">See also</span></span>

- [<span data-ttu-id="e145f-143">查询数据集</span><span class="sxs-lookup"><span data-stu-id="e145f-143">Querying DataSets</span></span>](../../../../docs/framework/data/adonet/querying-datasets-linq-to-dataset.md)
- [<span data-ttu-id="e145f-144">语言集成查询 (LINQ)-C#</span><span class="sxs-lookup"><span data-stu-id="e145f-144">Language-Integrated Query (LINQ) - C#</span></span>](../../../csharp/programming-guide/concepts/linq/index.md)
- [<span data-ttu-id="e145f-145">语言集成查询 (LINQ) 的 Visual Basic</span><span class="sxs-lookup"><span data-stu-id="e145f-145">Language-Integrated Query (LINQ) - Visual Basic</span></span>](../../../visual-basic/programming-guide/concepts/linq/index.md)
- [<span data-ttu-id="e145f-146">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="e145f-146">LINQ to SQL</span></span>](../../../../docs/framework/data/adonet/sql/linq/index.md)
