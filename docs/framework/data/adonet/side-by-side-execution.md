---
title: ADO.NET 中的并行执行
ms.date: 03/30/2017
ms.assetid: 9f9ba96d-9f89-4f65-bb2f-6860879f4393
ms.openlocfilehash: 377af3c72b0a9a8eb26c8713d98f114803f08356
ms.sourcegitcommit: c7a7e1468bf0fa7f7065de951d60dfc8d5ba89f5
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/14/2019
ms.locfileid: "65583619"
---
# <a name="side-by-side-execution-in-adonet"></a><span data-ttu-id="3128a-102">ADO.NET 中的并行执行</span><span class="sxs-lookup"><span data-stu-id="3128a-102">Side-by-Side Execution in ADO.NET</span></span>
<span data-ttu-id="3128a-103">.NET Framework 中的并行执行是在具有多个版本的安装，以独占方式使用为其编译应用程序的版本的.NET Framework 的计算机上执行应用程序的功能。</span><span class="sxs-lookup"><span data-stu-id="3128a-103">Side-by-side execution in the .NET Framework is the ability to execute an application on a computer that has multiple versions of the .NET Framework installed, exclusively using the version for which the application was compiled.</span></span> <span data-ttu-id="3128a-104">有关配置通过并行执行的详细信息，请参阅[-并行执行](../../../../docs/framework/deployment/side-by-side-execution.md)。</span><span class="sxs-lookup"><span data-stu-id="3128a-104">For detailed information about configuring side-by-side execution, see [Side-by-Side Execution](../../../../docs/framework/deployment/side-by-side-execution.md).</span></span>  
  
 <span data-ttu-id="3128a-105">编译使用.NET Framework 的一个版本的应用程序可以运行不同版本的.NET Framework 上。</span><span class="sxs-lookup"><span data-stu-id="3128a-105">An application compiled by using one version of the .NET Framework can run on a different version of the .NET Framework.</span></span> <span data-ttu-id="3128a-106">但是，我们建议你编译的.NET Framework 中，每个已安装版本的应用程序的版本，并单独运行这些。</span><span class="sxs-lookup"><span data-stu-id="3128a-106">However, we recommend that you compile a version of the application for each installed version of the .NET Framework, and run them separately.</span></span> <span data-ttu-id="3128a-107">在任一方案中，您都应该知道各版本之间 [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] 中的更改，这些更改可能影响应用程序的向前或向后兼容性。</span><span class="sxs-lookup"><span data-stu-id="3128a-107">In either scenario, you should be aware of changes in [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] between releases that can affect the forward compatibility or backward compatibility of your application.</span></span>  
  
## <a name="forward-compatibility-and-backward-compatibility"></a><span data-ttu-id="3128a-108">向前兼容性和向后兼容性</span><span class="sxs-lookup"><span data-stu-id="3128a-108">Forward Compatibility and Backward Compatibility</span></span>  
 <span data-ttu-id="3128a-109">向前兼容性表示应用程序可以使用.NET Framework 的早期版本进行编译，但将仍在更高版本的.NET framework 上成功运行。</span><span class="sxs-lookup"><span data-stu-id="3128a-109">Forward compatibility means that an application can be compiled with an earlier version of the .NET Framework, but will still run successfully on a later version of the .NET Framework.</span></span> [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] <span data-ttu-id="3128a-110">针对.NET Framework 1.1 版编写的代码是与更高版本向前兼容。</span><span class="sxs-lookup"><span data-stu-id="3128a-110">code written for the .NET Framework version 1.1 is forward compatible with later versions.</span></span>  
  
 <span data-ttu-id="3128a-111">向后兼容性表示应用程序编译为.NET Framework 的较新版本，但仍会继续而不丧失任何功能的.NET framework 的早期版本上运行。</span><span class="sxs-lookup"><span data-stu-id="3128a-111">Backward compatibility means that an application is compiled for a newer version of the .NET Framework, but continues to run on earlier versions of the .NET Framework without any loss of functionality.</span></span> <span data-ttu-id="3128a-112">当然，这不会对.NET Framework 的新版本中引入的功能。</span><span class="sxs-lookup"><span data-stu-id="3128a-112">Of course, this will not be the case for features introduced in a new version of the .NET Framework.</span></span>  
  
## <a name="the-net-framework-data-provider-for-odbc"></a><span data-ttu-id="3128a-113">ODBC .NET Framework 数据提供程序</span><span class="sxs-lookup"><span data-stu-id="3128a-113">The .NET Framework Data Provider for ODBC</span></span>  
 <span data-ttu-id="3128a-114">从版本 1.1 中，用于 ODBC 的.NET Framework 数据提供程序 (<xref:System.Data.Odbc>) 是作为.NET Framework 的一部分包含在内。</span><span class="sxs-lookup"><span data-stu-id="3128a-114">Starting with version 1.1, the .NET Framework Data Provider for ODBC (<xref:System.Data.Odbc>) is included as a part of the .NET Framework.</span></span> <span data-ttu-id="3128a-115">ODBC 数据提供程序是用.NET Framework 1.0 版开发人员从 Web 下载[数据访问和存储开发人员中心](https://go.microsoft.com/fwlink/?linkid=4173)。</span><span class="sxs-lookup"><span data-stu-id="3128a-115">The ODBC data provider is available to .NET Framework version 1.0 developers as a Web download from the [Data Access and Storage Developer Center](https://go.microsoft.com/fwlink/?linkid=4173).</span></span> <span data-ttu-id="3128a-116">适用于 ODBC 下载.NET Framework 数据提供程序的命名空间是**Microsoft.Data.Odbc**。</span><span class="sxs-lookup"><span data-stu-id="3128a-116">The namespace for the downloaded .NET Framework Data Provider for ODBC is **Microsoft.Data.Odbc**.</span></span>  
  
 <span data-ttu-id="3128a-117">如果必须针对.NET Framework 版本使用 ODBC 数据提供程序连接到数据源，1.0 开发的应用程序，并且你想要在.NET Framework 1.1 版或更高版本上运行该应用程序，则必须更新 ODBC dat 的命名空间提供者**System.Data.Odbc**。</span><span class="sxs-lookup"><span data-stu-id="3128a-117">If you have an application developed for the .NET Framework version 1.0 that uses the ODBC data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.1 or a later version, you must update the namespace for the ODBC data provider to **System.Data.Odbc**.</span></span> <span data-ttu-id="3128a-118">您然后必须重新编译它为.NET Framework 的较新版本。</span><span class="sxs-lookup"><span data-stu-id="3128a-118">You then must recompile it for the newer version of the .NET Framework.</span></span>  
  
 <span data-ttu-id="3128a-119">如果必须为使用 ODBC 数据提供程序连接到数据源，.NET Framework 2.0 或更高版本开发的应用程序，并且你想要在.NET Framework 1.0 版上运行该应用程序，必须下载该 ODBC 数据提供程序并安装它在.NET Framework 1.0 版的系统。</span><span class="sxs-lookup"><span data-stu-id="3128a-119">If you have an application developed for the .NET Framework version 2.0 or later that uses the ODBC data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.0, you must download the ODBC data provider and install it on the .NET Framework version 1.0 system.</span></span> <span data-ttu-id="3128a-120">然后必须更改到 ODBC 数据提供程序的命名空间**Microsoft.Data.Odbc**，并重新编译.NET Framework 1.0 版的应用程序。</span><span class="sxs-lookup"><span data-stu-id="3128a-120">You then must change the namespace for the ODBC data provider to **Microsoft.Data.Odbc**, and recompile the application for the .NET Framework version 1.0.</span></span>  
  
## <a name="the-net-framework-data-provider-for-oracle"></a><span data-ttu-id="3128a-121">Oracle .NET Framework 数据提供程序</span><span class="sxs-lookup"><span data-stu-id="3128a-121">The .NET Framework Data Provider for Oracle</span></span>  
 <span data-ttu-id="3128a-122">从版本 1.1，适用于 Oracle 的.NET Framework 数据提供程序开始 (<xref:System.Data.OracleClient>) 是作为.NET Framework 的一部分包含在内。</span><span class="sxs-lookup"><span data-stu-id="3128a-122">Starting with version 1.1, the .NET Framework Data Provider for Oracle (<xref:System.Data.OracleClient>) is included as a part of the .NET Framework.</span></span> <span data-ttu-id="3128a-123">数据提供程序是用.NET Framework 1.0 版开发人员从 Web 下载[数据访问和存储开发人员中心](https://go.microsoft.com/fwlink/?linkid=4173)。</span><span class="sxs-lookup"><span data-stu-id="3128a-123">The data provider is available to .NET Framework version 1.0 developers as a Web download from the [Data Access and Storage Developer Center](https://go.microsoft.com/fwlink/?linkid=4173).</span></span>  
  
 <span data-ttu-id="3128a-124">如果必须为使用的数据提供程序连接到您的数据源，.NET Framework 2.0 或更高版本开发的应用程序，并且你想要在.NET Framework 1.0 版上运行该应用程序，必须下载数据提供程序并将其安装在.NET Framework 1.0 版的系统。</span><span class="sxs-lookup"><span data-stu-id="3128a-124">If you have an application developed for the .NET Framework version 2.0 or later that uses the data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.0, you must download the data provider and install it on the .NET Framework version 1.0 system.</span></span>  
  
## <a name="code-access-security"></a><span data-ttu-id="3128a-125">代码访问安全性</span><span class="sxs-lookup"><span data-stu-id="3128a-125">Code Access Security</span></span>  
 <span data-ttu-id="3128a-126">在.NET Framework 1.0 版的.NET Framework 数据提供程序 (<xref:System.Data.SqlClient>， <xref:System.Data.OleDb>) 所需运行具有 FullTrust 权限。</span><span class="sxs-lookup"><span data-stu-id="3128a-126">The .NET Framework data providers in the .NET Framework version 1.0 (<xref:System.Data.SqlClient>, <xref:System.Data.OleDb>) are required to run with FullTrust permission.</span></span> <span data-ttu-id="3128a-127">如果尝试在具有 FullTrust 权限会导致小于的区域中使用.NET Framework 数据提供程序从.NET Framework 1.0 版<xref:System.Security.SecurityException>。</span><span class="sxs-lookup"><span data-stu-id="3128a-127">Any attempt to use the .NET Framework k data providers from the .NET Framework version 1.0 in a zone with less than FullTrust permission causes a <xref:System.Security.SecurityException>.</span></span>  
  
 <span data-ttu-id="3128a-128">但是，从.NET Framework 2.0 版开始，所有.NET Framework 数据提供程序可在部分信任的区域。</span><span class="sxs-lookup"><span data-stu-id="3128a-128">However, starting with the .NET Framework version 2.0, all of the .NET Framework data providers can be used in partially trusted zones.</span></span> <span data-ttu-id="3128a-129">此外，新的安全功能已添加到.NET Framework 1.1 版中的.NET Framework 数据提供程序。</span><span class="sxs-lookup"><span data-stu-id="3128a-129">In addition, a new security feature was added to the .NET Framework data providers in the .NET Framework version 1.1.</span></span> <span data-ttu-id="3128a-130">通过该功能可以限制特定安全区域中可以使用的连接字符串。</span><span class="sxs-lookup"><span data-stu-id="3128a-130">This feature enables you to restrict what connection strings can be used in a particular security zone.</span></span> <span data-ttu-id="3128a-131">您也可以对特定安全区域禁用空白密码。</span><span class="sxs-lookup"><span data-stu-id="3128a-131">You can also disable the use of blank passwords for a particular security zone.</span></span> <span data-ttu-id="3128a-132">有关更多信息，请参见 [Code Access Security and ADO.NET](../../../../docs/framework/data/adonet/code-access-security.md)。</span><span class="sxs-lookup"><span data-stu-id="3128a-132">For more information, see [Code Access Security and ADO.NET](../../../../docs/framework/data/adonet/code-access-security.md).</span></span>  
  
 <span data-ttu-id="3128a-133">由于安装.NET Framework 的每个具有独立的 Security.config 文件，没有使用的安全设置任何兼容性问题。</span><span class="sxs-lookup"><span data-stu-id="3128a-133">Because each installation of the .NET Framework has a separate Security.config file, there are no compatibility issues with security settings.</span></span> <span data-ttu-id="3128a-134">但是，如果应用程序所依赖的其他安全功能[!INCLUDE[vstecado](../../../../includes/vstecado-md.md)]包含在.NET Framework 1.1 及更高版本中，您将无法再将其分发到 1.0 版的系统。</span><span class="sxs-lookup"><span data-stu-id="3128a-134">However, if your application depends on the additional security capabilities of [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] included in the .NET Framework version 1.1 and later, you will not be able to distribute it to a version 1.0 system.</span></span>  
  
## <a name="sqlcommand-execution"></a><span data-ttu-id="3128a-135">SqlCommand 执行</span><span class="sxs-lookup"><span data-stu-id="3128a-135">SqlCommand Execution</span></span>  
 <span data-ttu-id="3128a-136">从.NET Framework 1.1 版中，方法开始的<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>执行命令的数据源已更改。</span><span class="sxs-lookup"><span data-stu-id="3128a-136">Starting with the .NET Framework version 1.1, the way that <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executes commands at the data source was changed.</span></span>  
  
 <span data-ttu-id="3128a-137">在.NET Framework 1.0 版中，<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>的上下文中执行的所有命令**sp_executesql**存储过程。</span><span class="sxs-lookup"><span data-stu-id="3128a-137">In the .NET Framework version 1.0, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executed all commands in the context of the **sp_executesql** stored procedure.</span></span> <span data-ttu-id="3128a-138">因此，影响连接状态的命令（例如，SET NOCOUNT ON）只应用于当前命令的执行。</span><span class="sxs-lookup"><span data-stu-id="3128a-138">As a result, commands that affect the state of the connection (for example, SET NOCOUNT ON), only apply to the execution of the current command.</span></span> <span data-ttu-id="3128a-139">对于在连接打开时执行的任何后续命令，连接状态不会被修改。</span><span class="sxs-lookup"><span data-stu-id="3128a-139">The state of the connection is not modified for any subsequent commands executed while the connection is open.</span></span>  
  
 <span data-ttu-id="3128a-140">在.NET Framework 1.1 及更高版本，版本<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>仅的上下文中执行命令**sp_executesql**存储过程，当命令含有参数，从而提高性能。</span><span class="sxs-lookup"><span data-stu-id="3128a-140">In the .NET Framework version 1.1 and later, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> only executes a command in the context of the **sp_executesql** stored procedure if the command contains parameters, which provides a performance benefit.</span></span> <span data-ttu-id="3128a-141">因此，如果非参数化命令中包含影响连接状态的命令，会修改在连接打开时执行的所有后续命令的连接状态。</span><span class="sxs-lookup"><span data-stu-id="3128a-141">As a result, if a command affecting the state of the connection is included in a non-parameterized command, it modifies the state of the connection for all subsequent commands executed while the connection is open.</span></span>  
  
 <span data-ttu-id="3128a-142">请考虑下面这个在 <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> 调用中执行的批命令。</span><span class="sxs-lookup"><span data-stu-id="3128a-142">Consider the following batch of commands executed in a call to <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>.</span></span>  
  
```sql
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
```  
  
 <span data-ttu-id="3128a-143">在.NET Framework 1.1 及更高版本中，NOCOUNT 将保持该连接打开时执行的任何后续命令为 ON。</span><span class="sxs-lookup"><span data-stu-id="3128a-143">In the .NET Framework version 1.1 and later, NOCOUNT will remain ON for any subsequent commands executed while the connection is open.</span></span> <span data-ttu-id="3128a-144">在.NET Framework 1.0 版中，NOCOUNT 为只在当前命令执行。</span><span class="sxs-lookup"><span data-stu-id="3128a-144">In the .NET Framework version 1.0, NOCOUNT is only ON for the current command execution.</span></span>  
  
 <span data-ttu-id="3128a-145">如果所依赖的行为，此更改会影响你的应用程序的向前和向后兼容<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>两个版本的.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="3128a-145">This change can affect both the forward and backward compatibility of your application if you depend on the behavior of <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> for either version of the .NET Framework.</span></span>  
  
 <span data-ttu-id="3128a-146">对于.NET Framework 的早期版本和更高版本运行的应用程序，可以编写代码以确保该行为是不考虑版本运行相同。</span><span class="sxs-lookup"><span data-stu-id="3128a-146">For applications that run on both earlier and later versions of the .NET Framework, you can write your code to make sure that the behavior is the same regardless of the version you are running on.</span></span> <span data-ttu-id="3128a-147">如果要确保某个命令修改所有后续命令的连接状态，建议您使用 <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A> 来执行该命令。</span><span class="sxs-lookup"><span data-stu-id="3128a-147">If you want to make sure that a command modifies the state of the connection for all subsequent commands, we recommend that you execute your command using <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A>.</span></span> <span data-ttu-id="3128a-148">如果要确保某个命令不修改所有后续命令的连接，建议您在命令中包括用于重置连接状态的命令。</span><span class="sxs-lookup"><span data-stu-id="3128a-148">If you want to make sure that a command does not modify the connection for all subsequent commands, we recommend that you include the commands to reset the state of the connection in your command.</span></span> <span data-ttu-id="3128a-149">例如：</span><span class="sxs-lookup"><span data-stu-id="3128a-149">For example:</span></span>  
  
```sql
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
SET NOCOUNT OFF;  
```  
  
## <a name="see-also"></a><span data-ttu-id="3128a-150">请参阅</span><span class="sxs-lookup"><span data-stu-id="3128a-150">See also</span></span>

- [<span data-ttu-id="3128a-151">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="3128a-151">ADO.NET Overview</span></span>](../../../../docs/framework/data/adonet/ado-net-overview.md)
- [<span data-ttu-id="3128a-152">在 ADO.NET 中检索和修改数据</span><span class="sxs-lookup"><span data-stu-id="3128a-152">Retrieving and Modifying Data in ADO.NET</span></span>](../../../../docs/framework/data/adonet/retrieving-and-modifying-data.md)
- [<span data-ttu-id="3128a-153">ADO.NET 托管提供程序和数据集开发人员中心</span><span class="sxs-lookup"><span data-stu-id="3128a-153">ADO.NET Managed Providers and DataSet Developer Center</span></span>](https://go.microsoft.com/fwlink/?LinkId=217917)
