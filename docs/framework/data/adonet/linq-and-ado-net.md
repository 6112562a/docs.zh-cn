---
title: LINQ 和 ADO.NET
titleSuffix: ''
ms.date: 03/30/2017
ms.assetid: bf0c8f93-3ff7-49f3-8aed-f2b7ac938dec
ms.openlocfilehash: c5b56fa78ce0276953597d63b3d6e2f45d88c8ab
ms.sourcegitcommit: 011314e0c8eb4cf4a11d92078f58176c8c3efd2d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/09/2020
ms.locfileid: "77094431"
---
# <a name="linq-and-adonet"></a><span data-ttu-id="c035a-102">LINQ 和 ADO.NET</span><span class="sxs-lookup"><span data-stu-id="c035a-102">LINQ and ADO.NET</span></span>

<span data-ttu-id="c035a-103">如今，许多业务开发人员都必须使用两种或多种编程语言：用于业务逻辑和表示层（如视觉对象C#或 Visual Basic）的高级语言，以及与数据库交互的查询语言（如 transact-sql）。</span><span class="sxs-lookup"><span data-stu-id="c035a-103">Today, many business developers must use two (or more) programming languages: a high-level language for the business logic and presentation layers (such as Visual C# or Visual Basic), and a query language to interact with the database (such as Transact-SQL).</span></span> <span data-ttu-id="c035a-104">这要求开发人员精通多种语言才能奏效，同时也导致在开发环境中语言不匹配。</span><span class="sxs-lookup"><span data-stu-id="c035a-104">This requires the developer to be proficient in several languages to be effective, and also causes language mismatches in the development environment.</span></span> <span data-ttu-id="c035a-105">例如，使用数据访问 API 对数据库执行查询的应用程序会将查询指定为用引号括起的字符串。</span><span class="sxs-lookup"><span data-stu-id="c035a-105">For example, an application that uses a data access API to execute a query against a database specifies the query as a string literal by using quotation marks.</span></span> <span data-ttu-id="c035a-106">此查询字符串无法读取到编译器，而且不会检查是否存在错误，如语法无效，或者它所引用的列或行是否确实存在。</span><span class="sxs-lookup"><span data-stu-id="c035a-106">This query string is unreadable to the compiler and is not checked for errors, such as invalid syntax or whether the columns or rows it references actually exist.</span></span> <span data-ttu-id="c035a-107">不会检查查询参数的类型，也不支持 `IntelliSense`。</span><span class="sxs-lookup"><span data-stu-id="c035a-107">There is no type checking of the query parameters and no `IntelliSense` support, either.</span></span>  
  
 <span data-ttu-id="c035a-108">使用语言集成查询（LINQ），开发人员可以在其应用程序代码中形成基于集的查询，而不必使用单独的查询语言。</span><span class="sxs-lookup"><span data-stu-id="c035a-108">Language-Integrated Query (LINQ) enables developers to form set-based queries in their application code, without having to use a separate query language.</span></span> <span data-ttu-id="c035a-109">您可以针对各种可枚举数据源（即实现 <xref:System.Collections.IEnumerable> 接口的数据源）编写 LINQ 查询，例如内存中数据结构、XML 文档、SQL 数据库和 <xref:System.Data.DataSet> 对象。</span><span class="sxs-lookup"><span data-stu-id="c035a-109">You can write LINQ queries against various enumerable data sources (that is, a data source that implements the <xref:System.Collections.IEnumerable> interface), such as in-memory data structures, XML documents, SQL databases, and <xref:System.Data.DataSet> objects.</span></span> <span data-ttu-id="c035a-110">虽然这些可枚举数据源以多种方式实现，但它们都公开相同的语法和语言构造。</span><span class="sxs-lookup"><span data-stu-id="c035a-110">Although these enumerable data sources are implemented in various ways, they all expose the same syntax and language constructs.</span></span> <span data-ttu-id="c035a-111">由于可以使用编程语言本身形成查询，因此您不必使用编译器无法理解或验证的以字符串形式嵌入的其他查询语言。</span><span class="sxs-lookup"><span data-stu-id="c035a-111">Because queries can be formed in the programming language itself, you do not have to use another query language that is embedded as string literals that cannot be understood or verified by the compiler.</span></span> <span data-ttu-id="c035a-112">将查询集成到编程语言中，可通过提供编译时类型和语法检查并 `IntelliSense`，使 Visual Studio 程序员提高工作效率。</span><span class="sxs-lookup"><span data-stu-id="c035a-112">Integrating queries into the programming language also enables Visual Studio programmers to be more productive by providing compile-time type and syntax checking, and `IntelliSense`.</span></span> <span data-ttu-id="c035a-113">这些功能降低了对查询调试和错误修复的需求。</span><span class="sxs-lookup"><span data-stu-id="c035a-113">These features reduce the need for query debugging and error fixing.</span></span>  
  
 <span data-ttu-id="c035a-114">将数据从 SQL 表传输到内存中的对象通常单调乏味并容易出错。</span><span class="sxs-lookup"><span data-stu-id="c035a-114">Transferring data from SQL tables into objects in memory is often tedious and error-prone.</span></span> <span data-ttu-id="c035a-115">LINQ to DataSet 和 [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] 实现的 LINQ 提供程序将源数据转换为基于 <xref:System.Collections.IEnumerable>的对象集合。</span><span class="sxs-lookup"><span data-stu-id="c035a-115">The LINQ provider implemented by LINQ to DataSet and [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] converts the source data into <xref:System.Collections.IEnumerable>-based object collections.</span></span> <span data-ttu-id="c035a-116">在您查询数据和更新数据时，程序员始终会以 <xref:System.Collections.IEnumerable> 集合的形式查看这些数据。</span><span class="sxs-lookup"><span data-stu-id="c035a-116">The programmer always views the data as an <xref:System.Collections.IEnumerable> collection, both when you query and when you update.</span></span> <span data-ttu-id="c035a-117">为编写针对这些集合的查询提供完全的 `IntelliSense` 支持。</span><span class="sxs-lookup"><span data-stu-id="c035a-117">Full `IntelliSense` support is provided for writing queries against those collections.</span></span>  
  
 <span data-ttu-id="c035a-118">有三个独立的 ADO.NET 语言集成查询（LINQ）技术： LINQ to DataSet、[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]和 LINQ to Entities。</span><span class="sxs-lookup"><span data-stu-id="c035a-118">There are three separate ADO.NET Language-Integrated Query (LINQ) technologies: LINQ to DataSet, [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], and LINQ to Entities.</span></span> <span data-ttu-id="c035a-119">LINQ to DataSet 通过 <xref:System.Data.DataSet> 提供更丰富的优化查询，[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] 使你可以直接查询 SQL Server 的数据库架构，而 LINQ to Entities 允许查询实体数据模型。</span><span class="sxs-lookup"><span data-stu-id="c035a-119">LINQ to DataSet provides richer, optimized querying over the <xref:System.Data.DataSet> and [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] enables you to directly query SQL Server database schemas, and LINQ to Entities allows you to query an Entity Data Model.</span></span>  
  
 <span data-ttu-id="c035a-120">下面的关系图概述了 ADO.NET LINQ 技术如何关联到高级编程语言和启用 LINQ 的数据源。</span><span class="sxs-lookup"><span data-stu-id="c035a-120">The following diagram provides an overview of how the ADO.NET LINQ technologies relate to high-level programming languages and LINQ-enabled data sources.</span></span>  
  
 <span data-ttu-id="c035a-121">![LINQ to ADO.NET 概述](./media/dpue-linqtoadonetoverview-bpuedev11.gif "DPUE_LinqToAdoNetOverview_bpuedev11")</span><span class="sxs-lookup"><span data-stu-id="c035a-121">![LINQ to ADO.NET overview](./media/dpue-linqtoadonetoverview-bpuedev11.gif "DPUE_LinqToAdoNetOverview_bpuedev11")</span></span>  
  
 <span data-ttu-id="c035a-122">有关 LINQ 的详细信息，请参阅[语言集成查询（LINQ）](../../../csharp/programming-guide/concepts/linq/index.md)。</span><span class="sxs-lookup"><span data-stu-id="c035a-122">For more information about LINQ, see [Language Integrated Query (LINQ)](../../../csharp/programming-guide/concepts/linq/index.md).</span></span>
  
 <span data-ttu-id="c035a-123">以下各节提供了有关 LINQ to DataSet、[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]和 LINQ to Entities 的详细信息。</span><span class="sxs-lookup"><span data-stu-id="c035a-123">The following sections provide more information about LINQ to DataSet, [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], and LINQ to Entities.</span></span>  
  
## <a name="linq-to-dataset"></a><span data-ttu-id="c035a-124">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="c035a-124">LINQ to DataSet</span></span>  
 <span data-ttu-id="c035a-125"><xref:System.Data.DataSet> 是 ADO.NET 在其上构建的断开连接的编程模型的关键元素，广泛使用。</span><span class="sxs-lookup"><span data-stu-id="c035a-125">The <xref:System.Data.DataSet> is a key element of the disconnected programming model that ADO.NET is built on, and is widely used.</span></span> <span data-ttu-id="c035a-126">LINQ to DataSet 使开发人员可以使用可用于许多其他数据源的相同查询表述机制，将更丰富的查询功能构建到 <xref:System.Data.DataSet> 中。</span><span class="sxs-lookup"><span data-stu-id="c035a-126">LINQ to DataSet enables developers to build richer query capabilities into <xref:System.Data.DataSet> by using the same query formulation mechanism that is available for many other data sources.</span></span> <span data-ttu-id="c035a-127">有关详细信息，请参阅 [LINQ to DataSet](linq-to-dataset.md)。</span><span class="sxs-lookup"><span data-stu-id="c035a-127">For more information, see [LINQ to DataSet](linq-to-dataset.md).</span></span>  
  
## <a name="linq-to-sql"></a><span data-ttu-id="c035a-128">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="c035a-128">LINQ to SQL</span></span>  
 [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="c035a-129">是适合不需要映射到概念模型的开发人员使用的有用工具。</span><span class="sxs-lookup"><span data-stu-id="c035a-129">is a useful tool for developers who do not require mapping to a conceptual model.</span></span> <span data-ttu-id="c035a-130">通过使用 [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]，可以直接在现有数据库架构上使用 LINQ 编程模型。</span><span class="sxs-lookup"><span data-stu-id="c035a-130">By using [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], you can use the LINQ programming model directly over existing database schema.</span></span> [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="c035a-131">使开发人员能够生成表示数据 .NET Framework 类。</span><span class="sxs-lookup"><span data-stu-id="c035a-131">enables developers to generate .NET Framework classes that represent data.</span></span> <span data-ttu-id="c035a-132">这些生成的类直接映射到数据库表、视图、存储过程和用户定义的函数，而不映射到概念数据模型。</span><span class="sxs-lookup"><span data-stu-id="c035a-132">Rather than mapping to a conceptual data model, these generated classes map directly to database tables, views, stored procedures, and user-defined functions.</span></span>  
  
 <span data-ttu-id="c035a-133">在 [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]中，开发人员可以使用与内存中集合和 <xref:System.Data.DataSet>相同的 LINQ 编程模式，以及 XML 等其他数据源，直接针对存储架构编写代码。</span><span class="sxs-lookup"><span data-stu-id="c035a-133">With [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], developers can write code directly against the storage schema using the same LINQ programming pattern as in-memory collections and the <xref:System.Data.DataSet>, in addition to other data sources such as XML.</span></span> <span data-ttu-id="c035a-134">有关详细信息，请参阅 [LINQ to SQL](./sql/linq/index.md)。</span><span class="sxs-lookup"><span data-stu-id="c035a-134">For more information, see [LINQ to SQL](./sql/linq/index.md).</span></span>  
  
## <a name="linq-to-entities"></a><span data-ttu-id="c035a-135">LINQ to Entities</span><span class="sxs-lookup"><span data-stu-id="c035a-135">LINQ to Entities</span></span>  
 <span data-ttu-id="c035a-136">大多数应用程序目前是在关系数据库之上编写的。</span><span class="sxs-lookup"><span data-stu-id="c035a-136">Most applications are currently written on top of relational databases.</span></span> <span data-ttu-id="c035a-137">有时这些应用程序将需要与以关系形式表示的数据进行交互。</span><span class="sxs-lookup"><span data-stu-id="c035a-137">At some point, these applications will need to interact with the data represented in a relational form.</span></span> <span data-ttu-id="c035a-138">数据库架构并不总是构建应用程序的理想选择，并且应用程序的概念模型与数据库的逻辑模型不同。</span><span class="sxs-lookup"><span data-stu-id="c035a-138">Database schemas are not always ideal for building applications, and the conceptual models of application are not the same as the logical models of databases.</span></span> <span data-ttu-id="c035a-139">实体数据模型是一种概念数据模型，可用于对特定域的数据进行建模，使应用程序能够以对象的形式与数据进行交互。</span><span class="sxs-lookup"><span data-stu-id="c035a-139">The Entity Data Model is a conceptual data model that can be used to model the data of a particular domain so that applications can interact with data as objects.</span></span> <span data-ttu-id="c035a-140">有关详细信息，请参阅[ADO.NET 实体框架](./ef/index.md)。</span><span class="sxs-lookup"><span data-stu-id="c035a-140">For more information, see [ADO.NET Entity Framework](./ef/index.md).</span></span>  
  
 <span data-ttu-id="c035a-141">通过实体数据模型，在 .NET 环境中将关系数据作为对象公开。</span><span class="sxs-lookup"><span data-stu-id="c035a-141">Through the Entity Data Model, relational data is exposed as objects in the .NET environment.</span></span> <span data-ttu-id="c035a-142">这使得对象层成为实现 LINQ 支持的理想目标，开发人员可以采用生成业务逻辑所用的语言来构建数据库查询。</span><span class="sxs-lookup"><span data-stu-id="c035a-142">This makes the object layer an ideal target for LINQ support, allowing developers to formulate queries against the database from the language used to build the business logic.</span></span> <span data-ttu-id="c035a-143">此功能称为 LINQ to Entities。</span><span class="sxs-lookup"><span data-stu-id="c035a-143">This capability is known as LINQ to Entities.</span></span> <span data-ttu-id="c035a-144">有关详细信息，请参阅[LINQ to Entities](./ef/language-reference/linq-to-entities.md)。</span><span class="sxs-lookup"><span data-stu-id="c035a-144">For more information, see [LINQ to Entities](./ef/language-reference/linq-to-entities.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c035a-145">另请参阅</span><span class="sxs-lookup"><span data-stu-id="c035a-145">See also</span></span>

- [<span data-ttu-id="c035a-146">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="c035a-146">LINQ to DataSet</span></span>](linq-to-dataset.md)
- [<span data-ttu-id="c035a-147">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="c035a-147">LINQ to SQL</span></span>](./sql/linq/index.md)
- [<span data-ttu-id="c035a-148">LINQ to Entities</span><span class="sxs-lookup"><span data-stu-id="c035a-148">LINQ to Entities</span></span>](./ef/language-reference/linq-to-entities.md)
- [<span data-ttu-id="c035a-149">语言集成查询 (LINQ)</span><span class="sxs-lookup"><span data-stu-id="c035a-149">Language Integrated Query (LINQ)</span></span>](../../../csharp/programming-guide/concepts/linq/index.md)
- [<span data-ttu-id="c035a-150">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="c035a-150">ADO.NET Overview</span></span>](ado-net-overview.md)
