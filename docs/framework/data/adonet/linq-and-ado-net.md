---
title: LINQ 和 ADO.NET
ms.date: 03/30/2017
ms.assetid: bf0c8f93-3ff7-49f3-8aed-f2b7ac938dec
ms.openlocfilehash: 9c517b3efca8cd2b41782858ef1e18e3cba76c1b
ms.sourcegitcommit: b5c59eaaf8bf48ef3ec259f228cb328d6d4c0ceb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/03/2019
ms.locfileid: "67539412"
---
# <a name="linq-and-adonet"></a><span data-ttu-id="8b4e3-102">LINQ 和 ADO.NET</span><span class="sxs-lookup"><span data-stu-id="8b4e3-102">LINQ and ADO.NET</span></span>
<span data-ttu-id="8b4e3-103">如今，许多业务开发人员必须使用两个 （或多个） 的编程语言： 对于业务逻辑和表示层的高级语言 (如视觉对象C#或 Visual Basic)，而使用查询语言与数据库 （如 Transact SQL) 进行交互.</span><span class="sxs-lookup"><span data-stu-id="8b4e3-103">Today, many business developers must use two (or more) programming languages: a high-level language for the business logic and presentation layers (such as Visual C# or Visual Basic), and a query language to interact with the database (such as Transact-SQL).</span></span> <span data-ttu-id="8b4e3-104">这要求开发人员精通多种语言才能奏效，同时也导致在开发环境中语言不匹配。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-104">This requires the developer to be proficient in several languages to be effective, and also causes language mismatches in the development environment.</span></span> <span data-ttu-id="8b4e3-105">例如，使用数据访问 API 对数据库执行查询的应用程序会将查询指定为用引号括起的字符串。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-105">For example, an application that uses a data access API to execute a query against a database specifies the query as a string literal by using quotation marks.</span></span> <span data-ttu-id="8b4e3-106">编译器不能读取此查询字符串，因此不会检查是否有错误，如语法无效或引用的列或行是否实际存在。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-106">This query string is un-readable to the compiler and is not checked for errors, such as invalid syntax or whether the columns or rows it references actually exist.</span></span> <span data-ttu-id="8b4e3-107">不会检查查询参数的类型，也不支持 `IntelliSense`。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-107">There is no type checking of the query parameters and no `IntelliSense` support, either.</span></span>  
  
 [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] <span data-ttu-id="8b4e3-108">使开发人员能够在应用程序代码中形成基于集合的查询，而不必使用单独的查询语言。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-108">enables developers to form set-based queries in their application code, without having to use a separate query language.</span></span> <span data-ttu-id="8b4e3-109">您可以编写针对各种可枚举数据源（即实现 [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] 接口的数据源）的 <xref:System.Collections.IEnumerable> 查询，可枚举数据源包括驻留在内存中的数据结构、XML 文档、SQL 数据库和 <xref:System.Data.DataSet> 对象等。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-109">You can write [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] queries against various enumerable data sources (that is, a data source that implements the <xref:System.Collections.IEnumerable> interface), such as in-memory data structures, XML documents, SQL databases, and <xref:System.Data.DataSet> objects.</span></span> <span data-ttu-id="8b4e3-110">虽然这些可枚举数据源以多种方式实现，但它们都公开相同的语法和语言构造。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-110">Although these enumerable data sources are implemented in various ways, they all expose the same syntax and language constructs.</span></span> <span data-ttu-id="8b4e3-111">由于可以使用编程语言本身形成查询，因此您不必使用编译器无法理解或验证的以字符串形式嵌入的其他查询语言。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-111">Because queries can be formed in the programming language itself, you do not have to use another query language that is embedded as string literals that cannot be understood or verified by the compiler.</span></span> <span data-ttu-id="8b4e3-112">将查询集成到编程语言也使 Visual Studio 编程人员能够通过提供编译时类型和语法检查，提高工作效率和`IntelliSense`。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-112">Integrating queries into the programming language also enables Visual Studio programmers to be more productive by providing compile-time type and syntax checking, and `IntelliSense`.</span></span> <span data-ttu-id="8b4e3-113">这些功能降低了对查询调试和错误修复的需求。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-113">These features reduce the need for query debugging and error fixing.</span></span>  
  
 <span data-ttu-id="8b4e3-114">将数据从 SQL 表传输到内存中的对象通常单调乏味并容易出错。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-114">Transferring data from SQL tables into objects in memory is often tedious and error-prone.</span></span> <span data-ttu-id="8b4e3-115">[!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)]提供程序实现的 LINQ to DataSet 和[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]将转换源数据插入<xref:System.Collections.IEnumerable>-基于对象的集合。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-115">The [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] provider implemented by LINQ to DataSet and [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] converts the source data into <xref:System.Collections.IEnumerable>-based object collections.</span></span> <span data-ttu-id="8b4e3-116">在您查询数据和更新数据时，程序员始终会以 <xref:System.Collections.IEnumerable> 集合的形式查看这些数据。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-116">The programmer always views the data as an <xref:System.Collections.IEnumerable> collection, both when you query and when you update.</span></span> <span data-ttu-id="8b4e3-117">为编写针对这些集合的查询提供完全的 `IntelliSense` 支持。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-117">Full `IntelliSense` support is provided for writing queries against those collections.</span></span>  
  
 <span data-ttu-id="8b4e3-118">有三种独立的 ADO.NET [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] 技术：LINQ to DataSet， [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]，和 LINQ to Entities。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-118">There are three separate ADO.NET [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] technologies: LINQ to DataSet, [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], and LINQ to Entities.</span></span> <span data-ttu-id="8b4e3-119">LINQ to DataSet 提供更丰富且经过优化的查询<xref:System.Data.DataSet>和[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]使你可直接查询 SQL Server 数据库架构和 LINQ to Entities 可查询实体数据模型。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-119">LINQ to DataSet provides richer, optimized querying over the <xref:System.Data.DataSet> and [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] enables you to directly query SQL Server database schemas, and LINQ to Entities allows you to query an Entity Data Model.</span></span>  
  
 <span data-ttu-id="8b4e3-120">下面的关系图概述了 ADO.NET LINQ 技术如何关联到高级编程语言和启用 LINQ 的数据源。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-120">The following diagram provides an overview of how the ADO.NET LINQ technologies relate to high-level programming languages and LINQ-enabled data sources.</span></span>  
  
 <span data-ttu-id="8b4e3-121">![LINQ to ADO.NET 概述](../../../../docs/framework/data/adonet/media/dpue-linqtoadonetoverview-bpuedev11.gif "DPUE_LinqToAdoNetOverview_bpuedev11")</span><span class="sxs-lookup"><span data-stu-id="8b4e3-121">![LINQ to ADO.NET overview](../../../../docs/framework/data/adonet/media/dpue-linqtoadonetoverview-bpuedev11.gif "DPUE_LinqToAdoNetOverview_bpuedev11")</span></span>  
  
 <span data-ttu-id="8b4e3-122">有关 LINQ 的详细信息，请参阅[语言集成查询 (LINQ)](../../../csharp/programming-guide/concepts/linq/index.md)。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-122">For more information about LINQ, see [Language Integrated Query (LINQ)](../../../csharp/programming-guide/concepts/linq/index.md).</span></span>
  
 <span data-ttu-id="8b4e3-123">以下各节提供有关 LINQ 的详细信息到数据集， [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]，和 LINQ to Entities。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-123">The following sections provide more information about LINQ to DataSet, [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], and LINQ to Entities.</span></span>  
  
## <a name="linq-to-dataset"></a><span data-ttu-id="8b4e3-124">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="8b4e3-124">LINQ to DataSet</span></span>  
 <span data-ttu-id="8b4e3-125"><xref:System.Data.DataSet>是断开连接的编程模型，ADO.NET 上，构建，并广泛使用的关键元素。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-125">The <xref:System.Data.DataSet> is a key element of the disconnected programming model that ADO.NET is built on, and is widely used.</span></span> <span data-ttu-id="8b4e3-126">LINQ 到数据集开发人员可以构建更丰富的查询功能<xref:System.Data.DataSet>使用相同的查询表述机制可用于许多其他数据源。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-126">LINQ to DataSet enables developers to build richer query capabilities into <xref:System.Data.DataSet> by using the same query formulation mechanism that is available for many other data sources.</span></span> <span data-ttu-id="8b4e3-127">有关详细信息，请参阅 [LINQ to DataSet](../../../../docs/framework/data/adonet/linq-to-dataset.md)。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-127">For more information, see [LINQ to DataSet](../../../../docs/framework/data/adonet/linq-to-dataset.md).</span></span>  
  
## <a name="linq-to-sql"></a><span data-ttu-id="8b4e3-128">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="8b4e3-128">LINQ to SQL</span></span>  
 [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="8b4e3-129">是适合不需要映射到概念模型的开发人员使用的有用工具。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-129">is a useful tool for developers who do not require mapping to a conceptual model.</span></span> <span data-ttu-id="8b4e3-130">通过使用 [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]，您可以直接在现有数据库架构上直接使用 [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] 编程模型。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-130">By using [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], you can use the [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] programming model directly over existing database schema.</span></span> [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="8b4e3-131">使开发人员能够生成表示数据的.NET Framework 类。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-131">enables developers to generate .NET Framework classes that represent data.</span></span> <span data-ttu-id="8b4e3-132">这些生成的类直接映射到数据库表、视图、存储过程和用户定义的函数，而不映射到概念数据模型。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-132">Rather than mapping to a conceptual data model, these generated classes map directly to database tables, views, stored procedures, and user-defined functions.</span></span>  
  
 <span data-ttu-id="8b4e3-133">使用 [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] 时，除了其他数据源（如 XML）外，开发人员还可以使用与内存集合和 [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] 相同的 <xref:System.Data.DataSet> 编程模式直接编写针对存储架构的代码。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-133">With [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], developers can write code directly against the storage schema using the same [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] programming pattern as in-memory collections and the <xref:System.Data.DataSet>, in addition to other data sources such as XML.</span></span> <span data-ttu-id="8b4e3-134">有关详细信息，请参阅 [LINQ to SQL](../../../../docs/framework/data/adonet/sql/linq/index.md)。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-134">For more information, see [LINQ to SQL](../../../../docs/framework/data/adonet/sql/linq/index.md).</span></span>  
  
## <a name="linq-to-entities"></a><span data-ttu-id="8b4e3-135">LINQ to Entities</span><span class="sxs-lookup"><span data-stu-id="8b4e3-135">LINQ to Entities</span></span>  
 <span data-ttu-id="8b4e3-136">大多数应用程序目前是在关系数据库之上编写的。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-136">Most applications are currently written on top of relational databases.</span></span> <span data-ttu-id="8b4e3-137">有时这些应用程序将需要与以关系形式表示的数据进行交互。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-137">At some point, these applications will need to interact with the data represented in a relational form.</span></span> <span data-ttu-id="8b4e3-138">数据库架构并不总是构建应用程序的理想选择，并且应用程序的概念模型与数据库的逻辑模型不同。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-138">Database schemas are not always ideal for building applications, and the conceptual models of application are not the same as the logical models of databases.</span></span> <span data-ttu-id="8b4e3-139">实体数据模型是可用于模型的特定域的数据以使应用程序可以与数据作为对象进行交互的概念数据模型。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-139">The Entity Data Model is a conceptual data model that can be used to model the data of a particular domain so that applications can interact with data as objects.</span></span> <span data-ttu-id="8b4e3-140">请参阅[ADO.NET 实体框架](../../../../docs/framework/data/adonet/ef/index.md)有关详细信息。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-140">See [ADO.NET Entity Framework](../../../../docs/framework/data/adonet/ef/index.md) for more information.</span></span>  
  
 <span data-ttu-id="8b4e3-141">通过实体数据模型，在 .NET 环境中将关系数据作为对象公开。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-141">Through the Entity Data Model, relational data is exposed as objects in the .NET environment.</span></span> <span data-ttu-id="8b4e3-142">这使得对象层成为实现 [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] 支持的理想目标，开发人员可以采用生成业务逻辑所用的语言来构建数据库查询。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-142">This makes the object layer an ideal target for [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] support, allowing developers to formulate queries against the database from the language used to build the business logic.</span></span> <span data-ttu-id="8b4e3-143">此功能称为 LINQ 到实体。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-143">This capability is known as LINQ to Entities.</span></span> <span data-ttu-id="8b4e3-144">有关详细信息，请参阅 [LINQ to Entities](../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md)。</span><span class="sxs-lookup"><span data-stu-id="8b4e3-144">See [LINQ to Entities](../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md) for more information.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8b4e3-145">请参阅</span><span class="sxs-lookup"><span data-stu-id="8b4e3-145">See also</span></span>

- [<span data-ttu-id="8b4e3-146">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="8b4e3-146">LINQ to DataSet</span></span>](../../../../docs/framework/data/adonet/linq-to-dataset.md)
- [<span data-ttu-id="8b4e3-147">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="8b4e3-147">LINQ to SQL</span></span>](../../../../docs/framework/data/adonet/sql/linq/index.md)
- [<span data-ttu-id="8b4e3-148">LINQ to Entities</span><span class="sxs-lookup"><span data-stu-id="8b4e3-148">LINQ to Entities</span></span>](../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md)
- [<span data-ttu-id="8b4e3-149">语言集成查询 (LINQ)</span><span class="sxs-lookup"><span data-stu-id="8b4e3-149">Language Integrated Query (LINQ)</span></span>](../../../csharp/programming-guide/concepts/linq/index.md)
- [<span data-ttu-id="8b4e3-150">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="8b4e3-150">ADO.NET Overview</span></span>](ado-net-overview.md)
