---
title: Transaction Fundamentals
ms.date: 03/30/2017
ms.assetid: 353f4ee2-e6bf-4b1c-b1c8-385fc8a486c0
ms.openlocfilehash: ed5865121a32f05f9b58c0ca0fca475fe7b98723
ms.sourcegitcommit: 30a558d23e3ac5a52071121a52c305c85fe15726
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/25/2019
ms.locfileid: "75346205"
---
# <a name="transaction-fundamentals"></a><span data-ttu-id="5fa57-102">Transaction Fundamentals</span><span class="sxs-lookup"><span data-stu-id="5fa57-102">Transaction Fundamentals</span></span>
<span data-ttu-id="5fa57-103">事务将多个任务绑定在一起。</span><span class="sxs-lookup"><span data-stu-id="5fa57-103">Transactions bind multiple tasks together.</span></span> <span data-ttu-id="5fa57-104">例如，假设应用程序执行两个任务。</span><span class="sxs-lookup"><span data-stu-id="5fa57-104">For example, imagine that an application performs two tasks.</span></span> <span data-ttu-id="5fa57-105">首先，它在数据库中创建一个新表。</span><span class="sxs-lookup"><span data-stu-id="5fa57-105">First, it creates a new table in a database.</span></span> <span data-ttu-id="5fa57-106">然后，它调用一个专用对象，来收集数据、设置数据格式以及将数据插入新表中。</span><span class="sxs-lookup"><span data-stu-id="5fa57-106">Next, it calls a specialized object to collect, format, and insert data into the new table.</span></span> <span data-ttu-id="5fa57-107">这两个任务是相关的，甚至是相互依赖的，以便只有在可以用数据填充表时才创建新表。</span><span class="sxs-lookup"><span data-stu-id="5fa57-107">These two tasks are related and even interdependent, such that you want to avoid creating a new table unless you can fill it with data.</span></span> <span data-ttu-id="5fa57-108">在单个事务范围内执行这两个任务时，会在它们之间强制建立连接。</span><span class="sxs-lookup"><span data-stu-id="5fa57-108">Executing both tasks within the scope of a single transaction enforces the connection between them.</span></span> <span data-ttu-id="5fa57-109">如果第二个任务失败，则第一个任务会回滚到创建新表之前的点。</span><span class="sxs-lookup"><span data-stu-id="5fa57-109">If the second task fails, the first task is rolled back to a point before the new table was created.</span></span>  
  
 <span data-ttu-id="5fa57-110">若要确保发生可预测的行为，所有事务都必须具有基本的 ACID 属性（原子性、一致性、隔离性和持久性）。</span><span class="sxs-lookup"><span data-stu-id="5fa57-110">To ensure predictable behavior, all transactions must possess the basic ACID properties (atomic, consistent, isolated, and durable).</span></span> <span data-ttu-id="5fa57-111">这些属性可以确保关键任务事务能够做出全是或全非的主张。</span><span class="sxs-lookup"><span data-stu-id="5fa57-111">These properties reinforce the role of mission-critical transactions as all-or-none propositions.</span></span> <span data-ttu-id="5fa57-112">有关 ACID 的详细信息，请参阅[Acid 属性](/windows/win32/cossdk/acid-properties)。</span><span class="sxs-lookup"><span data-stu-id="5fa57-112">For more information on ACID, please see [ACID Properties](/windows/win32/cossdk/acid-properties).</span></span> <span data-ttu-id="5fa57-113">总之，ACID 可保证一组相关任务作为一个整体成功或失败。</span><span class="sxs-lookup"><span data-stu-id="5fa57-113">In summary, ACID guarantees that a set of related tasks either succeed or fail as a unit.</span></span> <span data-ttu-id="5fa57-114">用事务处理术语来说，就是事务不是提交就是中止。</span><span class="sxs-lookup"><span data-stu-id="5fa57-114">In transaction processing terminology, the transaction either commits or aborts.</span></span> <span data-ttu-id="5fa57-115">对于要提交的事务，所有参与者都必须保证对数据的任何更改都是永久的。</span><span class="sxs-lookup"><span data-stu-id="5fa57-115">For a transaction to commit, all participants must guarantee that any change to data will be permanent.</span></span> <span data-ttu-id="5fa57-116">即使发生系统崩溃或其他不可预见的事件，更改也必须是永久的。</span><span class="sxs-lookup"><span data-stu-id="5fa57-116">Changes must persist despite system crashes or other unforeseen events.</span></span> <span data-ttu-id="5fa57-117">只要一个参与者无法做出这项保证，整个事务就会失败，</span><span class="sxs-lookup"><span data-stu-id="5fa57-117">If even a single participant fails to make this guarantee, the entire transaction fails.</span></span> <span data-ttu-id="5fa57-118">并且对事务范围内的数据的所有更改都会回滚到特定的设定点。</span><span class="sxs-lookup"><span data-stu-id="5fa57-118">All changes to data within the scope of the transaction are rolled back to a specific set point.</span></span>  
  
 <span data-ttu-id="5fa57-119">事务操作可限定于单个数据资源，如数据库或消息队列。</span><span class="sxs-lookup"><span data-stu-id="5fa57-119">A transaction can be confined to a single data resource, such as a database or message queue.</span></span> <span data-ttu-id="5fa57-120">在这种情况下，本地事务由 <xref:System.Transactions> 所提供的可提升性能的事务管理器管理。</span><span class="sxs-lookup"><span data-stu-id="5fa57-120">In this scenario, the local transaction is managed by the Transaction Manager provided by <xref:System.Transactions> , which generates performance gain.</span></span> <span data-ttu-id="5fa57-121">当这些事务由数据资源控制时，它们具有高效性并易于管理。</span><span class="sxs-lookup"><span data-stu-id="5fa57-121">Controlled by the data resource, these transactions are efficient and easy to manage.</span></span>  
  
 <span data-ttu-id="5fa57-122">事务也可跨多个数据资源。</span><span class="sxs-lookup"><span data-stu-id="5fa57-122">Transactions can also span multiple data resources.</span></span> <span data-ttu-id="5fa57-123">使用分布式事务可以将在不同系统上执行的多种不同的操作合并到一个通过或失败的操作中。</span><span class="sxs-lookup"><span data-stu-id="5fa57-123">Distributed transactions give you the ability to incorporate several distinct operations occurring on different systems into a single pass or fail action.</span></span> <span data-ttu-id="5fa57-124">在这种情况下，事务由位于每个系统中的 Microsoft 分布式事务协调器 (MSDTC) 进行协调。</span><span class="sxs-lookup"><span data-stu-id="5fa57-124">In this scenario, the transactions are coordinated by the Microsoft Distributed Transaction Coordinator (MSDTC) that resides in each system.</span></span>  
  
 <span data-ttu-id="5fa57-125">在使用 <xref:System.Transactions> 所提供的类开发事务应用程序时，不必考虑需要使用哪种事务，也不必考虑所涉及的事务管理器。</span><span class="sxs-lookup"><span data-stu-id="5fa57-125">When you develop a transactional application using the classes provided by <xref:System.Transactions>, you do not need to worry about what kind of transactions you need, or the transaction manager involved.</span></span> <span data-ttu-id="5fa57-126"><xref:System.Transactions> 基础结构会为您自动管理这些事宜。</span><span class="sxs-lookup"><span data-stu-id="5fa57-126">The <xref:System.Transactions> infrastructure automatically manages these for you.</span></span>  
  
 <span data-ttu-id="5fa57-127">在创建事务时，可以指定应用于该事务的隔离级别。</span><span class="sxs-lookup"><span data-stu-id="5fa57-127">When you create a transaction, you can specify the isolation level that applies to the transaction.</span></span> <span data-ttu-id="5fa57-128"><xref:System.Transactions.IsolationLevel> 枚举定义的隔离级别确定了其他事务对受事务影响的数据的访问级别。</span><span class="sxs-lookup"><span data-stu-id="5fa57-128">The isolation level, defined by the <xref:System.Transactions.IsolationLevel> enum, determines what level of access other transactions will have to the data affected by your transaction.</span></span>  
  
 <span data-ttu-id="5fa57-129">您可以使用 ADO.NET、<xref:System.EnterpriseServices>或 <xref:System.Transactions> 命名空间提供的事务性编程模型来创建事务。</span><span class="sxs-lookup"><span data-stu-id="5fa57-129">You can create transactions using ADO.NET, <xref:System.EnterpriseServices>, or the transactional programming model provided by the <xref:System.Transactions> namespace.</span></span> <span data-ttu-id="5fa57-130">[System.object 提供的功能](features-provided-by-system-transactions.md)主题讨论了可用于使用 <xref:System.Transactions> 命名空间编写事务应用程序的功能。</span><span class="sxs-lookup"><span data-stu-id="5fa57-130">The [Features Provided by System.Transactions](features-provided-by-system-transactions.md) topic discusses the features that you can use to write a transactional application using the <xref:System.Transactions> namespace.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5fa57-131">另请参阅</span><span class="sxs-lookup"><span data-stu-id="5fa57-131">See also</span></span>

- [<span data-ttu-id="5fa57-132">由 System.Transactions 提供的功能</span><span class="sxs-lookup"><span data-stu-id="5fa57-132">Features Provided by System.Transactions</span></span>](features-provided-by-system-transactions.md)
