---
title: 如何：将使用项目数据源 （WCF 数据服务） 的数据绑定
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- data binding, WCF Data Services
- WCF Data Services, data binding
ms.assetid: 2477af0a-676f-44f7-b73d-e66208785509
ms.openlocfilehash: 69a0ec657f0a8cec34048776a4767cec23d091d9
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2019
ms.locfileid: "64645640"
---
# <a name="how-to-bind-data-using-a-project-data-source-wcf-data-services"></a><span data-ttu-id="e934b-102">如何：将使用项目数据源 （WCF 数据服务） 的数据绑定</span><span class="sxs-lookup"><span data-stu-id="e934b-102">How to: Bind Data Using a Project Data Source (WCF Data Services)</span></span>

<span data-ttu-id="e934b-103">可以创建基于 WCF 数据服务客户端应用程序中生成的数据对象的数据源。</span><span class="sxs-lookup"><span data-stu-id="e934b-103">You can create data sources that are based on the generated data objects in an WCF Data Services client application.</span></span> <span data-ttu-id="e934b-104">当使用添加到数据服务的引用**添加服务引用**对话框中，以及生成的客户端数据类创建项目数据源。</span><span class="sxs-lookup"><span data-stu-id="e934b-104">When you add a reference to a data service by using the **Add Service Reference** dialog, a project data source is created along with the generated client data classes.</span></span> <span data-ttu-id="e934b-105">将为数据服务公开的每个实体集各创建一个数据源。</span><span class="sxs-lookup"><span data-stu-id="e934b-105">One data source is created for each entity set that the data service exposes.</span></span> <span data-ttu-id="e934b-106">可以创建显示通过将这些数据源项从服务中的数据的窗体**数据源**窗口拖到设计器。</span><span class="sxs-lookup"><span data-stu-id="e934b-106">You can create forms that display data from the service by dragging these data source items from the **Data Sources** window onto the designer.</span></span> <span data-ttu-id="e934b-107">这些项将成为绑定到该数据源的控件。</span><span class="sxs-lookup"><span data-stu-id="e934b-107">These items become controls that are bound to the data source.</span></span> <span data-ttu-id="e934b-108">在执行期间，此数据源绑定到的实例<xref:System.Data.Services.Client.DataServiceCollection%601>类，该类填充有数据服务返回的查询的对象。</span><span class="sxs-lookup"><span data-stu-id="e934b-108">During execution, this data source is bound to an instance of the <xref:System.Data.Services.Client.DataServiceCollection%601> class, which is filled with objects that are returned by a query to the data service.</span></span> <span data-ttu-id="e934b-109">有关详细信息，请参阅[数据绑定到控件](../../../../docs/framework/data/wcf/binding-data-to-controls-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="e934b-109">For more information, see [Binding Data to Controls](../../../../docs/framework/data/wcf/binding-data-to-controls-wcf-data-services.md).</span></span>

 <span data-ttu-id="e934b-110">本主题中的示例使用 Northwind 示例数据服务和自动生成的客户端数据服务类。</span><span class="sxs-lookup"><span data-stu-id="e934b-110">The examples in this topic use the Northwind sample data service and autogenerated client data service classes.</span></span> <span data-ttu-id="e934b-111">完成后，将创建此服务和客户端数据类[WCF Data Services 快速入门](../../../../docs/framework/data/wcf/quickstart-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="e934b-111">This service and the client data classes are created when you complete the [WCF Data Services quickstart](../../../../docs/framework/data/wcf/quickstart-wcf-data-services.md).</span></span>

## <a name="use-a-project-data-source-in-a-wpf-window"></a><span data-ttu-id="e934b-112">在 WPF 窗口中使用项目数据源</span><span class="sxs-lookup"><span data-stu-id="e934b-112">Use a project data source in a WPF window</span></span>

1. <span data-ttu-id="e934b-113">在 Visual Studio 中，在 WPF 项目中，添加对 Northwind 数据服务的引用。</span><span class="sxs-lookup"><span data-stu-id="e934b-113">In Visual Studio, in a WPF project, add a reference to the Northwind data service.</span></span> <span data-ttu-id="e934b-114">有关详细信息，请参阅[如何：添加数据服务引用](../../../../docs/framework/data/wcf/how-to-add-a-data-service-reference-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="e934b-114">For more information, see [How to: Add a Data Service Reference](../../../../docs/framework/data/wcf/how-to-add-a-data-service-reference-wcf-data-services.md).</span></span>

2. <span data-ttu-id="e934b-115">在中**数据源**窗口中，展开`Customers`中的节点**NorthwindEntities**项目数据源。</span><span class="sxs-lookup"><span data-stu-id="e934b-115">In the **Data Sources** window, expand the `Customers` node in the **NorthwindEntities** project data source.</span></span>

3. <span data-ttu-id="e934b-116">单击**CustomerID**项目中，选择**组合框**从列表中，并拖动**CustomerID**项从**客户**到节点设计器。</span><span class="sxs-lookup"><span data-stu-id="e934b-116">Click the **CustomerID** item, select **ComboBox** from the list, and drag the **CustomerID** item from the **Customers** node to the designer.</span></span>

     <span data-ttu-id="e934b-117">这会在 XAML 文件中为此窗口创建以下对象元素：</span><span class="sxs-lookup"><span data-stu-id="e934b-117">This creates the following object elements in the XAML file for the window:</span></span>

    - <span data-ttu-id="e934b-118">一个名为 <xref:System.Windows.Data.CollectionViewSource> 的 `customersViewSource` 元素。</span><span class="sxs-lookup"><span data-stu-id="e934b-118">A <xref:System.Windows.Data.CollectionViewSource> element named `customersViewSource`.</span></span> <span data-ttu-id="e934b-119">将顶级 <xref:System.Windows.FrameworkElement.DataContext%2A> 对象元素的 <xref:System.Windows.Controls.Grid> 属性设置为此新的 <xref:System.Windows.Data.CollectionViewSource>。</span><span class="sxs-lookup"><span data-stu-id="e934b-119">The <xref:System.Windows.FrameworkElement.DataContext%2A> property of the top-level <xref:System.Windows.Controls.Grid> object element is set to this new <xref:System.Windows.Data.CollectionViewSource>.</span></span>

    - <span data-ttu-id="e934b-120">一个名为 <xref:System.Windows.Controls.ComboBox> 的数据绑定 `CustomerID`。</span><span class="sxs-lookup"><span data-stu-id="e934b-120">A data-bound <xref:System.Windows.Controls.ComboBox> named `CustomerID`.</span></span>

    - <span data-ttu-id="e934b-121"><xref:System.Windows.Controls.Label>。</span><span class="sxs-lookup"><span data-stu-id="e934b-121">A <xref:System.Windows.Controls.Label>.</span></span>

4. <span data-ttu-id="e934b-122">拖动**订单**到设计器的导航属性。</span><span class="sxs-lookup"><span data-stu-id="e934b-122">Drag the **Orders** navigation property to the designer.</span></span>

     <span data-ttu-id="e934b-123">这会在 XAML 文件中为此窗口创建以下附加对象元素：</span><span class="sxs-lookup"><span data-stu-id="e934b-123">This creates the following additional object elements in the XAML file for the window:</span></span>

    - <span data-ttu-id="e934b-124">另一个名为 <xref:System.Windows.Data.CollectionViewSource> 的 `customersOrdersViewSource` 元素，其源为 `customerViewSource`。</span><span class="sxs-lookup"><span data-stu-id="e934b-124">A second <xref:System.Windows.Data.CollectionViewSource> element named `customersOrdersViewSource`, the source of which is the `customerViewSource`.</span></span>

    - <span data-ttu-id="e934b-125">一个名为 <xref:System.Windows.Controls.DataGrid> 的数据绑定 `ordersDataGrid` 控件。</span><span class="sxs-lookup"><span data-stu-id="e934b-125">A data-bound <xref:System.Windows.Controls.DataGrid> control named `ordersDataGrid`.</span></span>

5. <span data-ttu-id="e934b-126">（可选）将其他项从**客户**到设计器节点。</span><span class="sxs-lookup"><span data-stu-id="e934b-126">(Optional) Drag additional items from the **Customers** node to the designer.</span></span>

6. <span data-ttu-id="e934b-127">打开窗体的代码页，并添加以下 `using` 语句（在 Visual Basic 中为 `Imports`）：</span><span class="sxs-lookup"><span data-stu-id="e934b-127">Open the code page for the form and add the following `using` statements (`Imports` in Visual Basic):</span></span>

     [!code-csharp[Astoria Northwind Client#CustomersOrdersUsingWpf](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/customerorderswpf2.xaml.cs#customersordersusingwpf)]

7. <span data-ttu-id="e934b-128">在定义窗体的分部类中，添加创建 <xref:System.Data.Objects.ObjectContext> 实例并定义 `customerID` 常量的以下代码。</span><span class="sxs-lookup"><span data-stu-id="e934b-128">In the partial class that defines the form, add the following code that creates an <xref:System.Data.Objects.ObjectContext> instance and defines the `customerID` constant.</span></span>

     [!code-csharp[Astoria Northwind Client#CustomersOrdersDefinitionWpf](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/customerorderswpf2.xaml.cs#customersordersdefinitionwpf)]
     [!code-vb[Astoria Northwind Client#CustomersOrdersDefinitionWpf](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorderswpf2.xaml.vb#customersordersdefinitionwpf)]

8. <span data-ttu-id="e934b-129">在设计器中，选择该窗口。</span><span class="sxs-lookup"><span data-stu-id="e934b-129">In the designer, select the window.</span></span>

    > [!NOTE]
    > <span data-ttu-id="e934b-130">确保您选择的是该窗口自身，而不是该窗口中的选定内容。</span><span class="sxs-lookup"><span data-stu-id="e934b-130">Make sure that you select the window itself, rather than selecting content that is within the window.</span></span> <span data-ttu-id="e934b-131">所选的窗口，如果**名称**顶部附近的文本框中**属性**窗口应包含窗口的名称。</span><span class="sxs-lookup"><span data-stu-id="e934b-131">If the window is selected, the **Name** text box near the top of the **Properties** window should contain the name of the window.</span></span>

9. <span data-ttu-id="e934b-132">在中**属性**窗口中，选择**事件**按钮。</span><span class="sxs-lookup"><span data-stu-id="e934b-132">In the **Properties** window, select the **Events** button.</span></span>

10. <span data-ttu-id="e934b-133">查找**Loaded**事件，然后再双击此事件旁边的下拉列表。</span><span class="sxs-lookup"><span data-stu-id="e934b-133">Find the **Loaded** event, and then double-click the drop-down list next to this event.</span></span>

     <span data-ttu-id="e934b-134">Visual Studio 随即打开此窗口的代码隐藏文件，并生成一个 <xref:System.Windows.FrameworkElement.Loaded> 事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="e934b-134">Visual Studio opens the code-behind file for the window and generates a <xref:System.Windows.FrameworkElement.Loaded> event handler.</span></span>

11. <span data-ttu-id="e934b-135">在新创建的 <xref:System.Windows.FrameworkElement.Loaded> 事件处理程序中，复制并粘贴以下代码。</span><span class="sxs-lookup"><span data-stu-id="e934b-135">In the newly created <xref:System.Windows.FrameworkElement.Loaded> event handler, copy and paste the following code.</span></span>

     [!code-csharp[Astoria Northwind Client#CustomersOrdersDataBindingWpf](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/customerorderswpf2.xaml.cs#customersordersdatabindingwpf)]
     [!code-vb[Astoria Northwind Client#CustomersOrdersDataBindingWpf](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorderswpf2.xaml.vb#customersordersdatabindingwpf)]

12. <span data-ttu-id="e934b-136">此代码根据 LINQ 查询（返回 Northwind 数据服务中 <xref:System.Data.Services.Client.DataServiceCollection%601> 和相关 `Customers` 对象的 <xref:System.Collections.Generic.IEnumerable%601>）的执行情况为 `Customers` 类型创建一个 `Orders` 实例，并将其绑定到 `customersViewSource`。</span><span class="sxs-lookup"><span data-stu-id="e934b-136">This code creates an instance of <xref:System.Data.Services.Client.DataServiceCollection%601> for the `Customers` type based on the execution of a LINQ query that returns an <xref:System.Collections.Generic.IEnumerable%601> of `Customers` along with related `Orders` objects from the Northwind data service and binds it to the `customersViewSource`.</span></span>

## <a name="use-a-project-data-source-in-a-windows-form"></a><span data-ttu-id="e934b-137">使用 Windows 窗体中的项目数据源</span><span class="sxs-lookup"><span data-stu-id="e934b-137">Use a project data source in a Windows form</span></span>

1. <span data-ttu-id="e934b-138">在中**数据源**窗口中，展开**客户**中的节点**NorthwindEntities**项目数据源。</span><span class="sxs-lookup"><span data-stu-id="e934b-138">In the **Data Sources** window, expand the **Customers** node in the **NorthwindEntities** project data source.</span></span>

2. <span data-ttu-id="e934b-139">单击**CustomerID**项目中，选择**组合框**从列表中，并拖动**CustomerID**项从**客户**到节点设计器。</span><span class="sxs-lookup"><span data-stu-id="e934b-139">Click the **CustomerID** item, select **ComboBox** from the list, and drag the **CustomerID** item from the **Customers** node to the designer.</span></span>

     <span data-ttu-id="e934b-140">这会在窗体上创建以下控件：</span><span class="sxs-lookup"><span data-stu-id="e934b-140">This creates the following controls on the form:</span></span>

    - <span data-ttu-id="e934b-141">一个名为 <xref:System.Windows.Forms.BindingSource> 的 `customersBindingSource` 实例。</span><span class="sxs-lookup"><span data-stu-id="e934b-141">An instance of <xref:System.Windows.Forms.BindingSource> named `customersBindingSource`.</span></span>

    - <span data-ttu-id="e934b-142">一个名为 <xref:System.Windows.Forms.BindingNavigator> 的 `customersBindingNavigator` 实例。</span><span class="sxs-lookup"><span data-stu-id="e934b-142">An instance of <xref:System.Windows.Forms.BindingNavigator> named `customersBindingNavigator`.</span></span> <span data-ttu-id="e934b-143">您可以删除此控件，因为它不是必需的。</span><span class="sxs-lookup"><span data-stu-id="e934b-143">You can delete this control as it will not be needed.</span></span>

    - <span data-ttu-id="e934b-144">一个名为 <xref:System.Windows.Forms.ComboBox> 的数据绑定 `CustomerID`。</span><span class="sxs-lookup"><span data-stu-id="e934b-144">A data-bound <xref:System.Windows.Forms.ComboBox> named `CustomerID`.</span></span>

    - <span data-ttu-id="e934b-145"><xref:System.Windows.Forms.Label>。</span><span class="sxs-lookup"><span data-stu-id="e934b-145">A <xref:System.Windows.Forms.Label>.</span></span>

3. <span data-ttu-id="e934b-146">拖动**订单**到窗体的导航属性。</span><span class="sxs-lookup"><span data-stu-id="e934b-146">Drag the **Orders** navigation property to the form.</span></span>

4. <span data-ttu-id="e934b-147">这会创建 `ordersBindingSource` 控件，该控件的 <xref:System.Windows.Forms.BindingSource.DataSource%2A> 属性和 `customersBindingSource` 属性分别设置为 <xref:System.Windows.Forms.BindingSource.DataMember%2A> 和 `Customers`。</span><span class="sxs-lookup"><span data-stu-id="e934b-147">This creates the `ordersBindingSource` control with the <xref:System.Windows.Forms.BindingSource.DataSource%2A> property of the control set to the `customersBindingSource` and the <xref:System.Windows.Forms.BindingSource.DataMember%2A> property set to `Customers`.</span></span> <span data-ttu-id="e934b-148">此外，还会在窗体上创建 `ordersDataGridView` 数据绑定控件，并附带经过相应命名的标签控件。</span><span class="sxs-lookup"><span data-stu-id="e934b-148">It also creates the `ordersDataGridView` data-bound control on the form, accompanied by an appropriately titled label control.</span></span>

5. <span data-ttu-id="e934b-149">（可选）将其他项从**客户**到设计器节点。</span><span class="sxs-lookup"><span data-stu-id="e934b-149">(Optional) Drag additional items from the **Customers** node to the designer.</span></span>

6. <span data-ttu-id="e934b-150">打开窗体的代码页，并添加以下 `using` 语句（在 Visual Basic 中为 `Imports`）：</span><span class="sxs-lookup"><span data-stu-id="e934b-150">Open the code page for the form and add the following `using` statements (`Imports` in Visual Basic):</span></span>

     [!code-csharp[Astoria Northwind Client#CustomersOrdersUsing](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/customerorders.cs#customersordersusing)]
     [!code-vb[Astoria Northwind Client#CustomersOrdersUsing](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorders.vb#customersordersusing)]

7. <span data-ttu-id="e934b-151">在定义窗体的分部类中，添加创建 <xref:System.Data.Objects.ObjectContext> 实例并定义 `customerID` 常量的以下代码。</span><span class="sxs-lookup"><span data-stu-id="e934b-151">In the partial class that defines the form, add the following code that creates an <xref:System.Data.Objects.ObjectContext> instance and defines the `customerID` constant.</span></span>

     [!code-csharp[Astoria Northwind Client#CustomersOrdersDefinition](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/customerorders.cs#customersordersdefinition)]
     [!code-vb[Astoria Northwind Client#CustomersOrdersDefinition](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorders.vb#customersordersdefinition)]

8. <span data-ttu-id="e934b-152">在窗体设计器中，双击窗体。</span><span class="sxs-lookup"><span data-stu-id="e934b-152">In the form designer, double-click the form.</span></span>

     <span data-ttu-id="e934b-153">这会打开窗体的代码页，并创建用于处理窗体的 `Load` 事件的方法。</span><span class="sxs-lookup"><span data-stu-id="e934b-153">This opens the code page for the form and creates the method that handles the `Load` event for the form.</span></span>

9. <span data-ttu-id="e934b-154">在 `Load` 事件处理程序中，复制并粘贴以下代码。</span><span class="sxs-lookup"><span data-stu-id="e934b-154">In the `Load` event handler, copy and paste the following code.</span></span>

     [!code-csharp[Astoria Northwind Client#CustomersOrdersDataBinding](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/customerorders.cs#customersordersdatabinding)]
     [!code-vb[Astoria Northwind Client#CustomersOrdersDataBinding](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorders.vb#customersordersdatabinding)]

10. <span data-ttu-id="e934b-155">此代码根据 <xref:System.Data.Services.Client.DataServiceCollection%601>（返回 Northwind 数据服务中 `Customers` 的 <xref:System.Data.Services.Client.DataServiceQuery%601>）的执行情况为 <xref:System.Collections.Generic.IEnumerable%601> 类型创建一个 `Customers` 实例，并将其绑定到 `customersBindingSource`。</span><span class="sxs-lookup"><span data-stu-id="e934b-155">This code creates an instance of <xref:System.Data.Services.Client.DataServiceCollection%601> for the `Customers` type based on the execution of a <xref:System.Data.Services.Client.DataServiceQuery%601> that returns an <xref:System.Collections.Generic.IEnumerable%601> of `Customers` from the Northwind data service and binds it to the `customersBindingSource`.</span></span>

## <a name="see-also"></a><span data-ttu-id="e934b-156">请参阅</span><span class="sxs-lookup"><span data-stu-id="e934b-156">See also</span></span>

- [<span data-ttu-id="e934b-157">WCF Data Services 客户端库</span><span class="sxs-lookup"><span data-stu-id="e934b-157">WCF Data Services Client Library</span></span>](../../../../docs/framework/data/wcf/wcf-data-services-client-library.md)
- [<span data-ttu-id="e934b-158">如何：将数据绑定到 Windows Presentation Foundation 元素</span><span class="sxs-lookup"><span data-stu-id="e934b-158">How to: Bind Data to Windows Presentation Foundation Elements</span></span>](../../../../docs/framework/data/wcf/bind-data-to-wpf-elements-wcf-data-services.md)
