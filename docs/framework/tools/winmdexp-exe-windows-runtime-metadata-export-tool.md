---
title: Winmdexp.exe（Windows 运行时元数据导出工具）
ms.date: 03/30/2017
helpviewer_keywords:
- Windows Runtime Metadata Export Tool
- Winmdexp.exe
ms.assetid: d2ce0683-343d-403e-bb8d-209186f7a19d
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 5803ef1d174c3e3a5e8e18b130e6b7a0c65eac81
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/18/2019
ms.locfileid: "59216336"
---
# <a name="winmdexpexe-windows-runtime-metadata-export-tool"></a><span data-ttu-id="a0174-102">Winmdexp.exe（Windows 运行时元数据导出工具）</span><span class="sxs-lookup"><span data-stu-id="a0174-102">Winmdexp.exe (Windows Runtime Metadata Export Tool)</span></span>
<span data-ttu-id="a0174-103">[!INCLUDE[wrt](../../../includes/wrt-md.md)]元数据导出工具 (Winmdexp.exe) 可将 .NET Framework 模块转换为包含 [!INCLUDE[wrt](../../../includes/wrt-md.md)]元数据的文件。</span><span class="sxs-lookup"><span data-stu-id="a0174-103">The [!INCLUDE[wrt](../../../includes/wrt-md.md)] Metadata Export Tool (Winmdexp.exe) transforms a .NET Framework module into a file that contains [!INCLUDE[wrt](../../../includes/wrt-md.md)] metadata.</span></span> <span data-ttu-id="a0174-104">尽管 .NET Framework 程序集和 [!INCLUDE[wrt](../../../includes/wrt-md.md)]元数据文件使用相同的物理格式，但元数据表的内容有差别，这意味着 .NET Framework 程序集不可自动用作 [!INCLUDE[wrt](../../../includes/wrt-md.md)]组件。</span><span class="sxs-lookup"><span data-stu-id="a0174-104">Although .NET Framework assemblies and [!INCLUDE[wrt](../../../includes/wrt-md.md)] metadata files use the same physical format, there are differences in the content of the metadata tables, which means that .NET Framework assemblies are not automatically usable as [!INCLUDE[wrt](../../../includes/wrt-md.md)] Components.</span></span> <span data-ttu-id="a0174-105">将 .NET Framework 模块转换为 [!INCLUDE[wrt](../../../includes/wrt-md.md)] 组件的过程称为*导出*。</span><span class="sxs-lookup"><span data-stu-id="a0174-105">The process of turning a .NET Framework module into a [!INCLUDE[wrt](../../../includes/wrt-md.md)] component is referred to as *exporting*.</span></span> <span data-ttu-id="a0174-106">在 [!INCLUDE[net_v45](../../../includes/net-v45-md.md)] 和 [!INCLUDE[net_v451](../../../includes/net-v451-md.md)] 中，生成的 Windows 元数据 (.winmd) 文件同时包含元数据和实现。</span><span class="sxs-lookup"><span data-stu-id="a0174-106">In the [!INCLUDE[net_v45](../../../includes/net-v45-md.md)] and [!INCLUDE[net_v451](../../../includes/net-v451-md.md)], the resulting Windows metadata (.winmd) file contains both metadata and implementation.</span></span>  
  
 <span data-ttu-id="a0174-107">使用 [!INCLUDE[wrt](../../../includes/wrt-md.md)] 组件模板（在 C# 中，位于“Windows 应用商店”下；在 Visual Basic 中，位于 Visual Studio 2013 或 Visual Studio 2012 中）时，编译器目标是 .winmdobj 文件，后续生成步骤将调用 Winmdexp.exe 以将 .winmdobj 文件导出到 .winmd 文件。</span><span class="sxs-lookup"><span data-stu-id="a0174-107">When you use the **[!INCLUDE[wrt](../../../includes/wrt-md.md)] Component** template, which is located under **Windows Store** for C# and Visual Basic in Visual Studio 2013 or Visual Studio 2012, the compiler target is a .winmdobj file, and a subsequent build step calls Winmdexp.exe to export the .winmdobj file to a .winmd file.</span></span> <span data-ttu-id="a0174-108">这是生成 [!INCLUDE[wrt](../../../includes/wrt-md.md)]组件的推荐方法。</span><span class="sxs-lookup"><span data-stu-id="a0174-108">This is the recommended way to build a [!INCLUDE[wrt](../../../includes/wrt-md.md)] component.</span></span> <span data-ttu-id="a0174-109">当你对生成过程需要的控制超过 Visual Studio 所能提供的控制时，请直接使用 Winmdexp.exe。</span><span class="sxs-lookup"><span data-stu-id="a0174-109">Use Winmdexp.exe directly when you want more control over the build process than Visual Studio provides.</span></span>  
  
 <span data-ttu-id="a0174-110">此工具会自动随 Visual Studio 一起安装。</span><span class="sxs-lookup"><span data-stu-id="a0174-110">This tool is automatically installed with Visual Studio.</span></span> <span data-ttu-id="a0174-111">若要运行此工具，请使用 Visual Studio 开发人员命令提示（或 Windows 7 中的 Visual Studio 命令提示）。</span><span class="sxs-lookup"><span data-stu-id="a0174-111">To run the tool, use the Developer Command Prompt for Visual Studio (or the Visual Studio Command Prompt in Windows 7).</span></span> <span data-ttu-id="a0174-112">有关详细信息，请参阅[命令提示](../../../docs/framework/tools/developer-command-prompt-for-vs.md)。</span><span class="sxs-lookup"><span data-stu-id="a0174-112">For more information, see [Command Prompts](../../../docs/framework/tools/developer-command-prompt-for-vs.md).</span></span>  
  
 <span data-ttu-id="a0174-113">在命令提示符处，键入以下内容：</span><span class="sxs-lookup"><span data-stu-id="a0174-113">At the command prompt, type the following:</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="a0174-114">语法</span><span class="sxs-lookup"><span data-stu-id="a0174-114">Syntax</span></span>  
  
```  
winmdexp [options] winmdmodule  
```  
  
## <a name="parameters"></a><span data-ttu-id="a0174-115">参数</span><span class="sxs-lookup"><span data-stu-id="a0174-115">Parameters</span></span>  
  
|<span data-ttu-id="a0174-116">自变量或选项</span><span class="sxs-lookup"><span data-stu-id="a0174-116">Argument or option</span></span>|<span data-ttu-id="a0174-117">说明</span><span class="sxs-lookup"><span data-stu-id="a0174-117">Description</span></span>|  
|------------------------|-----------------|  
|`winmdmodule`|<span data-ttu-id="a0174-118">指定要导出的模块 (.winmdobj)。</span><span class="sxs-lookup"><span data-stu-id="a0174-118">Specifies the module (.winmdobj) to be exported.</span></span> <span data-ttu-id="a0174-119">仅允许一个模块。</span><span class="sxs-lookup"><span data-stu-id="a0174-119">Only one module is allowed.</span></span> <span data-ttu-id="a0174-120">若要创建此模块，请将 `/target` 编译器选项与 `winmdobj` 目标一起使用。</span><span class="sxs-lookup"><span data-stu-id="a0174-120">To create this module, use the `/target` compiler option with the `winmdobj` target.</span></span> <span data-ttu-id="a0174-121">请参阅 [/target:winmdobj（C# 编译器选项）](~/docs/csharp/language-reference/compiler-options/target-winmdobj-compiler-option.md)或 [/target (Visual Basic)](~/docs/visual-basic/reference/command-line-compiler/target.md)。</span><span class="sxs-lookup"><span data-stu-id="a0174-121">See [/target:winmdobj (C# Compiler Options)](~/docs/csharp/language-reference/compiler-options/target-winmdobj-compiler-option.md) or [/target (Visual Basic)](~/docs/visual-basic/reference/command-line-compiler/target.md).</span></span>|  
|<span data-ttu-id="a0174-122">`/docfile:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="a0174-122">`/docfile:` `docfile`</span></span><br /><br /> <span data-ttu-id="a0174-123">`/d:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="a0174-123">`/d:` `docfile`</span></span>|<span data-ttu-id="a0174-124">指定 Winmdexp.exe 将生成的输出 XML 文档文件。</span><span class="sxs-lookup"><span data-stu-id="a0174-124">Specifies the output XML documentation file that Winmdexp.exe will produce.</span></span> <span data-ttu-id="a0174-125">在 [!INCLUDE[net_v45](../../../includes/net-v45-md.md)] 中，输出文件实质上与输入 XML 文档文件相同。</span><span class="sxs-lookup"><span data-stu-id="a0174-125">In the [!INCLUDE[net_v45](../../../includes/net-v45-md.md)], the output file is essentially the same as the input XML documentation file.</span></span>|  
|<span data-ttu-id="a0174-126">`/moduledoc:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="a0174-126">`/moduledoc:` `docfile`</span></span><br /><br /> <span data-ttu-id="a0174-127">`/md:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="a0174-127">`/md:` `docfile`</span></span>|<span data-ttu-id="a0174-128">指定编译器使用 `winmdmodule` 生成的 XML 文档文件的名称。</span><span class="sxs-lookup"><span data-stu-id="a0174-128">Specifies the name of the XML documentation file that the compiler produced with `winmdmodule`.</span></span>|  
|<span data-ttu-id="a0174-129">`/modulepdb:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="a0174-129">`/modulepdb:` `symbolfile`</span></span><br /><br /> <span data-ttu-id="a0174-130">`/mp:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="a0174-130">`/mp:` `symbolfile`</span></span>|<span data-ttu-id="a0174-131">指定包含 `winmdmodule` 的符号的程序数据库 (PDB) 文件的名称。</span><span class="sxs-lookup"><span data-stu-id="a0174-131">Specifies the name of the program database (PDB) file that contains symbols for `winmdmodule`.</span></span>|  
|<span data-ttu-id="a0174-132">`/nowarn:` `warning`</span><span class="sxs-lookup"><span data-stu-id="a0174-132">`/nowarn:` `warning`</span></span>|<span data-ttu-id="a0174-133">禁止显示指定的警告编号。</span><span class="sxs-lookup"><span data-stu-id="a0174-133">Suppresses the specified warning number.</span></span> <span data-ttu-id="a0174-134">对于*警告*，仅提供错误代码的数字部分（不包含前导零）。</span><span class="sxs-lookup"><span data-stu-id="a0174-134">For *warning*, supply only the numeric portion of the error code, without leading zeros.</span></span>|  
|<span data-ttu-id="a0174-135">`/out:` `file`</span><span class="sxs-lookup"><span data-stu-id="a0174-135">`/out:` `file`</span></span><br /><br /> <span data-ttu-id="a0174-136">`/o:` `file`</span><span class="sxs-lookup"><span data-stu-id="a0174-136">`/o:` `file`</span></span>|<span data-ttu-id="a0174-137">指定输出 Windows 元数据 (.winmd) 文件的名称。</span><span class="sxs-lookup"><span data-stu-id="a0174-137">Specifies the name of the output Windows metadata (.winmd) file.</span></span>|  
|<span data-ttu-id="a0174-138">`/pdb:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="a0174-138">`/pdb:` `symbolfile`</span></span><br /><br /> <span data-ttu-id="a0174-139">`/p:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="a0174-139">`/p:` `symbolfile`</span></span>|<span data-ttu-id="a0174-140">指定将包含导出的 Windows 元数据 (.winmd) 文件的符号的输出程序数据库 (PDB) 文件的名称。</span><span class="sxs-lookup"><span data-stu-id="a0174-140">Specifies the name of the output program database (PDB) file that will contain the symbols for the exported Windows metadata (.winmd) file.</span></span>|  
|<span data-ttu-id="a0174-141">`/reference:` `winmd`</span><span class="sxs-lookup"><span data-stu-id="a0174-141">`/reference:` `winmd`</span></span><br /><br /> <span data-ttu-id="a0174-142">`/r:` `winmd`</span><span class="sxs-lookup"><span data-stu-id="a0174-142">`/r:` `winmd`</span></span>|<span data-ttu-id="a0174-143">指定要在导出过程中引用的元数据文件 (.winmd 或程序集)。</span><span class="sxs-lookup"><span data-stu-id="a0174-143">Specifies a metadata file (.winmd or assembly) to reference during export.</span></span> <span data-ttu-id="a0174-144">如果使用“Program Files (x86)\Reference Assemblies\Microsoft\Framework\\.NETCore\v4.5”（在 32 位计算机上为“\Program Files\\...”）中的引用程序集，请包含对 System.Runtime.dll 和 mscorlib.dll 的引用。</span><span class="sxs-lookup"><span data-stu-id="a0174-144">If you use the reference assemblies in "\Program Files (x86)\Reference Assemblies\Microsoft\Framework\\.NETCore\v4.5" ("\Program Files\\..." on 32-bit computers), include references to both System.Runtime.dll and mscorlib.dll.</span></span>|  
|`/utf8output`|<span data-ttu-id="a0174-145">指定输出消息应采用 UTF-8 编码。</span><span class="sxs-lookup"><span data-stu-id="a0174-145">Specifies that output messages should be in UTF-8 encoding.</span></span>|  
|`/warnaserror+`|<span data-ttu-id="a0174-146">指定应将所有警告都视为错误。</span><span class="sxs-lookup"><span data-stu-id="a0174-146">Specifies that all warnings should be treated as errors.</span></span>|  
|<span data-ttu-id="a0174-147">**@** `responsefile`</span><span class="sxs-lookup"><span data-stu-id="a0174-147">**@** `responsefile`</span></span>|<span data-ttu-id="a0174-148">指定包含选项的响应 (.rsp) 文件（并且还可以选择指定 `winmdmodule`）。</span><span class="sxs-lookup"><span data-stu-id="a0174-148">Specifies a response (.rsp) file that contains options (and optionally `winmdmodule`).</span></span> <span data-ttu-id="a0174-149">`responsefile` 中的每行应包含一个参数或选项。</span><span class="sxs-lookup"><span data-stu-id="a0174-149">Each line in `responsefile` should contain a single argument or option.</span></span>|  
  
## <a name="remarks"></a><span data-ttu-id="a0174-150">备注</span><span class="sxs-lookup"><span data-stu-id="a0174-150">Remarks</span></span>  
 <span data-ttu-id="a0174-151">Winmdexp.exe 未被设计将任意 .NET Framework 程序集转换为 .winmd 文件。</span><span class="sxs-lookup"><span data-stu-id="a0174-151">Winmdexp.exe is not designed to convert an arbitrary .NET Framework assembly to a .winmd file.</span></span> <span data-ttu-id="a0174-152">它需要使用 `/target:winmdobj` 选项编译的模块，并且其他限制也适用。</span><span class="sxs-lookup"><span data-stu-id="a0174-152">It requires a module that is compiled with the `/target:winmdobj` option, and additional restrictions apply.</span></span> <span data-ttu-id="a0174-153">这些限制中最重要的是，程序集的 API 图面中公开的所有类型都必须是 [!INCLUDE[wrt](../../../includes/wrt-md.md)]类型。</span><span class="sxs-lookup"><span data-stu-id="a0174-153">The most important of these restrictions is that all types that are exposed in the API surface of the assembly must be [!INCLUDE[wrt](../../../includes/wrt-md.md)] types.</span></span> <span data-ttu-id="a0174-154">有关详细信息，请参阅 Windows 开发人员中心的文章[在 C# 和 Visual Basic 中创建 Windows 运行时组件](https://go.microsoft.com/fwlink/p/?LinkID=238313)的“在 Windows 运行时组件中声明类型”一节。</span><span class="sxs-lookup"><span data-stu-id="a0174-154">For more information, see the "Declaring types in Windows Runtime Components" section of the article [Creating Windows Runtime Components in C# and Visual Basic](https://go.microsoft.com/fwlink/p/?LinkID=238313) in the Windows Dev Center.</span></span>  
  
 <span data-ttu-id="a0174-155">当你使用 C# 或 Visual Basic 编写 [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)]应用或 [!INCLUDE[wrt](../../../includes/wrt-md.md)]组件时，.NET Framework 将提供支持，使得利用 [!INCLUDE[wrt](../../../includes/wrt-md.md)]进行编程更加自然。</span><span class="sxs-lookup"><span data-stu-id="a0174-155">When you write a [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] app or a [!INCLUDE[wrt](../../../includes/wrt-md.md)] component with C# or Visual Basic, the .NET Framework provides support to make programming with the [!INCLUDE[wrt](../../../includes/wrt-md.md)] more natural.</span></span> <span data-ttu-id="a0174-156">[Windows 应用商店应用和 Windows 运行时的 .NET Framework 支持](../../../docs/standard/cross-platform/support-for-windows-store-apps-and-windows-runtime.md)一文中对此进行了讨论。</span><span class="sxs-lookup"><span data-stu-id="a0174-156">This is discussed in the article [.NET Framework Support for Windows Store Apps and Windows Runtime](../../../docs/standard/cross-platform/support-for-windows-store-apps-and-windows-runtime.md).</span></span> <span data-ttu-id="a0174-157">在该过程中，某些常用的 [!INCLUDE[wrt](../../../includes/wrt-md.md)]类型将映射到 .NET Framework 类型。</span><span class="sxs-lookup"><span data-stu-id="a0174-157">In the process, some commonly used [!INCLUDE[wrt](../../../includes/wrt-md.md)] types are mapped to .NET Framework types.</span></span> <span data-ttu-id="a0174-158">Winmdexp.exe 将反转此过程并生成使用对应的 [!INCLUDE[wrt](../../../includes/wrt-md.md)]类型的 API 图面。</span><span class="sxs-lookup"><span data-stu-id="a0174-158">Winmdexp.exe reverses this process and produces an API surface that uses the corresponding [!INCLUDE[wrt](../../../includes/wrt-md.md)] types.</span></span> <span data-ttu-id="a0174-159">例如，从 <xref:System.Collections.Generic.IList%601> 接口构造的类型将映射到从 [!INCLUDE[wrt](../../../includes/wrt-md.md)][IVector\<T>](https://go.microsoft.com/fwlink/p/?LinkId=251132)接口构造的类型。</span><span class="sxs-lookup"><span data-stu-id="a0174-159">For example, types that are constructed from the <xref:System.Collections.Generic.IList%601> interface map to types that are constructed from the [!INCLUDE[wrt](../../../includes/wrt-md.md)][IVector\<T>](https://go.microsoft.com/fwlink/p/?LinkId=251132)interface.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a0174-160">请参阅</span><span class="sxs-lookup"><span data-stu-id="a0174-160">See also</span></span>

- [<span data-ttu-id="a0174-161">.NET Framework 对 Windows 应用商店应用和 Windows 运行时的支持情况</span><span class="sxs-lookup"><span data-stu-id="a0174-161">.NET Framework Support for Windows Store Apps and Windows Runtime</span></span>](../../../docs/standard/cross-platform/support-for-windows-store-apps-and-windows-runtime.md)
- [<span data-ttu-id="a0174-162">用 C# 和 Visual Basic 创建 Windows 运行时组件</span><span class="sxs-lookup"><span data-stu-id="a0174-162">Creating Windows Runtime Components in C# and Visual Basic</span></span>](https://go.microsoft.com/fwlink/p/?LinkID=238313)
- [<span data-ttu-id="a0174-163">Winmdexp.exe 错误消息</span><span class="sxs-lookup"><span data-stu-id="a0174-163">Winmdexp.exe Error Messages</span></span>](../../../docs/framework/tools/winmdexp-exe-error-messages.md)
- <span data-ttu-id="a0174-164">[生成、部署和配置工具 (.NET Framework)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd233108(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="a0174-164">[Build, Deployment, and Configuration Tools (.NET Framework)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd233108(v=vs.100))</span></span>
