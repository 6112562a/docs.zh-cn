---
title: Windows 窗体 DataGridView 控件中的单元格样式
ms.date: 03/30/2017
helpviewer_keywords:
- DataGridView control [Windows Forms], cell styles
- cells [Windows Forms], styles
- data grids [Windows Forms], cell styles
ms.assetid: dbb75ed6-8804-4232-8382-f9920c2e380c
ms.openlocfilehash: 41794c5ecadbcdc0b38c7c73afc7c010a4ea6989
ms.sourcegitcommit: 558d78d2a68acd4c95ef23231c8b4e4c7bac3902
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/09/2019
ms.locfileid: "59300016"
---
# <a name="cell-styles-in-the-windows-forms-datagridview-control"></a><span data-ttu-id="0fb7a-102">Windows 窗体 DataGridView 控件中的单元格样式</span><span class="sxs-lookup"><span data-stu-id="0fb7a-102">Cell Styles in the Windows Forms DataGridView Control</span></span>
<span data-ttu-id="0fb7a-103">中的每个单元格<xref:System.Windows.Forms.DataGridView>控件可以有自己的样式，如文本格式、 背景色、 前景色和字体。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-103">Each cell within the <xref:System.Windows.Forms.DataGridView> control can have its own style, such as text format, background color, foreground color, and font.</span></span> <span data-ttu-id="0fb7a-104">但是，通常情况下，多个单元格将共享特定的样式特征。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-104">Typically, however, multiple cells will share particular style characteristics.</span></span>  
  
 <span data-ttu-id="0fb7a-105">共享样式的单元格的组可能会在控件中包括特定的行或列、 包含特定值的所有单元格或所有单元格内的所有单元格。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-105">Groups of cells that share styles may include all cells within particular rows or columns, all cells that contain particular values, or all cells in the control.</span></span> <span data-ttu-id="0fb7a-106">因为这些组重叠，则每个单元格可能从多个位置中获取其样式信息。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-106">Because these groups overlap, each cell may get its styling information from more than one place.</span></span> <span data-ttu-id="0fb7a-107">例如，可能希望每个单元格<xref:System.Windows.Forms.DataGridView>使用带有负数的相同字体，但仅中要使用货币格式的货币列的单元格和仅货币单元格，才能使用红色前景颜色的控件。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-107">For example, you may want every cell in a <xref:System.Windows.Forms.DataGridView> control to use the same font, but only cells in currency columns to use currency format, and only currency cells with negative numbers to use a red foreground color.</span></span>  
  
## <a name="the-datagridviewcellstyle-class"></a><span data-ttu-id="0fb7a-108">DataGridViewCellStyle 类</span><span class="sxs-lookup"><span data-stu-id="0fb7a-108">The DataGridViewCellStyle Class</span></span>  
 <span data-ttu-id="0fb7a-109"><xref:System.Windows.Forms.DataGridViewCellStyle>类包含视觉样式相关的以下属性：</span><span class="sxs-lookup"><span data-stu-id="0fb7a-109">The <xref:System.Windows.Forms.DataGridViewCellStyle> class contains the following properties related to visual style:</span></span>  
  
-   <xref:System.Windows.Forms.DataGridViewCellStyle.BackColor%2A> <span data-ttu-id="0fb7a-110">和</span><span class="sxs-lookup"><span data-stu-id="0fb7a-110">and</span></span> <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A>  
  
-   <xref:System.Windows.Forms.DataGridViewCellStyle.SelectionBackColor%2A> <span data-ttu-id="0fb7a-111">和</span><span class="sxs-lookup"><span data-stu-id="0fb7a-111">and</span></span> <xref:System.Windows.Forms.DataGridViewCellStyle.SelectionForeColor%2A>  
  
-   <xref:System.Windows.Forms.DataGridViewCellStyle.Font%2A>  
  
 <span data-ttu-id="0fb7a-112">此类还包含与格式设置相关的以下属性：</span><span class="sxs-lookup"><span data-stu-id="0fb7a-112">This class also contains the following properties related to formatting:</span></span>  
  
-   <xref:System.Windows.Forms.DataGridViewCellStyle.Format%2A> <span data-ttu-id="0fb7a-113">和</span><span class="sxs-lookup"><span data-stu-id="0fb7a-113">and</span></span> <xref:System.Windows.Forms.DataGridViewCellStyle.FormatProvider%2A>  
  
-   <xref:System.Windows.Forms.DataGridViewCellStyle.NullValue%2A> <span data-ttu-id="0fb7a-114">和</span><span class="sxs-lookup"><span data-stu-id="0fb7a-114">and</span></span> <xref:System.Windows.Forms.DataGridViewCellStyle.DataSourceNullValue%2A>  
  
-   <xref:System.Windows.Forms.DataGridViewCellStyle.WrapMode%2A>  
  
-   <xref:System.Windows.Forms.DataGridViewCellStyle.Alignment%2A>  
  
-   <xref:System.Windows.Forms.DataGridViewCellStyle.Padding%2A>  
  
 <span data-ttu-id="0fb7a-115">有关这些属性和其他单元格样式属性的详细信息，请参阅<xref:System.Windows.Forms.DataGridViewCellStyle>下面的另请参见部分中列出的参考文档和主题。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-115">For more information on these properties and other cell-style properties, see the <xref:System.Windows.Forms.DataGridViewCellStyle> reference documentation and the topics listed in the See Also section below.</span></span>  
  
## <a name="using-datagridviewcellstyle-objects"></a><span data-ttu-id="0fb7a-116">使用 DataGridViewCellStyle 对象</span><span class="sxs-lookup"><span data-stu-id="0fb7a-116">Using DataGridViewCellStyle Objects</span></span>  
 <span data-ttu-id="0fb7a-117">可以检索<xref:System.Windows.Forms.DataGridViewCellStyle>中的各种属性的对象<xref:System.Windows.Forms.DataGridView>， <xref:System.Windows.Forms.DataGridViewColumn>， <xref:System.Windows.Forms.DataGridViewRow>，和<xref:System.Windows.Forms.DataGridViewCell>类和其派生的类。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-117">You can retrieve <xref:System.Windows.Forms.DataGridViewCellStyle> objects from various properties of the <xref:System.Windows.Forms.DataGridView>, <xref:System.Windows.Forms.DataGridViewColumn>, <xref:System.Windows.Forms.DataGridViewRow>, and <xref:System.Windows.Forms.DataGridViewCell> classes and their derived classes.</span></span> <span data-ttu-id="0fb7a-118">如果这些属性之一具有尚未设置，检索其值会创建一个新<xref:System.Windows.Forms.DataGridViewCellStyle>对象。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-118">If one of these properties has not yet been set, retrieving its value will create a new <xref:System.Windows.Forms.DataGridViewCellStyle> object.</span></span> <span data-ttu-id="0fb7a-119">您还可以实例化自己<xref:System.Windows.Forms.DataGridViewCellStyle>对象，并将其分配给这些属性。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-119">You can also instantiate your own <xref:System.Windows.Forms.DataGridViewCellStyle> objects and assign them to these properties.</span></span>  
  
 <span data-ttu-id="0fb7a-120">您可以通过共享来避免不必要地重复的样式信息<xref:System.Windows.Forms.DataGridViewCellStyle>多个对象<xref:System.Windows.Forms.DataGridView>元素。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-120">You can avoid unnecessary duplication of style information by sharing <xref:System.Windows.Forms.DataGridViewCellStyle> objects among multiple <xref:System.Windows.Forms.DataGridView> elements.</span></span> <span data-ttu-id="0fb7a-121">由于样式设置在控件、 列和行级别筛选器下通过到单元格级别的每个级别，因此还可以通过在不同于上面的级别每个级别设置只显示那些样式属性来避免样式重复。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-121">Because the styles set at the control, column, and row levels filter down through each level to the cell level, you can also avoid style duplication by setting only those style properties at each level that differ from the levels above.</span></span> <span data-ttu-id="0fb7a-122">这是在后面的样式继承部分中的更多详细信息中所述。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-122">This is described in more detail in the Style Inheritance section that follows.</span></span>  
  
 <span data-ttu-id="0fb7a-123">下表列出了用于获取或设置主属性<xref:System.Windows.Forms.DataGridViewCellStyle>对象。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-123">The following table lists the primary properties that get or set <xref:System.Windows.Forms.DataGridViewCellStyle> objects.</span></span>  
  
|<span data-ttu-id="0fb7a-124">属性</span><span class="sxs-lookup"><span data-stu-id="0fb7a-124">Property</span></span>|<span data-ttu-id="0fb7a-125">类</span><span class="sxs-lookup"><span data-stu-id="0fb7a-125">Classes</span></span>|<span data-ttu-id="0fb7a-126">描述</span><span class="sxs-lookup"><span data-stu-id="0fb7a-126">Description</span></span>|  
|--------------|-------------|-----------------|  
|`DefaultCellStyle`|<xref:System.Windows.Forms.DataGridView><span data-ttu-id="0fb7a-127"><xref:System.Windows.Forms.DataGridViewColumn>， <xref:System.Windows.Forms.DataGridViewRow>，和派生类</span><span class="sxs-lookup"><span data-stu-id="0fb7a-127">, <xref:System.Windows.Forms.DataGridViewColumn>, <xref:System.Windows.Forms.DataGridViewRow>, and derived classes</span></span>|<span data-ttu-id="0fb7a-128">获取或设置使用在整个控件 （包括标题单元格），在列中，或行中的所有单元格的默认样式。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-128">Gets or sets default styles used by all cells in the entire control (including header cells), in a column, or in a row.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A>|<xref:System.Windows.Forms.DataGridView>|<span data-ttu-id="0fb7a-129">获取或设置使用的控件中的所有行的默认单元格样式。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-129">Gets or sets default cell styles used by all rows in the control.</span></span> <span data-ttu-id="0fb7a-130">这不包括标头单元格。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-130">This does not include header cells.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A>|<xref:System.Windows.Forms.DataGridView>|<span data-ttu-id="0fb7a-131">获取或设置交替行控件中的使用的默认单元格样式。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-131">Gets or sets default cell styles used by alternating rows in the control.</span></span> <span data-ttu-id="0fb7a-132">用于创建类似于分类帐的效果。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-132">Used to create a ledger-like effect.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A>|<xref:System.Windows.Forms.DataGridView>|<span data-ttu-id="0fb7a-133">获取或设置使用的控件的行标题的默认单元格样式。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-133">Gets or sets default cell styles used by the control's row headers.</span></span> <span data-ttu-id="0fb7a-134">如果启用了可视样式，替代当前主题。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-134">Overridden by the current theme if visual styles are enabled.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A>|<xref:System.Windows.Forms.DataGridView>|<span data-ttu-id="0fb7a-135">获取或设置使用的控件的列标题的默认单元格样式。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-135">Gets or sets default cell styles used by the control's column headers.</span></span> <span data-ttu-id="0fb7a-136">如果启用了可视样式，替代当前主题。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-136">Overridden by the current theme if visual styles are enabled.</span></span>|  
|<xref:System.Windows.Forms.DataGridViewCell.Style%2A>|<xref:System.Windows.Forms.DataGridViewCell> <span data-ttu-id="0fb7a-137">派生类</span><span class="sxs-lookup"><span data-stu-id="0fb7a-137">and derived classes</span></span>|<span data-ttu-id="0fb7a-138">获取或设置单元格级别指定的样式。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-138">Gets or sets styles specified at the cell level.</span></span> <span data-ttu-id="0fb7a-139">这些样式会覆盖从较高级别继承。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-139">These styles override those inherited from higher levels.</span></span>|  
|`InheritedStyle`|<xref:System.Windows.Forms.DataGridViewCell><span data-ttu-id="0fb7a-140"><xref:System.Windows.Forms.DataGridViewRow>， <xref:System.Windows.Forms.DataGridViewColumn>，和派生类</span><span class="sxs-lookup"><span data-stu-id="0fb7a-140">, <xref:System.Windows.Forms.DataGridViewRow>, <xref:System.Windows.Forms.DataGridViewColumn>, and derived classes</span></span>|<span data-ttu-id="0fb7a-141">获取当前应用于单元格、 行或列，其中包括从较高级别继承的所有样式。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-141">Gets all the styles currently applied to the cell, row, or column, including styles inherited from higher levels.</span></span>|  
  
 <span data-ttu-id="0fb7a-142">如上所述，自动获取样式属性的值实例化新<xref:System.Windows.Forms.DataGridViewCellStyle>对象如果属性尚未之前设置。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-142">As mentioned above, getting the value of a style property automatically instantiates a new <xref:System.Windows.Forms.DataGridViewCellStyle> object if the property has not been previously set.</span></span> <span data-ttu-id="0fb7a-143">若要避免不必要地创建这些对象，在行和列类具有<xref:System.Windows.Forms.DataGridViewBand.HasDefaultCellStyle%2A>属性，您可以通过检查来确定是否<xref:System.Windows.Forms.DataGridViewBand.DefaultCellStyle%2A>设置属性。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-143">To avoid creating these objects unnecessarily, the row and column classes have a <xref:System.Windows.Forms.DataGridViewBand.HasDefaultCellStyle%2A> property that you can check to determine whether the <xref:System.Windows.Forms.DataGridViewBand.DefaultCellStyle%2A> property has been set.</span></span> <span data-ttu-id="0fb7a-144">同样，单元格类具有<xref:System.Windows.Forms.DataGridViewCell.HasStyle%2A>属性，指示是否<xref:System.Windows.Forms.DataGridViewCell.Style%2A>设置属性。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-144">Similarly, the cell classes have a <xref:System.Windows.Forms.DataGridViewCell.HasStyle%2A> property that indicates whether the <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property has been set.</span></span>  
  
 <span data-ttu-id="0fb7a-145">样式属性的每个都有相应*PropertyName* `Changed`上的事件<xref:System.Windows.Forms.DataGridView>控件。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-145">Each of the style properties has a corresponding *PropertyName*`Changed` event on the <xref:System.Windows.Forms.DataGridView> control.</span></span> <span data-ttu-id="0fb7a-146">有关行、 列和单元属性，该事件的名称开头"`Row`"，"`Column`"，或"`Cell`"(例如， <xref:System.Windows.Forms.DataGridView.RowDefaultCellStyleChanged>)。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-146">For row, column, and cell properties, the name of the event begins with "`Row`", "`Column`", or "`Cell`" (for example, <xref:System.Windows.Forms.DataGridView.RowDefaultCellStyleChanged>).</span></span> <span data-ttu-id="0fb7a-147">每个事件发生时相应的样式属性设置为另一种<xref:System.Windows.Forms.DataGridViewCellStyle>对象。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-147">Each of these events occurs when the corresponding style property is set to a different <xref:System.Windows.Forms.DataGridViewCellStyle> object.</span></span> <span data-ttu-id="0fb7a-148">在检索时不会发生这些事件<xref:System.Windows.Forms.DataGridViewCellStyle>对象从一个样式属性，并修改其属性值。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-148">These events do not occur when you retrieve a <xref:System.Windows.Forms.DataGridViewCellStyle> object from a style property and modify its property values.</span></span> <span data-ttu-id="0fb7a-149">若要对单元格样式对象本身的更改做出响应，处理<xref:System.Windows.Forms.DataGridView.CellStyleContentChanged>事件。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-149">To respond to changes to the cell style objects themselves, handle the <xref:System.Windows.Forms.DataGridView.CellStyleContentChanged> event.</span></span>  
  
## <a name="style-inheritance"></a><span data-ttu-id="0fb7a-150">样式继承</span><span class="sxs-lookup"><span data-stu-id="0fb7a-150">Style Inheritance</span></span>  
 <span data-ttu-id="0fb7a-151">每个<xref:System.Windows.Forms.DataGridViewCell>获取从其外观其<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-151">Each <xref:System.Windows.Forms.DataGridViewCell> gets its appearance from its <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> property.</span></span> <span data-ttu-id="0fb7a-152"><xref:System.Windows.Forms.DataGridViewCellStyle>此属性返回的对象继承其属性值的类型的属性层次结构从<xref:System.Windows.Forms.DataGridViewCellStyle>。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-152">The <xref:System.Windows.Forms.DataGridViewCellStyle> object returned by this property inherits its values from a hierarchy of properties of type <xref:System.Windows.Forms.DataGridViewCellStyle>.</span></span> <span data-ttu-id="0fb7a-153">下面列出的顺序在这些属性<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>非标头单元格获得其值。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-153">These properties are listed below in the order in which the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> for non-header cells obtains its values.</span></span>  
  
1. <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>  
  
2. <xref:System.Windows.Forms.DataGridViewRow.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
3. <xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType> <span data-ttu-id="0fb7a-154">（仅适用于具有奇数的索引号的行中单元格）</span><span class="sxs-lookup"><span data-stu-id="0fb7a-154">(only for cells in rows with odd index numbers)</span></span>  
  
4. <xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A?displayProperty=nameWithType>  
  
5. <xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
6. <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="0fb7a-155">为行和列标题单元格<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>用从以下列表按给定顺序的源属性的值填充属性。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-155">For row and column header cells, the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> property is populated by values from the following list of source properties in the given order.</span></span>  
  
1. <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>  
  
2. <xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A?displayProperty=nameWithType> <span data-ttu-id="0fb7a-156">或</span><span class="sxs-lookup"><span data-stu-id="0fb7a-156">or</span></span> <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A?displayProperty=nameWithType>  
  
3. <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="0fb7a-157">下图说明了此过程。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-157">The following diagram illustrates this process.</span></span>  
  
 <span data-ttu-id="0fb7a-158">![类型 DataGridViewCellStyle 的属性](./media/cell-styles-in-the-windows-forms-datagridview-control/datagridviewcells-inheritance-diagram.gif "DataGridViewCells 继承关系图")</span><span class="sxs-lookup"><span data-stu-id="0fb7a-158">![Properties of type DataGridViewCellStyle](./media/cell-styles-in-the-windows-forms-datagridview-control/datagridviewcells-inheritance-diagram.gif "DataGridViewCells inheritance diagram")</span></span>  
  
 <span data-ttu-id="0fb7a-159">此外可以访问继承的特定行和列的样式。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-159">You can also access the styles inherited by specific rows and columns.</span></span> <span data-ttu-id="0fb7a-160">列<xref:System.Windows.Forms.DataGridViewColumn.InheritedStyle%2A>属性从下列属性继承它的值。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-160">The column <xref:System.Windows.Forms.DataGridViewColumn.InheritedStyle%2A> property inherits its values from the following properties.</span></span>  
  
1. <xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
2. <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="0fb7a-161">行<xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A>属性从下列属性继承它的值。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-161">The row <xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A> property inherits its values from the following properties.</span></span>  
  
1. <xref:System.Windows.Forms.DataGridViewRow.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
2. <xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType> <span data-ttu-id="0fb7a-162">（仅适用于具有奇数的索引号的行中单元格）</span><span class="sxs-lookup"><span data-stu-id="0fb7a-162">(only for cells in rows with odd index numbers)</span></span>  
  
3. <xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A?displayProperty=nameWithType>  
  
4. <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="0fb7a-163">中每个属性<xref:System.Windows.Forms.DataGridViewCellStyle>返回的对象`InheritedStyle`属性，属性值从第一个单元格样式在相应的列表具有相应的属性设置为一个值，而不获取<xref:System.Windows.Forms.DataGridViewCellStyle>类的默认值。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-163">For each property in a <xref:System.Windows.Forms.DataGridViewCellStyle> object returned by an `InheritedStyle` property, the property value is obtained from the first cell style in the appropriate list that has the corresponding property set to a value other than the <xref:System.Windows.Forms.DataGridViewCellStyle> class defaults.</span></span>  
  
 <span data-ttu-id="0fb7a-164">下表说明了如何将<xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A>示例单元格的属性值继承自其包含的列。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-164">The following table illustrates how the <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A> property value for an example cell is inherited from its containing column.</span></span>  
  
|<span data-ttu-id="0fb7a-165">类型的属性</span><span class="sxs-lookup"><span data-stu-id="0fb7a-165">Property of type</span></span> `DataGridViewCellStyle`|<span data-ttu-id="0fb7a-166">示例`ForeColor`检索到的对象的值</span><span class="sxs-lookup"><span data-stu-id="0fb7a-166">Example `ForeColor` value for retrieved object</span></span>|  
|----------------------------------------------|----------------------------------------------------|  
|<xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Empty?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridViewRow.DefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Red%2A?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Empty?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Empty?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.DarkBlue%2A?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Black%2A?displayProperty=nameWithType>|  
  
 <span data-ttu-id="0fb7a-167">在这种情况下，<xref:System.Drawing.Color.Red%2A?displayProperty=nameWithType>从单元格的行的值是列表上的第一个实际值。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-167">In this case, the <xref:System.Drawing.Color.Red%2A?displayProperty=nameWithType> value from the cell's row is the first real value on the list.</span></span> <span data-ttu-id="0fb7a-168">这将成为<xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A>属性值的单元格的<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-168">This becomes the <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A> property value of the cell's <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>.</span></span>  
  
 <span data-ttu-id="0fb7a-169">下图说明了如何将不同<xref:System.Windows.Forms.DataGridViewCellStyle>属性继承其属性值从不同的位置。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-169">The following diagram illustrates how different <xref:System.Windows.Forms.DataGridViewCellStyle> properties can inherit their values from different places.</span></span>  
  
 <span data-ttu-id="0fb7a-170">![DataGridView 属性&#45;值继承](./media/cell-styles-in-the-windows-forms-datagridview-control/datagridviewcells-value-inheritance-diagram.gif "DataGridViewCells 值继承关系图")</span><span class="sxs-lookup"><span data-stu-id="0fb7a-170">![DataGridView property&#45;value inheritance](./media/cell-styles-in-the-windows-forms-datagridview-control/datagridviewcells-value-inheritance-diagram.gif "DataGridViewCells value inheritance diagram")</span></span>  
  
 <span data-ttu-id="0fb7a-171">通过利用样式继承，可以为整个控件提供适当的样式，而无需在多个位置指定相同的信息。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-171">By taking advantage of style inheritance, you can provide appropriate styles for the entire control without having to specify the same information in multiple places.</span></span>  
  
 <span data-ttu-id="0fb7a-172">尽管标头单元格参与样式继承，如所述，通过返回的对象<xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A>并<xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A>的属性<xref:System.Windows.Forms.DataGridView>控件具有重写返回的对象的属性值的初始属性值<xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-172">Although header cells participate in style inheritance as described, the objects returned by the <xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A> and <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A> properties of the <xref:System.Windows.Forms.DataGridView> control have initial property values that override the property values of the object returned by the <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A> property.</span></span> <span data-ttu-id="0fb7a-173">如果您要返回的对象设置属性<xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A>属性应用到行和列标题，必须设置返回的对象的相应属性<xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A>和<xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A>所指示的默认值的属性有关<xref:System.Windows.Forms.DataGridViewCellStyle>类。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-173">If you want the properties set for the object returned by the <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A> property to apply to row and column headers, you must set the corresponding properties of the objects returned by the <xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A> and <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A> properties to the defaults indicated for the <xref:System.Windows.Forms.DataGridViewCellStyle> class.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="0fb7a-174">如果启用了可视样式，行和列标题 (除<xref:System.Windows.Forms.DataGridView.TopLeftHeaderCell%2A>) 样式将自动由当前主题，重写这些属性指定任何样式。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-174">If visual styles are enabled, the row and column headers (except for the <xref:System.Windows.Forms.DataGridView.TopLeftHeaderCell%2A>) are automatically styled by the current theme, overriding any styles specified by these properties.</span></span>  
  
 <span data-ttu-id="0fb7a-175"><xref:System.Windows.Forms.DataGridViewButtonColumn>， <xref:System.Windows.Forms.DataGridViewImageColumn>，并<xref:System.Windows.Forms.DataGridViewCheckBoxColumn>类型还初始化的列返回的对象的某些值<xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-175">The <xref:System.Windows.Forms.DataGridViewButtonColumn>, <xref:System.Windows.Forms.DataGridViewImageColumn>, and <xref:System.Windows.Forms.DataGridViewCheckBoxColumn> types also initialize some values of the object returned by the column <xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A> property.</span></span> <span data-ttu-id="0fb7a-176">有关详细信息，请参阅这些类型的参考文档。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-176">For more information, see the reference documentation for these types.</span></span>  
  
## <a name="setting-styles-dynamically"></a><span data-ttu-id="0fb7a-177">动态设置样式</span><span class="sxs-lookup"><span data-stu-id="0fb7a-177">Setting Styles Dynamically</span></span>  
 <span data-ttu-id="0fb7a-178">若要自定义的具有特定值的单元格的样式，实现的处理程序<xref:System.Windows.Forms.DataGridView.CellFormatting?displayProperty=nameWithType>事件。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-178">To customize the styles of cells with particular values, implement a handler for the <xref:System.Windows.Forms.DataGridView.CellFormatting?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="0fb7a-179">此事件处理程序接收的自变量<xref:System.Windows.Forms.DataGridViewCellFormattingEventArgs>类型。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-179">Handlers for this event receive an argument of the <xref:System.Windows.Forms.DataGridViewCellFormattingEventArgs> type.</span></span> <span data-ttu-id="0fb7a-180">此对象包含属性，可确定其位置以及要设置格式的单元格的值<xref:System.Windows.Forms.DataGridView>控件。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-180">This object contains properties that let you determine the value of the cell being formatted along with its location in the <xref:System.Windows.Forms.DataGridView> control.</span></span> <span data-ttu-id="0fb7a-181">此对象还包含<xref:System.Windows.Forms.DataGridViewCellFormattingEventArgs.CellStyle%2A>初始化为的值的属性<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>正在格式化的单元格的属性。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-181">This object also contains a <xref:System.Windows.Forms.DataGridViewCellFormattingEventArgs.CellStyle%2A> property that is initialized to the value of the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> property of the cell being formatted.</span></span> <span data-ttu-id="0fb7a-182">可以修改的单元格样式属性来指定相应的单元格的值和位置的样式信息。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-182">You can modify the cell style properties to specify style information appropriate to the cell value and location.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="0fb7a-183"><xref:System.Windows.Forms.DataGridView.RowPrePaint>并<xref:System.Windows.Forms.DataGridView.RowPostPaint>事件也会收到<xref:System.Windows.Forms.DataGridViewCellStyle>对象在事件数据，但在其大小写，它是行的副本<xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A>属性用于只读目的并对它的更改不会影响该控件。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-183">The <xref:System.Windows.Forms.DataGridView.RowPrePaint> and <xref:System.Windows.Forms.DataGridView.RowPostPaint> events also receive a <xref:System.Windows.Forms.DataGridViewCellStyle> object in the event data, but in their case, it is a copy of the row <xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A> property for read-only purposes, and changes to it do not affect the control.</span></span>  
  
 <span data-ttu-id="0fb7a-184">如还可以动态修改响应事件的各个单元格的样式<xref:System.Windows.Forms.DataGridView.CellMouseEnter?displayProperty=nameWithType>和<xref:System.Windows.Forms.DataGridView.CellMouseLeave>事件。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-184">You can also dynamically modify the styles of individual cells in response to events such as the <xref:System.Windows.Forms.DataGridView.CellMouseEnter?displayProperty=nameWithType> and <xref:System.Windows.Forms.DataGridView.CellMouseLeave> events.</span></span> <span data-ttu-id="0fb7a-185">例如，在处理程序<xref:System.Windows.Forms.DataGridView.CellMouseEnter>事件，可以存储的单元格背景色的当前值 (通过该单元格的检索<xref:System.Windows.Forms.DataGridViewCell.Style%2A>属性)，然后将其设置为将突出显示该单元格，当鼠标悬停时的新颜色。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-185">For example, in a handler for the <xref:System.Windows.Forms.DataGridView.CellMouseEnter> event, you could store the current value of the cell background color (retrieved through the cell's <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property), then set it to a new color that will highlight the cell when the mouse hovers over it.</span></span> <span data-ttu-id="0fb7a-186">中的处理程序<xref:System.Windows.Forms.DataGridView.CellMouseLeave>事件，然后将背景色还原为原始值。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-186">In a handler for the <xref:System.Windows.Forms.DataGridView.CellMouseLeave> event, you can then restore the background color to the original value.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="0fb7a-187">缓存存储在单元格的值<xref:System.Windows.Forms.DataGridViewCell.Style%2A>属性是非常重要，而不考虑是否设置了特定样式值。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-187">Caching the values stored in the cell's <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property is important regardless of whether a particular style value is set.</span></span> <span data-ttu-id="0fb7a-188">如果您暂时替换样式设置，将其还原到其原始的"未设置"状态可确保，则该单元格将返回到从高级别继承的样式设置。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-188">If you temporarily replace a style setting, restoring it to its original "not set" state ensures that the cell will go back to inheriting the style setting from a higher level.</span></span> <span data-ttu-id="0fb7a-189">如果您需要确定有效的而不考虑是否继承样式的单元格的实际样式，使用该单元格的<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="0fb7a-189">If you need to determine the actual style in effect for a cell regardless of whether the style is inherited, use the cell's <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> property.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0fb7a-190">请参阅</span><span class="sxs-lookup"><span data-stu-id="0fb7a-190">See also</span></span>

- <xref:System.Windows.Forms.DataGridView>
- <xref:System.Windows.Forms.DataGridViewCellStyle>
- <xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewBand.InheritedStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewColumn.InheritedStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewBand.DefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.CellFormatting?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.CellStyleContentChanged?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.RowPrePaint?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.RowPostPaint?displayProperty=nameWithType>
- [<span data-ttu-id="0fb7a-191">Windows 窗体 DataGridView 控件中的基本格式设置和样式设置</span><span class="sxs-lookup"><span data-stu-id="0fb7a-191">Basic Formatting and Styling in the Windows Forms DataGridView Control</span></span>](basic-formatting-and-styling-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="0fb7a-192">如何：设置 Windows 窗体 DataGridView 控件的默认单元格样式</span><span class="sxs-lookup"><span data-stu-id="0fb7a-192">How to: Set Default Cell Styles for the Windows Forms DataGridView Control</span></span>](how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="0fb7a-193">Windows 窗体 DataGridView 控件中的数据格式设置</span><span class="sxs-lookup"><span data-stu-id="0fb7a-193">Data Formatting in the Windows Forms DataGridView Control</span></span>](data-formatting-in-the-windows-forms-datagridview-control.md)
