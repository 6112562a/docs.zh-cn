---
title: 在 MenuStrip 控件中合并菜单项
ms.date: 03/30/2017
helpviewer_keywords:
- MenuStrip [Windows Forms], merging
- merging [Windows Forms], general concepts
ms.assetid: 95e113ba-f362-4dda-8a76-6d95ddc45cee
ms.openlocfilehash: 9fc2b40ef23d72db51853c124095b734a7646cda
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/24/2020
ms.locfileid: "76739052"
---
# <a name="merging-menu-items-in-the-windows-forms-menustrip-control"></a><span data-ttu-id="dfe8c-102">在 Windows 窗体 MenuStrip 控件中合并菜单项</span><span class="sxs-lookup"><span data-stu-id="dfe8c-102">Merging Menu Items in the Windows Forms MenuStrip Control</span></span>
<span data-ttu-id="dfe8c-103">如果有多文档界面（MDI）应用程序，则可以将子窗体中的菜单项或整个菜单合并到父窗体的菜单中。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-103">If you have a multiple-document interface (MDI) application, you can merge menu items or whole menus from the child form into the menus of the parent form.</span></span>  
  
 <span data-ttu-id="dfe8c-104">本主题介绍与在 MDI 应用程序中合并菜单项相关的基本概念。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-104">This topic describes the basic concepts associated with merging menu items in an MDI application.</span></span>  
  
## <a name="general-concepts"></a><span data-ttu-id="dfe8c-105">一般概念</span><span class="sxs-lookup"><span data-stu-id="dfe8c-105">General Concepts</span></span>  
 <span data-ttu-id="dfe8c-106">合并过程涉及目标和源代码管理：</span><span class="sxs-lookup"><span data-stu-id="dfe8c-106">Merging procedures involve both a target and a source control:</span></span>  
  
- <span data-ttu-id="dfe8c-107">目标是要合并菜单项的主窗体或 MDI 父窗体上的 <xref:System.Windows.Forms.MenuStrip> 控件。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-107">The target is the <xref:System.Windows.Forms.MenuStrip> control on the main or MDI parent form into which you are merging menu items.</span></span>  
  
- <span data-ttu-id="dfe8c-108">源是 MDI 子窗体上的 <xref:System.Windows.Forms.MenuStrip> 控件，其中包含要合并到目标菜单中的菜单项。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-108">The source is the <xref:System.Windows.Forms.MenuStrip> control on the MDI child form that contains the menu items you want to merge into the target menu.</span></span>  
  
 <span data-ttu-id="dfe8c-109"><xref:System.Windows.Forms.MenuStrip.MdiWindowListItem%2A> 属性标识其下拉列表将用当前 MDI 父窗体的 MDI 子级的标题填充的菜单项。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-109">The <xref:System.Windows.Forms.MenuStrip.MdiWindowListItem%2A> property identifies the menu item whose drop-down list you will populate with the titles of the current MDI parent form's MDI children.</span></span> <span data-ttu-id="dfe8c-110">例如，通常列出当前在 "**窗口**" 菜单上打开的 MDI 子级。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-110">For example, you typically list MDI children that are currently open on the **Window** menu.</span></span>  
  
 <span data-ttu-id="dfe8c-111"><xref:System.Windows.Forms.ToolStripMenuItem.IsMdiWindowListEntry%2A> 属性标识哪个菜单项来自 MDI 子窗体上的 <xref:System.Windows.Forms.MenuStrip>。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-111">The <xref:System.Windows.Forms.ToolStripMenuItem.IsMdiWindowListEntry%2A> property identifies which menu items come from a <xref:System.Windows.Forms.MenuStrip> on an MDI child form.</span></span>  
  
 <span data-ttu-id="dfe8c-112">您可以手动或自动合并菜单项。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-112">You can merge menu items manually or automatically.</span></span> <span data-ttu-id="dfe8c-113">对于这两种方法，菜单项以相同的方式进行合并，但以不同的方式激活合并，如本主题后面的 "手动合并" 和 "自动合并" 部分所述。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-113">The menu items merge in the same way for both methods, but the merge is activated differently, as discussed in the "Manual Merging" and "Automatic Merging" sections later in this topic.</span></span> <span data-ttu-id="dfe8c-114">在手动和自动合并中，每个合并操作都将影响下一个合并操作。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-114">In both manual and automatic merging, each merge action affects the next merge action.</span></span>  
  
 <span data-ttu-id="dfe8c-115"><xref:System.Windows.Forms.MenuStrip> 合并会将菜单项从一个 <xref:System.Windows.Forms.ToolStrip> 移到另一个，而不是将其克隆，这与 <xref:System.Windows.Forms.MainMenu>的情况相同。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-115"><xref:System.Windows.Forms.MenuStrip> merging moves menu items from one <xref:System.Windows.Forms.ToolStrip> to another rather than cloning them, as was the case with <xref:System.Windows.Forms.MainMenu>.</span></span>  
  
## <a name="mergeaction-values"></a><span data-ttu-id="dfe8c-116">MergeAction 值</span><span class="sxs-lookup"><span data-stu-id="dfe8c-116">MergeAction Values</span></span>  
 <span data-ttu-id="dfe8c-117">使用 <xref:System.Windows.Forms.MergeAction> 属性在源 <xref:System.Windows.Forms.MenuStrip> 中的菜单项上设置合并操作。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-117">You set the merge action on menu items in the source <xref:System.Windows.Forms.MenuStrip> using the <xref:System.Windows.Forms.MergeAction> property.</span></span>  
  
 <span data-ttu-id="dfe8c-118">下表介绍了可用合并操作的含义和典型用法。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-118">The following table describes the meaning and typical use of the available merge actions.</span></span>  
  
|<span data-ttu-id="dfe8c-119">MergeAction 值</span><span class="sxs-lookup"><span data-stu-id="dfe8c-119">MergeAction Value</span></span>|<span data-ttu-id="dfe8c-120">说明</span><span class="sxs-lookup"><span data-stu-id="dfe8c-120">Description</span></span>|<span data-ttu-id="dfe8c-121">典型用法</span><span class="sxs-lookup"><span data-stu-id="dfe8c-121">Typical Use</span></span>|  
|-----------------------|-----------------|-----------------|  
|<xref:System.Windows.Forms.MergeAction.Append>|<span data-ttu-id="dfe8c-122">缺省值将源项添加到目标项集合的末尾。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-122">(Default) Adds the source item to the end of the target item's collection.</span></span>|<span data-ttu-id="dfe8c-123">当激活程序的一部分时，将菜单项添加到菜单的末尾。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-123">Adding menu items to the end of the menu when some part of the program is activated.</span></span>|  
|<xref:System.Windows.Forms.MergeAction.Insert>|<span data-ttu-id="dfe8c-124">在源项上设置的 <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> 属性指定的位置，将源项添加到目标项的集合中。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-124">Adds the source item to the target item's collection, in the location specified by the <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> property set on the source item.</span></span>|<span data-ttu-id="dfe8c-125">当激活程序的一部分时，将菜单项添加到菜单的中间或开头。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-125">Adding menu items to the middle or the beginning of the menu when some part of the program is activated.</span></span><br /><br /> <span data-ttu-id="dfe8c-126">如果两个菜单项 <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> 的值相同，则按相反顺序添加它们。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-126">If the value of <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> is the same for both menu items, they are added in reverse order.</span></span> <span data-ttu-id="dfe8c-127">适当设置 <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> 以保留原始订单。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-127">Set <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> appropriately to preserve the original order.</span></span>|  
|<xref:System.Windows.Forms.MergeAction.Replace>|<span data-ttu-id="dfe8c-128">查找文本匹配项，如果未找到任何文本匹配项，则使用 <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> 值，然后将匹配的目标菜单项替换为源菜单项。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-128">Finds a text match, or uses the <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> value if no text match is found, and then replaces the matching target menu item with the source menu item.</span></span>|<span data-ttu-id="dfe8c-129">将目标菜单项替换为同一名称的具有不同操作的源菜单项。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-129">Replacing a target menu item with a source menu item of the same name that does something different.</span></span>|  
|<xref:System.Windows.Forms.MergeAction.MatchOnly>|<span data-ttu-id="dfe8c-130">查找文本匹配项，如果未找到匹配项，则使用 <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> 值，然后将所有下拉项从源添加到目标。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-130">Finds a text match, or uses the <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> value if no text match is found, and then adds all the drop-down items from the source to the target.</span></span>|<span data-ttu-id="dfe8c-131">生成在子菜单中插入或添加菜单项的菜单结构，或从子菜单中删除菜单项。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-131">Building a menu structure that inserts or adds menu items into a submenu, or removes menu items from a submenu.</span></span> <span data-ttu-id="dfe8c-132">例如，你可以将菜单项从 MDI 子级添加到主 <xref:System.Windows.Forms.MenuStrip>"**另存为**" 菜单。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-132">For example, you can add a menu item from an MDI child to a main <xref:System.Windows.Forms.MenuStrip>**Save As** menu.</span></span><br /><br /> <span data-ttu-id="dfe8c-133"><xref:System.Windows.Forms.MergeAction.MatchOnly> 允许您在不执行任何操作的情况下浏览菜单结构。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-133"><xref:System.Windows.Forms.MergeAction.MatchOnly> allows you to navigate through the menu structure without taking any action.</span></span> <span data-ttu-id="dfe8c-134">它提供了一种方法来评估后续项。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-134">It provides a way to evaluate the subsequent items.</span></span>|  
|<xref:System.Windows.Forms.MergeAction.Remove>|<span data-ttu-id="dfe8c-135">查找文本匹配项，如果未找到匹配项，则使用 <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> 值，然后从目标中删除该项。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-135">Finds a text match, or uses the <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> value if no text match is found, and then removes the item from the target.</span></span>|<span data-ttu-id="dfe8c-136">从目标 <xref:System.Windows.Forms.MenuStrip>中删除菜单项。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-136">Removing a menu item from the target <xref:System.Windows.Forms.MenuStrip>.</span></span>|  
  
## <a name="manual-merging"></a><span data-ttu-id="dfe8c-137">手动合并</span><span class="sxs-lookup"><span data-stu-id="dfe8c-137">Manual Merging</span></span>  
 <span data-ttu-id="dfe8c-138">只有 <xref:System.Windows.Forms.MenuStrip> 控件参与自动合并。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-138">Only <xref:System.Windows.Forms.MenuStrip> controls participate in automatic merging.</span></span> <span data-ttu-id="dfe8c-139">若要将其他控件的项（如 <xref:System.Windows.Forms.ToolStrip> 和 <xref:System.Windows.Forms.StatusStrip> 控件）组合在一起，则必须根据需要在代码中通过调用 <xref:System.Windows.Forms.ToolStripManager.Merge%2A> 和 <xref:System.Windows.Forms.ToolStripManager.RevertMerge%2A> 方法，手动合并这些项。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-139">To combine the items of other controls, such as <xref:System.Windows.Forms.ToolStrip> and <xref:System.Windows.Forms.StatusStrip> controls, you must merge them manually, by calling the <xref:System.Windows.Forms.ToolStripManager.Merge%2A> and <xref:System.Windows.Forms.ToolStripManager.RevertMerge%2A> methods in your code as required.</span></span>  
  
## <a name="automatic-merging"></a><span data-ttu-id="dfe8c-140">自动合并</span><span class="sxs-lookup"><span data-stu-id="dfe8c-140">Automatic Merging</span></span>  
 <span data-ttu-id="dfe8c-141">通过激活源窗体，可以使用 MDI 应用程序的自动合并。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-141">You can use automatic merging for MDI applications by activating the source form.</span></span> <span data-ttu-id="dfe8c-142">若要在 MDI 应用程序中使用 <xref:System.Windows.Forms.MenuStrip>，请将 <xref:System.Windows.Forms.Form.MainMenuStrip%2A> 属性设置为目标 <xref:System.Windows.Forms.MenuStrip>，以便在源 <xref:System.Windows.Forms.MenuStrip> 上执行的合并操作反映在目标 <xref:System.Windows.Forms.MenuStrip>中。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-142">To use a <xref:System.Windows.Forms.MenuStrip> in an MDI application, set the <xref:System.Windows.Forms.Form.MainMenuStrip%2A> property to the target <xref:System.Windows.Forms.MenuStrip> so that merging actions performed on the source <xref:System.Windows.Forms.MenuStrip> are reflected in the target <xref:System.Windows.Forms.MenuStrip>.</span></span>  
  
 <span data-ttu-id="dfe8c-143">可以通过激活 MDI 源上的 <xref:System.Windows.Forms.MenuStrip> 来触发自动合并。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-143">You can trigger automatic merging by activating the <xref:System.Windows.Forms.MenuStrip> on the MDI source.</span></span> <span data-ttu-id="dfe8c-144">激活时，源 <xref:System.Windows.Forms.MenuStrip> 会合并到 MDI 目标中。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-144">Upon activation, the source <xref:System.Windows.Forms.MenuStrip> is merged into the MDI target.</span></span> <span data-ttu-id="dfe8c-145">当新窗体变为活动状态时，将在最后一个窗体上恢复合并，并在新窗体上触发。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-145">When a new form becomes active, the merge is reverted on the last form and triggered on the new form.</span></span> <span data-ttu-id="dfe8c-146">您可以根据需要在每个 <xref:System.Windows.Forms.ToolStripItem>上设置 <xref:System.Windows.Forms.ToolStripItem.MergeAction%2A> 属性，并在每个 <xref:System.Windows.Forms.MenuStrip>上设置 <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A> 属性，来控制此行为。</span><span class="sxs-lookup"><span data-stu-id="dfe8c-146">You can control this behavior by setting the <xref:System.Windows.Forms.ToolStripItem.MergeAction%2A> property as needed on each <xref:System.Windows.Forms.ToolStripItem>, and by setting the <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A> property on each <xref:System.Windows.Forms.MenuStrip>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="dfe8c-147">另请参阅</span><span class="sxs-lookup"><span data-stu-id="dfe8c-147">See also</span></span>

- <xref:System.Windows.Forms.ToolStripManager>
- <xref:System.Windows.Forms.MenuStrip>
- [<span data-ttu-id="dfe8c-148">MenuStrip 控件</span><span class="sxs-lookup"><span data-stu-id="dfe8c-148">MenuStrip Control</span></span>](menustrip-control-windows-forms.md)
- [<span data-ttu-id="dfe8c-149">如何：使用 MenuStrip 创建 MDI 窗口列表</span><span class="sxs-lookup"><span data-stu-id="dfe8c-149">How to: Create an MDI Window List with MenuStrip</span></span>](how-to-create-an-mdi-window-list-with-menustrip-windows-forms.md)
- [<span data-ttu-id="dfe8c-150">如何：为 MDI 应用程序设置自动菜单合并</span><span class="sxs-lookup"><span data-stu-id="dfe8c-150">How to: Set Up Automatic Menu Merging for MDI Applications</span></span>](how-to-set-up-automatic-menu-merging-for-mdi-applications.md)
