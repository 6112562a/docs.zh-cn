---
title: 缩放 Windows 窗体 DataGridView 控件的最佳做法
ms.date: 03/30/2017
helpviewer_keywords:
- DataGridView control [Windows Forms], row sharing
- data grids [Windows Forms], best practices
- DataGridView control [Windows Forms], shared rows
- DataGridView control [Windows Forms], best practices
- best practices [Windows Forms], dataGridView control
- DataGridView control [Windows Forms], scaling
ms.assetid: 8321a8a6-6340-4fd1-b475-fa090b905aaf
ms.openlocfilehash: 5adbcdb4aa34b3878e278d47337defe4388dd892
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/23/2019
ms.locfileid: "54710867"
---
# <a name="best-practices-for-scaling-the-windows-forms-datagridview-control"></a><span data-ttu-id="f6846-102">缩放 Windows 窗体 DataGridView 控件的最佳做法</span><span class="sxs-lookup"><span data-stu-id="f6846-102">Best Practices for Scaling the Windows Forms DataGridView Control</span></span>
<span data-ttu-id="f6846-103"><xref:System.Windows.Forms.DataGridView>控件旨在提供最大可伸缩性。</span><span class="sxs-lookup"><span data-stu-id="f6846-103">The <xref:System.Windows.Forms.DataGridView> control is designed to provide maximum scalability.</span></span> <span data-ttu-id="f6846-104">如果需要显示大量的数据，则应遵循本主题，以避免消耗大量的内存或降低响应能力的用户界面 (UI) 中所述的准则。</span><span class="sxs-lookup"><span data-stu-id="f6846-104">If you need to display large amounts of data, you should follow the guidelines described in this topic to avoid consuming large amounts of memory or degrading the responsiveness of the user interface (UI).</span></span> <span data-ttu-id="f6846-105">本主题讨论下列问题：</span><span class="sxs-lookup"><span data-stu-id="f6846-105">This topic discusses the following issues:</span></span>  
  
-   <span data-ttu-id="f6846-106">有效地使用的单元格样式</span><span class="sxs-lookup"><span data-stu-id="f6846-106">Using cell styles efficiently</span></span>  
  
-   <span data-ttu-id="f6846-107">有效地使用快捷菜单</span><span class="sxs-lookup"><span data-stu-id="f6846-107">Using shortcut menus efficiently</span></span>  
  
-   <span data-ttu-id="f6846-108">使用自动调整大小高效</span><span class="sxs-lookup"><span data-stu-id="f6846-108">Using automatic resizing efficiently</span></span>  
  
-   <span data-ttu-id="f6846-109">有效使用所选的单元格、 行和列集合</span><span class="sxs-lookup"><span data-stu-id="f6846-109">Using the selected cells, rows, and columns collections efficiently</span></span>  
  
-   <span data-ttu-id="f6846-110">使用共享的行</span><span class="sxs-lookup"><span data-stu-id="f6846-110">Using shared rows</span></span>  
  
-   <span data-ttu-id="f6846-111">防止行成为非共享行</span><span class="sxs-lookup"><span data-stu-id="f6846-111">Preventing rows from becoming unshared</span></span>  
  
 <span data-ttu-id="f6846-112">如果你有特殊性能需求，可以实现虚拟模式并提供你自己的数据管理操作。</span><span class="sxs-lookup"><span data-stu-id="f6846-112">If you have special performance needs, you can implement virtual mode and provide your own data management operations.</span></span> <span data-ttu-id="f6846-113">有关详细信息，请参阅[Windows 窗体 DataGridView 控件中的数据显示模式](../../../../docs/framework/winforms/controls/data-display-modes-in-the-windows-forms-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="f6846-113">For more information, see [Data Display Modes in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/data-display-modes-in-the-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="using-cell-styles-efficiently"></a><span data-ttu-id="f6846-114">有效地使用的单元格样式</span><span class="sxs-lookup"><span data-stu-id="f6846-114">Using Cell Styles Efficiently</span></span>  
 <span data-ttu-id="f6846-115">每个单元格、 行和列可以具有其自己的样式信息。</span><span class="sxs-lookup"><span data-stu-id="f6846-115">Each cell, row, and column can have its own style information.</span></span> <span data-ttu-id="f6846-116">样式的信息存储在<xref:System.Windows.Forms.DataGridViewCellStyle>对象。</span><span class="sxs-lookup"><span data-stu-id="f6846-116">Style information is stored in <xref:System.Windows.Forms.DataGridViewCellStyle> objects.</span></span> <span data-ttu-id="f6846-117">创建多个独立单元格样式对象<xref:System.Windows.Forms.DataGridView>元素可以是效率不高，尤其在使用大量的数据时。</span><span class="sxs-lookup"><span data-stu-id="f6846-117">Creating cell style objects for many individual <xref:System.Windows.Forms.DataGridView> elements can be inefficient, especially when working with large amounts of data.</span></span> <span data-ttu-id="f6846-118">若要避免对性能产生影响，请使用以下准则：</span><span class="sxs-lookup"><span data-stu-id="f6846-118">To avoid a performance impact, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="f6846-119">避免设置单元格样式属性为各个<xref:System.Windows.Forms.DataGridViewCell>或<xref:System.Windows.Forms.DataGridViewRow>对象。</span><span class="sxs-lookup"><span data-stu-id="f6846-119">Avoid setting cell style properties for individual <xref:System.Windows.Forms.DataGridViewCell> or <xref:System.Windows.Forms.DataGridViewRow> objects.</span></span> <span data-ttu-id="f6846-120">这包括指定的行对象<xref:System.Windows.Forms.DataGridView.RowTemplate%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="f6846-120">This includes the row object specified by the <xref:System.Windows.Forms.DataGridView.RowTemplate%2A> property.</span></span> <span data-ttu-id="f6846-121">每个新行的行模板从克隆会收到其自己的模板的单元格样式对象副本。</span><span class="sxs-lookup"><span data-stu-id="f6846-121">Each new row that is cloned from the row template will receive its own copy of the template's cell style object.</span></span> <span data-ttu-id="f6846-122">最大可伸缩性，设置在单元格样式属性<xref:System.Windows.Forms.DataGridView>级别。</span><span class="sxs-lookup"><span data-stu-id="f6846-122">For maximum scalability, set cell style properties at the <xref:System.Windows.Forms.DataGridView> level.</span></span> <span data-ttu-id="f6846-123">例如，设置<xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>属性而不是<xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>属性。</span><span class="sxs-lookup"><span data-stu-id="f6846-123">For example, set the <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType> property rather than the <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType> property.</span></span>  
  
-   <span data-ttu-id="f6846-124">如果某些单元格需要比默认格式设置的其他格式，使用相同<xref:System.Windows.Forms.DataGridViewCellStyle>跨单元格、 行或列组的实例。</span><span class="sxs-lookup"><span data-stu-id="f6846-124">If some cells require formatting other than default formatting, use the same <xref:System.Windows.Forms.DataGridViewCellStyle> instance across groups of cells, rows, or columns.</span></span> <span data-ttu-id="f6846-125">避免直接设置属性类型的<xref:System.Windows.Forms.DataGridViewCellStyle>上各个单元格、 行和列。</span><span class="sxs-lookup"><span data-stu-id="f6846-125">Avoid directly setting properties of type <xref:System.Windows.Forms.DataGridViewCellStyle> on individual cells, rows, and columns.</span></span> <span data-ttu-id="f6846-126">单元格样式共享的示例，请参阅[如何：设置 Windows 窗体 DataGridView 控件的默认单元格样式](../../../../docs/framework/winforms/controls/how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="f6846-126">For an example of cell style sharing, see [How to: Set Default Cell Styles for the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md).</span></span> <span data-ttu-id="f6846-127">通过处理单独设置单元格样式时，也可以避免对性能产生负面影响<xref:System.Windows.Forms.DataGridView.CellFormatting>事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="f6846-127">You can also avoid a performance penalty when setting cell styles individually by handling the <xref:System.Windows.Forms.DataGridView.CellFormatting> event handler.</span></span> <span data-ttu-id="f6846-128">有关示例，请参见 [如何：自定义 Windows 窗体 DataGridView 控件中的数据格式设置](../../../../docs/framework/winforms/controls/how-to-customize-data-formatting-in-the-windows-forms-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="f6846-128">For an example, see [How to: Customize Data Formatting in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/how-to-customize-data-formatting-in-the-windows-forms-datagridview-control.md).</span></span>  
  
-   <span data-ttu-id="f6846-129">在确定单元格的样式，使用<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A?displayProperty=nameWithType>属性而不是<xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>属性。</span><span class="sxs-lookup"><span data-stu-id="f6846-129">When determining a cell's style, use the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A?displayProperty=nameWithType> property rather than the <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="f6846-130">访问<xref:System.Windows.Forms.DataGridViewCell.Style%2A>属性创建的新实例<xref:System.Windows.Forms.DataGridViewCellStyle>类如果尚未使用该属性。</span><span class="sxs-lookup"><span data-stu-id="f6846-130">Accessing the <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property creates a new instance of the <xref:System.Windows.Forms.DataGridViewCellStyle> class if the property has not already been used.</span></span> <span data-ttu-id="f6846-131">此外，此对象可能不包含该单元格的完整的样式信息，如果某些样式继承自行、 列或控件。</span><span class="sxs-lookup"><span data-stu-id="f6846-131">Additionally, this object might not contain the complete style information for the cell if some styles are inherited from the row, column, or control.</span></span> <span data-ttu-id="f6846-132">有关单元格的样式继承的详细信息，请参阅[Windows 窗体 DataGridView 控件中的单元格样式](../../../../docs/framework/winforms/controls/cell-styles-in-the-windows-forms-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="f6846-132">For more information about cell style inheritance, see [Cell Styles in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/cell-styles-in-the-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="using-shortcut-menus-efficiently"></a><span data-ttu-id="f6846-133">有效地使用快捷菜单</span><span class="sxs-lookup"><span data-stu-id="f6846-133">Using Shortcut Menus Efficiently</span></span>  
 <span data-ttu-id="f6846-134">每个单元格、 行和列可以具有其自己的快捷菜单。</span><span class="sxs-lookup"><span data-stu-id="f6846-134">Each cell, row, and column can have its own shortcut menu.</span></span> <span data-ttu-id="f6846-135">中的快捷菜单<xref:System.Windows.Forms.DataGridView>控制由<xref:System.Windows.Forms.ContextMenuStrip>控件。</span><span class="sxs-lookup"><span data-stu-id="f6846-135">Shortcut menus in the <xref:System.Windows.Forms.DataGridView> control are represented by <xref:System.Windows.Forms.ContextMenuStrip> controls.</span></span> <span data-ttu-id="f6846-136">只需与单元格样式对象一样，为许多单个创建快捷方式菜单<xref:System.Windows.Forms.DataGridView>元素会对性能产生负面影响。</span><span class="sxs-lookup"><span data-stu-id="f6846-136">Just as with cell style objects, creating shortcut menus for many individual <xref:System.Windows.Forms.DataGridView> elements will negatively impact performance.</span></span> <span data-ttu-id="f6846-137">若要避免这种下降，请使用以下准则：</span><span class="sxs-lookup"><span data-stu-id="f6846-137">To avoid this penalty, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="f6846-138">避免创建各个单元格和行的快捷菜单。</span><span class="sxs-lookup"><span data-stu-id="f6846-138">Avoid creating shortcut menus for individual cells and rows.</span></span> <span data-ttu-id="f6846-139">这包括行模板，新行添加到控件时，会克隆以及其快捷菜单。</span><span class="sxs-lookup"><span data-stu-id="f6846-139">This includes the row template, which is cloned along with its shortcut menu when new rows are added to the control.</span></span> <span data-ttu-id="f6846-140">最大可伸缩性，使用仅该控件的<xref:System.Windows.Forms.Control.ContextMenuStrip%2A>属性可以指定整个控件的一个快捷方式菜单。</span><span class="sxs-lookup"><span data-stu-id="f6846-140">For maximum scalability, use only the control's <xref:System.Windows.Forms.Control.ContextMenuStrip%2A> property to specify a single shortcut menu for the entire control.</span></span>  
  
-   <span data-ttu-id="f6846-141">如果您需要针对多个行或单元格的多个快捷菜单，处理<xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded>或<xref:System.Windows.Forms.DataGridView.RowContextMenuStripNeeded>事件。</span><span class="sxs-lookup"><span data-stu-id="f6846-141">If you require multiple shortcut menus for multiple rows or cells, handle the <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> or <xref:System.Windows.Forms.DataGridView.RowContextMenuStripNeeded> events.</span></span> <span data-ttu-id="f6846-142">这些事件使您可以管理快捷方式菜单对象自己，从而可以优化性能。</span><span class="sxs-lookup"><span data-stu-id="f6846-142">These events let you manage the shortcut menu objects yourself, allowing you to tune performance.</span></span>  
  
## <a name="using-automatic-resizing-efficiently"></a><span data-ttu-id="f6846-143">使用自动调整大小高效</span><span class="sxs-lookup"><span data-stu-id="f6846-143">Using Automatic Resizing Efficiently</span></span>  
 <span data-ttu-id="f6846-144">行、 列和标头可以自动调整大小作为单元格的内容更改，以便完整地显示单元格的全部内容。</span><span class="sxs-lookup"><span data-stu-id="f6846-144">Rows, columns, and headers can be automatically resized as cell content changes so that the entire contents of cells are displayed without clipping.</span></span> <span data-ttu-id="f6846-145">更改大小调整模式还可以调整行、 列和标头。</span><span class="sxs-lookup"><span data-stu-id="f6846-145">Changing sizing modes can also resize rows, columns, and headers.</span></span> <span data-ttu-id="f6846-146">若要确定正确的大小，<xref:System.Windows.Forms.DataGridView>控件必须检查必须适应每个单元格的值。</span><span class="sxs-lookup"><span data-stu-id="f6846-146">To determine the correct size, the <xref:System.Windows.Forms.DataGridView> control must examine the value of each cell that it must accommodate.</span></span> <span data-ttu-id="f6846-147">当处理大型数据集，此分析会降低该控件的性能，自动调整大小发生时。</span><span class="sxs-lookup"><span data-stu-id="f6846-147">When working with large data sets, this analysis can negatively impact the performance of the control when automatic resizing occurs.</span></span> <span data-ttu-id="f6846-148">若要避免性能损失，使用以下准则：</span><span class="sxs-lookup"><span data-stu-id="f6846-148">To avoid performance penalties, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="f6846-149">避免使用自动调整大小<xref:System.Windows.Forms.DataGridView>与大量的行的控件。</span><span class="sxs-lookup"><span data-stu-id="f6846-149">Avoid using automatic sizing on a <xref:System.Windows.Forms.DataGridView> control with a large set of rows.</span></span> <span data-ttu-id="f6846-150">如果使用自动调整大小，调整大小，根据所显示的行。</span><span class="sxs-lookup"><span data-stu-id="f6846-150">If you do use automatic sizing, only resize based on the displayed rows.</span></span> <span data-ttu-id="f6846-151">处于虚拟模式下以及使用显示的行。</span><span class="sxs-lookup"><span data-stu-id="f6846-151">Use only the displayed rows in virtual mode as well.</span></span>  
  
    -   <span data-ttu-id="f6846-152">行和列，请使用`DisplayedCells`或`DisplayedCellsExceptHeaders`字段<xref:System.Windows.Forms.DataGridViewAutoSizeRowsMode>， <xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode>，和<xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode>枚举。</span><span class="sxs-lookup"><span data-stu-id="f6846-152">For rows and columns, use the `DisplayedCells` or `DisplayedCellsExceptHeaders` field of the <xref:System.Windows.Forms.DataGridViewAutoSizeRowsMode>, <xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode>, and <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode> enumerations.</span></span>  
  
    -   <span data-ttu-id="f6846-153">对于行标题，请使用<xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToDisplayedHeaders>或<xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToFirstHeader>字段<xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode>枚举。</span><span class="sxs-lookup"><span data-stu-id="f6846-153">For row headers, use the <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToDisplayedHeaders> or <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToFirstHeader> field of the <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode> enumeration.</span></span>  
  
-   <span data-ttu-id="f6846-154">最大可伸缩性，关闭自动调整大小和使用以编程方式调整大小。</span><span class="sxs-lookup"><span data-stu-id="f6846-154">For maximum scalability, turn off automatic sizing and use programmatic resizing.</span></span>  
  
 <span data-ttu-id="f6846-155">有关详细信息，请参阅[Windows 窗体 DataGridView 控件中调整大小选项](../../../../docs/framework/winforms/controls/sizing-options-in-the-windows-forms-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="f6846-155">For more information, see [Sizing Options in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/sizing-options-in-the-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="using-the-selected-cells-rows-and-columns-collections-efficiently"></a><span data-ttu-id="f6846-156">有效使用选定的单元格、 行和列集合</span><span class="sxs-lookup"><span data-stu-id="f6846-156">Using the Selected Cells, Rows, and Columns Collections Efficiently</span></span>  
 <span data-ttu-id="f6846-157"><xref:System.Windows.Forms.DataGridView.SelectedCells%2A>集合不会使用大型选择有效地执行。</span><span class="sxs-lookup"><span data-stu-id="f6846-157">The <xref:System.Windows.Forms.DataGridView.SelectedCells%2A> collection does not perform efficiently with large selections.</span></span> <span data-ttu-id="f6846-158"><xref:System.Windows.Forms.DataGridView.SelectedRows%2A>并<xref:System.Windows.Forms.DataGridView.SelectedColumns%2A>集合还可能效率很低，尽管到一定程度上因为有许多较少行，比在典型的单元格<xref:System.Windows.Forms.DataGridView>控制和许多较少的列比行。</span><span class="sxs-lookup"><span data-stu-id="f6846-158">The <xref:System.Windows.Forms.DataGridView.SelectedRows%2A> and <xref:System.Windows.Forms.DataGridView.SelectedColumns%2A> collections can also be inefficient, although to a lesser degree because there are many fewer rows than cells in a typical <xref:System.Windows.Forms.DataGridView> control, and many fewer columns than rows.</span></span> <span data-ttu-id="f6846-159">若要避免性能损失，使用这些集合时，使用以下准则：</span><span class="sxs-lookup"><span data-stu-id="f6846-159">To avoid performance penalties when working with these collections, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="f6846-160">若要确定是否中的所有单元格<xref:System.Windows.Forms.DataGridView>访问的内容之前选择了<xref:System.Windows.Forms.DataGridView.SelectedCells%2A>集合中，检查返回值的<xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="f6846-160">To determine whether all the cells in the <xref:System.Windows.Forms.DataGridView> have been selected before you access the contents of the <xref:System.Windows.Forms.DataGridView.SelectedCells%2A> collection, check the return value of the <xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A> method.</span></span> <span data-ttu-id="f6846-161">但请注意，此方法可能会导致行变为非共享。</span><span class="sxs-lookup"><span data-stu-id="f6846-161">Note, however, that this method can cause rows to become unshared.</span></span> <span data-ttu-id="f6846-162">有关更多信息，请参见下一节。</span><span class="sxs-lookup"><span data-stu-id="f6846-162">For more information, see the next section.</span></span>  
  
-   <span data-ttu-id="f6846-163">避免使用<xref:System.Collections.ICollection.Count%2A>属性的<xref:System.Windows.Forms.DataGridViewSelectedCellCollection?displayProperty=nameWithType>来确定选定的单元格的数目。</span><span class="sxs-lookup"><span data-stu-id="f6846-163">Avoid using the <xref:System.Collections.ICollection.Count%2A> property of the <xref:System.Windows.Forms.DataGridViewSelectedCellCollection?displayProperty=nameWithType> to determine the number of selected cells.</span></span> <span data-ttu-id="f6846-164">请改用<xref:System.Windows.Forms.DataGridView.GetCellCount%2A?displayProperty=nameWithType>方法并传入<xref:System.Windows.Forms.DataGridViewElementStates.Selected?displayProperty=nameWithType>值。</span><span class="sxs-lookup"><span data-stu-id="f6846-164">Instead, use the <xref:System.Windows.Forms.DataGridView.GetCellCount%2A?displayProperty=nameWithType> method and pass in the <xref:System.Windows.Forms.DataGridViewElementStates.Selected?displayProperty=nameWithType> value.</span></span> <span data-ttu-id="f6846-165">同样，使用<xref:System.Windows.Forms.DataGridViewRowCollection.GetRowCount%2A?displayProperty=nameWithType>和<xref:System.Windows.Forms.DataGridViewColumnCollection.GetColumnCount%2A?displayProperty=nameWithType>方法来确定选定的元素，而不是访问所选的行和列集合的数目。</span><span class="sxs-lookup"><span data-stu-id="f6846-165">Similarly, use the <xref:System.Windows.Forms.DataGridViewRowCollection.GetRowCount%2A?displayProperty=nameWithType> and <xref:System.Windows.Forms.DataGridViewColumnCollection.GetColumnCount%2A?displayProperty=nameWithType> methods to determine the number of selected elements, rather than accessing the selected row and column collections.</span></span>  
  
-   <span data-ttu-id="f6846-166">避免基于单元格的选择模式。</span><span class="sxs-lookup"><span data-stu-id="f6846-166">Avoid cell-based selection modes.</span></span> <span data-ttu-id="f6846-167">与此相反，设置<xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType>属性设置为<xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType>或<xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="f6846-167">Instead, set the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property to <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>.</span></span>  
  
## <a name="using-shared-rows"></a><span data-ttu-id="f6846-168">使用共享行</span><span class="sxs-lookup"><span data-stu-id="f6846-168">Using Shared Rows</span></span>  
 <span data-ttu-id="f6846-169">在实现高效的内存使用<xref:System.Windows.Forms.DataGridView>控制通过共享行。</span><span class="sxs-lookup"><span data-stu-id="f6846-169">Efficient memory use is achieved in the <xref:System.Windows.Forms.DataGridView> control through shared rows.</span></span> <span data-ttu-id="f6846-170">行将通过共享的实例来共享尽可能多的信息有关其外观和行为可能<xref:System.Windows.Forms.DataGridViewRow>类。</span><span class="sxs-lookup"><span data-stu-id="f6846-170">Rows will share as much information about their appearance and behavior as possible by sharing instances of the <xref:System.Windows.Forms.DataGridViewRow> class.</span></span>  
  
 <span data-ttu-id="f6846-171">虽然共享行实例节省内存，行可以轻松地成为非共享行。</span><span class="sxs-lookup"><span data-stu-id="f6846-171">While sharing row instances saves memory, rows can easily become unshared.</span></span> <span data-ttu-id="f6846-172">例如，每当用户交互直接与单元格时，其行变为非共享。</span><span class="sxs-lookup"><span data-stu-id="f6846-172">For example, whenever a user interacts directly with a cell, its row becomes unshared.</span></span> <span data-ttu-id="f6846-173">由于不能避免此操作，此主题中的准则十分有用，仅当使用的数据量非常大并且仅当用户将与相对较小部分数据交互每次运行程序时。</span><span class="sxs-lookup"><span data-stu-id="f6846-173">Because this cannot be avoided, the guidelines in this topic are useful only when working with very large amounts of data and only when users will interact with a relatively small part of the data each time your program is run.</span></span>  
  
 <span data-ttu-id="f6846-174">不能共享行中未绑定<xref:System.Windows.Forms.DataGridView>控制是否有任何其单元格包含值。</span><span class="sxs-lookup"><span data-stu-id="f6846-174">A row cannot be shared in an unbound <xref:System.Windows.Forms.DataGridView> control if any of its cells contain values.</span></span> <span data-ttu-id="f6846-175">当<xref:System.Windows.Forms.DataGridView>控件绑定到外部数据源或外部控件而不是在单元格对象，允许要共享的行时实现虚拟模式并提供您自己的数据源时，存储单元格的值。</span><span class="sxs-lookup"><span data-stu-id="f6846-175">When the <xref:System.Windows.Forms.DataGridView> control is bound to an external data source or when you implement virtual mode and provide your own data source, the cell values are stored outside the control rather than in cell objects, allowing the rows to be shared.</span></span>  
  
 <span data-ttu-id="f6846-176">如果可以从行的状态和包含的单元格的列的状态确定所有单元格的状态，可以仅共享行对象。</span><span class="sxs-lookup"><span data-stu-id="f6846-176">A row object can only be shared if the state of all its cells can be determined from the state of the row and the states of the columns containing the cells.</span></span> <span data-ttu-id="f6846-177">如果您更改单元格的状态，以便从其行和列的状态可以不再推导，不能共享行。</span><span class="sxs-lookup"><span data-stu-id="f6846-177">If you change the state of a cell so that it can no longer be deduced from the state of its row and column, the row cannot be shared.</span></span>  
  
 <span data-ttu-id="f6846-178">例如，不能在任何以下情况下共享行：</span><span class="sxs-lookup"><span data-stu-id="f6846-178">For example, a row cannot be shared in any of the following situations:</span></span>  
  
-   <span data-ttu-id="f6846-179">包含一个所选的单元格不在所选列中的行。</span><span class="sxs-lookup"><span data-stu-id="f6846-179">The row contains a single selected cell that is not in a selected column.</span></span>  
  
-   <span data-ttu-id="f6846-180">行包含具有的单元格及其<xref:System.Windows.Forms.DataGridViewCell.ToolTipText%2A>或<xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A>属性集。</span><span class="sxs-lookup"><span data-stu-id="f6846-180">The row contains a cell with its <xref:System.Windows.Forms.DataGridViewCell.ToolTipText%2A> or <xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A> properties set.</span></span>  
  
-   <span data-ttu-id="f6846-181">包含的行<xref:System.Windows.Forms.DataGridViewComboBoxCell>使用其<xref:System.Windows.Forms.DataGridViewComboBoxCell.Items%2A>属性集。</span><span class="sxs-lookup"><span data-stu-id="f6846-181">The row contains a <xref:System.Windows.Forms.DataGridViewComboBoxCell> with its <xref:System.Windows.Forms.DataGridViewComboBoxCell.Items%2A> property set.</span></span>  
  
 <span data-ttu-id="f6846-182">在绑定的模式或虚拟模式下，可以提供工具提示和快捷菜单为单个单元通过处理<xref:System.Windows.Forms.DataGridView.CellToolTipTextNeeded>和<xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded>事件。</span><span class="sxs-lookup"><span data-stu-id="f6846-182">In bound mode or virtual mode, you can provide ToolTips and shortcut menus for individual cells by handling the <xref:System.Windows.Forms.DataGridView.CellToolTipTextNeeded> and <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> events.</span></span>  
  
 <span data-ttu-id="f6846-183"><xref:System.Windows.Forms.DataGridView>控件将自动尝试使用共享的行，只要行添加到<xref:System.Windows.Forms.DataGridViewRowCollection>。</span><span class="sxs-lookup"><span data-stu-id="f6846-183">The <xref:System.Windows.Forms.DataGridView> control will automatically attempt to use shared rows whenever rows are added to the <xref:System.Windows.Forms.DataGridViewRowCollection>.</span></span> <span data-ttu-id="f6846-184">使用以下准则以确保共享行：</span><span class="sxs-lookup"><span data-stu-id="f6846-184">Use the following guidelines to ensure that rows are shared:</span></span>  
  
-   <span data-ttu-id="f6846-185">避免调用`Add(Object[])`的重载<xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A>方法并`Insert(Object[])`重载<xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A>方法<xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType>集合。</span><span class="sxs-lookup"><span data-stu-id="f6846-185">Avoid calling the `Add(Object[])` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method and the `Insert(Object[])` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span> <span data-ttu-id="f6846-186">这些重载自动创建非共享的行。</span><span class="sxs-lookup"><span data-stu-id="f6846-186">These overloads automatically create unshared rows.</span></span>  
  
-   <span data-ttu-id="f6846-187">务必中指定的行<xref:System.Windows.Forms.DataGridView.RowTemplate%2A?displayProperty=nameWithType>可在以下情况下共享属性：</span><span class="sxs-lookup"><span data-stu-id="f6846-187">Be sure that the row specified in the <xref:System.Windows.Forms.DataGridView.RowTemplate%2A?displayProperty=nameWithType> property can be shared in the following cases:</span></span>  
  
    -   <span data-ttu-id="f6846-188">调用时`Add()`或`Add(Int32)`的重载<xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A>方法或`Insert(Int32,Int32)`重载<xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A>方法<xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType>集合。</span><span class="sxs-lookup"><span data-stu-id="f6846-188">When calling the `Add()` or `Add(Int32)` overloads of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method or the `Insert(Int32,Int32)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>  
  
    -   <span data-ttu-id="f6846-189">增加的值时<xref:System.Windows.Forms.DataGridView.RowCount%2A?displayProperty=nameWithType>属性。</span><span class="sxs-lookup"><span data-stu-id="f6846-189">When increasing the value of the <xref:System.Windows.Forms.DataGridView.RowCount%2A?displayProperty=nameWithType> property.</span></span>  
  
    -   <span data-ttu-id="f6846-190">设置时<xref:System.Windows.Forms.DataGridView.DataSource%2A?displayProperty=nameWithType>属性。</span><span class="sxs-lookup"><span data-stu-id="f6846-190">When setting the <xref:System.Windows.Forms.DataGridView.DataSource%2A?displayProperty=nameWithType> property.</span></span>  
  
-   <span data-ttu-id="f6846-191">请确保所指示的行`indexSource`调用时，可以共享参数<xref:System.Windows.Forms.DataGridViewRowCollection.AddCopy%2A>， <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopies%2A>， <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopy%2A>，并<xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopies%2A>方法<xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType>集合。</span><span class="sxs-lookup"><span data-stu-id="f6846-191">Be sure that the row indicated by the `indexSource` parameter can be shared when calling the <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopy%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopies%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopy%2A>, and <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopies%2A> methods of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>  
  
-   <span data-ttu-id="f6846-192">确保在调用时，可共享的指定的行`Add(DataGridViewRow)`的重载<xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A>方法，<xref:System.Windows.Forms.DataGridViewRowCollection.AddRange%2A>方法，`Insert(Int32,DataGridViewRow)`重载<xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A>方法，和<xref:System.Windows.Forms.DataGridViewRowCollection.InsertRange%2A>方法<xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType>集合。</span><span class="sxs-lookup"><span data-stu-id="f6846-192">Be sure that the specified row or rows can be shared when calling the `Add(DataGridViewRow)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method, the <xref:System.Windows.Forms.DataGridViewRowCollection.AddRange%2A> method, the `Insert(Int32,DataGridViewRow)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method, and the <xref:System.Windows.Forms.DataGridViewRowCollection.InsertRange%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>  
  
 <span data-ttu-id="f6846-193">若要确定是否共享行，请使用<xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType>方法以检索行对象，然后查看该对象的<xref:System.Windows.Forms.DataGridViewBand.Index%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="f6846-193">To determine whether a row is shared, use the <xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> method to retrieve the row object, and then check the object's <xref:System.Windows.Forms.DataGridViewBand.Index%2A> property.</span></span> <span data-ttu-id="f6846-194">共享的行始终具有<xref:System.Windows.Forms.DataGridViewBand.Index%2A>属性值为 – 1。</span><span class="sxs-lookup"><span data-stu-id="f6846-194">Shared rows always have an <xref:System.Windows.Forms.DataGridViewBand.Index%2A> property value of –1.</span></span>  
  
## <a name="preventing-rows-from-becoming-unshared"></a><span data-ttu-id="f6846-195">防止行成为非共享行</span><span class="sxs-lookup"><span data-stu-id="f6846-195">Preventing Rows from Becoming Unshared</span></span>  
 <span data-ttu-id="f6846-196">共享的行可以成为非共享行代码或用户操作的结果。</span><span class="sxs-lookup"><span data-stu-id="f6846-196">Shared rows can become unshared as a result of code or user action.</span></span> <span data-ttu-id="f6846-197">若要避免对性能产生影响，应避免使行成为非共享行。</span><span class="sxs-lookup"><span data-stu-id="f6846-197">To avoid a performance impact, you should avoid causing rows to become unshared.</span></span> <span data-ttu-id="f6846-198">应用程序在开发期间，可以处理<xref:System.Windows.Forms.DataGridView.RowUnshared>事件以确定当行成为非共享行。</span><span class="sxs-lookup"><span data-stu-id="f6846-198">During application development, you can handle the <xref:System.Windows.Forms.DataGridView.RowUnshared> event to determine when rows become unshared.</span></span> <span data-ttu-id="f6846-199">调试行共享问题时，这很有用。</span><span class="sxs-lookup"><span data-stu-id="f6846-199">This is useful when debugging row-sharing problems.</span></span>  
  
 <span data-ttu-id="f6846-200">若要防止行成为非共享行，请使用以下准则：</span><span class="sxs-lookup"><span data-stu-id="f6846-200">To prevent rows from becoming unshared, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="f6846-201">避免对创建索引<xref:System.Windows.Forms.DataGridView.Rows%2A>集合或循环访问其与`foreach`循环。</span><span class="sxs-lookup"><span data-stu-id="f6846-201">Avoid indexing the <xref:System.Windows.Forms.DataGridView.Rows%2A> collection or iterating through it with a `foreach` loop.</span></span> <span data-ttu-id="f6846-202">您将通常不需要直接访问的行。</span><span class="sxs-lookup"><span data-stu-id="f6846-202">You will not typically need to access rows directly.</span></span> <span data-ttu-id="f6846-203"><xref:System.Windows.Forms.DataGridView> 对行执行操作的方法接受行索引参数而不是行实例。</span><span class="sxs-lookup"><span data-stu-id="f6846-203"><xref:System.Windows.Forms.DataGridView> methods that operate on rows take row index arguments rather than row instances.</span></span> <span data-ttu-id="f6846-204">此外，与行相关的事件处理程序收到具有可用于操作而不会导致它们成为非共享行的行的行属性的事件参数对象。</span><span class="sxs-lookup"><span data-stu-id="f6846-204">Additionally, handlers for row-related events receive event argument objects with row properties that you can use to manipulate rows without causing them to become unshared.</span></span>  
  
-   <span data-ttu-id="f6846-205">如果需要访问行对象，使用<xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType>方法并传入行的实际索引。</span><span class="sxs-lookup"><span data-stu-id="f6846-205">If you need to access a row object, use the <xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> method and pass in the row's actual index.</span></span> <span data-ttu-id="f6846-206">但是，请注意，修改通过此方法检索到一个共享的行对象，将修改共享此对象的所有行。</span><span class="sxs-lookup"><span data-stu-id="f6846-206">Note, however, that modifying a shared row object retrieved through this method will modify all the rows that share this object.</span></span> <span data-ttu-id="f6846-207">用于新记录的行不与共享其他行，但是，因此它不会受到影响时修改任何其他行。</span><span class="sxs-lookup"><span data-stu-id="f6846-207">The row for new records is not shared with other rows, however, so it will not be affected when you modify any other row.</span></span> <span data-ttu-id="f6846-208">另请注意共享行所表示的不同行可能有不同的快捷方式菜单。</span><span class="sxs-lookup"><span data-stu-id="f6846-208">Note also that different rows represented by a shared row may have different shortcut menus.</span></span> <span data-ttu-id="f6846-209">若要从共享的行实例中检索正确的快捷菜单，请使用<xref:System.Windows.Forms.DataGridViewRow.GetContextMenuStrip%2A>方法并传入行的实际索引。</span><span class="sxs-lookup"><span data-stu-id="f6846-209">To retrieve the correct shortcut menu from a shared row instance, use the <xref:System.Windows.Forms.DataGridViewRow.GetContextMenuStrip%2A> method and pass in the row's actual index.</span></span> <span data-ttu-id="f6846-210">如果访问共享的行<xref:System.Windows.Forms.DataGridViewRow.ContextMenuStrip%2A>属性相反，它将使用共享的行索引-1 并将不检索正确的快捷菜单。</span><span class="sxs-lookup"><span data-stu-id="f6846-210">If you access the shared row's <xref:System.Windows.Forms.DataGridViewRow.ContextMenuStrip%2A> property instead, it will use the shared row index of -1 and will not retrieve the correct shortcut menu.</span></span>  
  
-   <span data-ttu-id="f6846-211">避免索引<xref:System.Windows.Forms.DataGridViewRow.Cells%2A?displayProperty=nameWithType>集合。</span><span class="sxs-lookup"><span data-stu-id="f6846-211">Avoid indexing the <xref:System.Windows.Forms.DataGridViewRow.Cells%2A?displayProperty=nameWithType> collection.</span></span> <span data-ttu-id="f6846-212">直接访问一个单元格将导致其父行取消共享，并实例化新<xref:System.Windows.Forms.DataGridViewRow>。</span><span class="sxs-lookup"><span data-stu-id="f6846-212">Accessing a cell directly will cause its parent row to become unshared, instantiating a new <xref:System.Windows.Forms.DataGridViewRow>.</span></span> <span data-ttu-id="f6846-213">与单元格相关的事件处理程序收到具有可用于对行执行操作而不会导致行变为非共享的单元属性的事件参数对象。</span><span class="sxs-lookup"><span data-stu-id="f6846-213">Handlers for cell-related events receive event argument objects with cell properties that you can use to manipulate cells without causing rows to become unshared.</span></span> <span data-ttu-id="f6846-214">此外可以使用<xref:System.Windows.Forms.DataGridView.CurrentCellAddress%2A>属性来检索当前的单元格的行和列索引而无需直接访问该单元格。</span><span class="sxs-lookup"><span data-stu-id="f6846-214">You can also use the <xref:System.Windows.Forms.DataGridView.CurrentCellAddress%2A> property to retrieve the row and column indexes of the current cell without accessing the cell directly.</span></span>  
  
-   <span data-ttu-id="f6846-215">避免基于单元格的选择模式。</span><span class="sxs-lookup"><span data-stu-id="f6846-215">Avoid cell-based selection modes.</span></span> <span data-ttu-id="f6846-216">这些模式使行成为非共享行。</span><span class="sxs-lookup"><span data-stu-id="f6846-216">These modes cause rows to become unshared.</span></span> <span data-ttu-id="f6846-217">与此相反，设置<xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType>属性设置为<xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType>或<xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="f6846-217">Instead, set the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property to <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>.</span></span>  
  
-   <span data-ttu-id="f6846-218">不处理<xref:System.Windows.Forms.DataGridViewRowCollection.CollectionChanged?displayProperty=nameWithType>或<xref:System.Windows.Forms.DataGridView.RowStateChanged?displayProperty=nameWithType>事件。</span><span class="sxs-lookup"><span data-stu-id="f6846-218">Do not handle the <xref:System.Windows.Forms.DataGridViewRowCollection.CollectionChanged?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridView.RowStateChanged?displayProperty=nameWithType> events.</span></span> <span data-ttu-id="f6846-219">这些事件会导致行变为非共享。</span><span class="sxs-lookup"><span data-stu-id="f6846-219">These events cause rows to become unshared.</span></span> <span data-ttu-id="f6846-220">此外，不要调用<xref:System.Windows.Forms.DataGridViewRowCollection.OnCollectionChanged%2A?displayProperty=nameWithType>或<xref:System.Windows.Forms.DataGridView.OnRowStateChanged%2A?displayProperty=nameWithType>引发这些事件的方法。</span><span class="sxs-lookup"><span data-stu-id="f6846-220">Also, do not call the <xref:System.Windows.Forms.DataGridViewRowCollection.OnCollectionChanged%2A?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridView.OnRowStateChanged%2A?displayProperty=nameWithType> methods, which raise these events.</span></span>  
  
-   <span data-ttu-id="f6846-221">不会访问<xref:System.Windows.Forms.DataGridView.SelectedCells%2A?displayProperty=nameWithType>集合时<xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType>属性值是<xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect>， <xref:System.Windows.Forms.DataGridViewSelectionMode.ColumnHeaderSelect>， <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect>，或<xref:System.Windows.Forms.DataGridViewSelectionMode.RowHeaderSelect>。</span><span class="sxs-lookup"><span data-stu-id="f6846-221">Do not access the <xref:System.Windows.Forms.DataGridView.SelectedCells%2A?displayProperty=nameWithType> collection when the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property value is <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect>, <xref:System.Windows.Forms.DataGridViewSelectionMode.ColumnHeaderSelect>, <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect>, or <xref:System.Windows.Forms.DataGridViewSelectionMode.RowHeaderSelect>.</span></span> <span data-ttu-id="f6846-222">这将导致所有所选的行变为非共享。</span><span class="sxs-lookup"><span data-stu-id="f6846-222">This causes all selected rows to become unshared.</span></span>  
  
-   <span data-ttu-id="f6846-223">不要调用<xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="f6846-223">Do not call the <xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="f6846-224">此方法会导致行成为非共享行。</span><span class="sxs-lookup"><span data-stu-id="f6846-224">This method can cause rows to become unshared.</span></span>  
  
-   <span data-ttu-id="f6846-225">不要调用<xref:System.Windows.Forms.DataGridView.SelectAll%2A?displayProperty=nameWithType>方法时<xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType>属性值是<xref:System.Windows.Forms.DataGridViewSelectionMode.CellSelect>。</span><span class="sxs-lookup"><span data-stu-id="f6846-225">Do not call the <xref:System.Windows.Forms.DataGridView.SelectAll%2A?displayProperty=nameWithType> method when the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property value is <xref:System.Windows.Forms.DataGridViewSelectionMode.CellSelect>.</span></span> <span data-ttu-id="f6846-226">这将导致所有行都成为非共享行。</span><span class="sxs-lookup"><span data-stu-id="f6846-226">This causes all rows to become unshared.</span></span>  
  
-   <span data-ttu-id="f6846-227">未设置<xref:System.Windows.Forms.DataGridViewCell.ReadOnly%2A>或<xref:System.Windows.Forms.DataGridViewCell.Selected%2A>到单元格的属性`false`时在其列中的相应属性设置为`true`。</span><span class="sxs-lookup"><span data-stu-id="f6846-227">Do not set the <xref:System.Windows.Forms.DataGridViewCell.ReadOnly%2A> or <xref:System.Windows.Forms.DataGridViewCell.Selected%2A> property of a cell to `false` when the corresponding property in its column is set to `true`.</span></span> <span data-ttu-id="f6846-228">这将导致所有行都成为非共享行。</span><span class="sxs-lookup"><span data-stu-id="f6846-228">This causes all rows to become unshared.</span></span>  
  
-   <span data-ttu-id="f6846-229">不会访问<xref:System.Windows.Forms.DataGridViewRowCollection.List%2A?displayProperty=nameWithType>属性。</span><span class="sxs-lookup"><span data-stu-id="f6846-229">Do not access the <xref:System.Windows.Forms.DataGridViewRowCollection.List%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="f6846-230">这将导致所有行都成为非共享行。</span><span class="sxs-lookup"><span data-stu-id="f6846-230">This causes all rows to become unshared.</span></span>  
  
-   <span data-ttu-id="f6846-231">不要调用`Sort(IComparer)`重载<xref:System.Windows.Forms.DataGridView.Sort%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="f6846-231">Do not call the `Sort(IComparer)` overload of the <xref:System.Windows.Forms.DataGridView.Sort%2A> method.</span></span> <span data-ttu-id="f6846-232">使用自定义比较器进行排序会导致所有行都成为非共享行。</span><span class="sxs-lookup"><span data-stu-id="f6846-232">Sorting with a custom comparer causes all rows to become unshared.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f6846-233">请参阅</span><span class="sxs-lookup"><span data-stu-id="f6846-233">See also</span></span>
- <xref:System.Windows.Forms.DataGridView>
- [<span data-ttu-id="f6846-234">Windows 窗体 DataGridView 控件中的性能调整</span><span class="sxs-lookup"><span data-stu-id="f6846-234">Performance Tuning in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/performance-tuning-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="f6846-235">Windows 窗体 DataGridView 控件中的虚拟模式</span><span class="sxs-lookup"><span data-stu-id="f6846-235">Virtual Mode in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/virtual-mode-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="f6846-236">Windows 窗体 DataGridView 控件中的数据显示模式</span><span class="sxs-lookup"><span data-stu-id="f6846-236">Data Display Modes in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/data-display-modes-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="f6846-237">Windows 窗体 DataGridView 控件中的单元格样式</span><span class="sxs-lookup"><span data-stu-id="f6846-237">Cell Styles in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/cell-styles-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="f6846-238">如何：设置 Windows 窗体 DataGridView 控件的默认单元格样式</span><span class="sxs-lookup"><span data-stu-id="f6846-238">How to: Set Default Cell Styles for the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="f6846-239">Windows 窗体 DataGridView 控件中的重设大小选项</span><span class="sxs-lookup"><span data-stu-id="f6846-239">Sizing Options in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/sizing-options-in-the-windows-forms-datagridview-control.md)
