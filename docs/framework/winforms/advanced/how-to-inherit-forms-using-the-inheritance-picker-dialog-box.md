---
title: 如何：使用“继承选择器”对话框继承窗体
ms.date: 03/30/2017
helpviewer_keywords:
- inheritance [Windows Forms], forms
- Inheritance Picker dialog box
- inherited forms [Windows Forms], creating
ms.assetid: 969b4c04-12aa-4297-93a2-0ae747447823
ms.openlocfilehash: 5ae1c236835141b10bc704cd39f55de6e3e974b0
ms.sourcegitcommit: 558d78d2a68acd4c95ef23231c8b4e4c7bac3902
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/09/2019
ms.locfileid: "59342084"
---
# <a name="how-to-inherit-forms-using-the-inheritance-picker-dialog-box"></a><span data-ttu-id="a5a8d-102">如何：使用“继承选择器”对话框继承窗体</span><span class="sxs-lookup"><span data-stu-id="a5a8d-102">How to: Inherit Forms Using the Inheritance Picker Dialog Box</span></span>
<span data-ttu-id="a5a8d-103">继承窗体或其他对象最简单的方法是使用“继承选择器”对话框。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-103">The easiest way to inherit a form or other object is to use the **Inheritance Picker** dialog box.</span></span> <span data-ttu-id="a5a8d-104">通过该对话框，可以充分利用在其他解决方案中创建的代码或用户界面 (UI)。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-104">With it, you can take advantage of code or user interfaces (UI) you have already created in other solutions.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a5a8d-105">若要使用“继承选择器”对话框继承窗体，必须先将包含该窗体的项目生成到可执行文件或 DLL 中。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-105">In order to inherit from a form with the **Inheritance Picker** dialog box, the project containing that form must have been built into an executable file or DLL.</span></span> <span data-ttu-id="a5a8d-106">若要生成项目，请从“生成”菜单选择“生成解决方案”。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-106">To build the project, choose **Build Solution** from the **Build** menu.</span></span>  
>   
>  <span data-ttu-id="a5a8d-107">显示的对话框和菜单命令可能会与“帮助”中的描述不同，具体取决于你现用的设置或版本。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-107">The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition.</span></span> <span data-ttu-id="a5a8d-108">若要更改设置，请在 **“工具”** 菜单上选择 **“导入和导出设置”** 。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-108">To change your settings, choose **Import and Export Settings** on the **Tools** menu.</span></span> <span data-ttu-id="a5a8d-109">有关详细信息，请参阅[个性化设置 Visual Studio IDE](/visualstudio/ide/personalizing-the-visual-studio-ide)。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-109">For more information, see [Personalize the Visual Studio IDE](/visualstudio/ide/personalizing-the-visual-studio-ide).</span></span>  
  
### <a name="to-create-a-windows-form-inherited-from-an-existing-form-by-using-the-inheritance-picker"></a><span data-ttu-id="a5a8d-110">通过使用继承选择器创建继承自现有窗体的 Windows 窗体</span><span class="sxs-lookup"><span data-stu-id="a5a8d-110">To create a Windows Form inherited from an existing form by using the Inheritance Picker</span></span>  
  
1. <span data-ttu-id="a5a8d-111">从“项目”菜单中，选择“添加 Windows 窗体”。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-111">From the **Project** menu, choose **Add Windows Form**.</span></span>  
  
     <span data-ttu-id="a5a8d-112">此时将打开“添加新项”对话框。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-112">The **Add New Item** dialog box opens.</span></span>  
  
2. <span data-ttu-id="a5a8d-113">搜索**继承的窗体**模板从 searchbox 或通过单击**Windows 窗体**类别中，选择它，并将其在命名**名称**框。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-113">Search the **Inherited Form** template either from the searchbox or by clicking on the **Windows Forms** category, select it, and name it in the **Name** box.</span></span> <span data-ttu-id="a5a8d-114">单击“添加”按钮继续。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-114">Click the **Add** button to proceed.</span></span>  
  
     <span data-ttu-id="a5a8d-115">此时将打开“继承选择器”。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-115">The **Inheritance Picker** dialog box opens.</span></span> <span data-ttu-id="a5a8d-116">如果当前项目已经包含窗体，则它们将显示在“继承选择器”对话框中。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-116">If the current project already contains forms, they are displayed in the **Inheritance Picker** dialog box.</span></span>  
  
3. <span data-ttu-id="a5a8d-117">若要继承另一个程序集中的窗体，请单击“浏览”按钮。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-117">To inherit from a form in another assembly, click the **Browse** button.</span></span>  
  
4. <span data-ttu-id="a5a8d-118">在“选择包含要继承组件的文件”对话框中，导航到包含所需窗体或模块的项目。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-118">Within the **Select a file which contains a component to inherit from** dialog box, navigate to the project containing the form or module you desire.</span></span>  
  
5. <span data-ttu-id="a5a8d-119">单击 .exe 或 .dll 文件的名称以选中该文件，然后单击“打开”按钮。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-119">Click the name of the .exe or .dll file to select it and click the **Open** button.</span></span>  
  
     <span data-ttu-id="a5a8d-120">此操作将返回到“继承选择器”对话框，对话框中现在列出了组件及组件所在的项目。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-120">This returns you to the **Inheritance Picker** dialog box, where the component is now listed, along with the project in which it is located.</span></span>  
  
6. <span data-ttu-id="a5a8d-121">选择组件。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-121">Select the component.</span></span>  
  
     <span data-ttu-id="a5a8d-122">在“解决方案资源管理器”中，将组件添加到项目。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-122">In **Solution Explorer**, the component is added to your project.</span></span> <span data-ttu-id="a5a8d-123">如果它具有 UI，将用标志符号标记属于继承窗体的控件 (![的 Visual Basic 继承符号。 屏幕截图](./media/how-to-inherit-forms-using-the-inheritance-picker-dialog-box/visual-basic-inheritance-glyph.gif))，并选中时，有一个边框指示的控件具有的安全级别超类窗体。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-123">If it has a UI, controls that are part of the inherited form will be marked with a glyph (![Screenshot of the Visual Basic inheritance symbol.](./media/how-to-inherit-forms-using-the-inheritance-picker-dialog-box/visual-basic-inheritance-glyph.gif)), and, when selected, have a border indicating the level of security that the control has on the superclassed form.</span></span> <span data-ttu-id="a5a8d-124">下表中列出了与不同安全级别相对应的行为。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-124">The behaviors that correspond to the different security levels are listed in the table below.</span></span>  
  
    |<span data-ttu-id="a5a8d-125">控件的安全级别</span><span class="sxs-lookup"><span data-stu-id="a5a8d-125">Security level of control</span></span>|<span data-ttu-id="a5a8d-126">可以通过设计器和代码编辑器与继承的窗体进行的交互</span><span class="sxs-lookup"><span data-stu-id="a5a8d-126">Available interaction through Designer and Code Editor with Inherited Form</span></span>|  
    |-------------------------------|--------------------------------------------------------------------------------|  
    |<span data-ttu-id="a5a8d-127">Public</span><span class="sxs-lookup"><span data-stu-id="a5a8d-127">Public</span></span>|<span data-ttu-id="a5a8d-128">带有大小调整控点的标准边框：可以调整控件大小和移动控件。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-128">Standard border with sizing handles: control may be sized and moved.</span></span> <span data-ttu-id="a5a8d-129">控件可以由声明它的类进行内部访问，也可由其他类进行外部访问。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-129">The control can be accessed internally by the class which declares it and externally by other classes.</span></span>|  
    |<span data-ttu-id="a5a8d-130">Protected</span><span class="sxs-lookup"><span data-stu-id="a5a8d-130">Protected</span></span>|<span data-ttu-id="a5a8d-131">带有大小调整控点的标准边框：可以调整控件大小和移动控件。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-131">Standard border with sizing handles: control may be sized and moved.</span></span> <span data-ttu-id="a5a8d-132">可以由声明它的类和任何继承自父类的类进行内部访问，但不能由外部类进行访问。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-132">Can be accessed internally by the class that declares it and any class that inherits from the parent class, but cannot be accessed by external classes.</span></span>|  
    |<span data-ttu-id="a5a8d-133">Protected Internal（Visual Basic 中为 Protected Friend）</span><span class="sxs-lookup"><span data-stu-id="a5a8d-133">Protected Internal (Protected Friend in Visual Basic)</span></span>|<span data-ttu-id="a5a8d-134">带有大小调整控点的标准边框：可以调整控件大小和移动控件。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-134">Standard border with sizing handles: control may be sized and moved.</span></span> <span data-ttu-id="a5a8d-135">可以由声明它的类、任何继承自父类的类以及包含它的程序集的其他成员进行内部访问。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-135">Can be accessed internally by the class that declares it, by any class that inherits from the parent class, and by other members of the assembly that contains it.</span></span>|  
    |<span data-ttu-id="a5a8d-136">Internal（Visual Basic 中为 Friend）</span><span class="sxs-lookup"><span data-stu-id="a5a8d-136">Internal (Friend in Visual Basic)</span></span>|<span data-ttu-id="a5a8d-137">窗体上显示不带有大小句柄的标准边框，属性在“属性”窗口中可见。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-137">Standard border with no sizing handles, shown on the form, properties visible in **Properties** window.</span></span> <span data-ttu-id="a5a8d-138">但是，该控件的所有方面都将考虑为只读。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-138">However, all aspects of the control will be considered read-only.</span></span> <span data-ttu-id="a5a8d-139">无法对控件进行移动、调整大小或更改其属性。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-139">You cannot move or size the control, or change its properties.</span></span> <span data-ttu-id="a5a8d-140">如果控件是其他控件的容器（例如分组框），则无法添加新控件，也无法移除现有控件，即使那些控件是 public 控件。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-140">If the control is a container of other controls, like a group box, new controls cannot be added and existing controls cannot be removed, even if those controls were public.</span></span> <span data-ttu-id="a5a8d-141">此控件只能由包含它的程序集的其他成员进行访问。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-141">The control can only be accessed by other members of the assembly that contains it.</span></span>|  
    |<span data-ttu-id="a5a8d-142">Private</span><span class="sxs-lookup"><span data-stu-id="a5a8d-142">Private</span></span>|<span data-ttu-id="a5a8d-143">窗体上显示不带有大小句柄的标准边框，属性在“属性”窗口中可见。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-143">Standard border with no sizing handles, shown on the form, properties visible in **Properties** window.</span></span> <span data-ttu-id="a5a8d-144">但是，该控件的所有方面都将考虑为只读。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-144">However, all aspects of the control will be considered read-only.</span></span> <span data-ttu-id="a5a8d-145">无法对控件进行移动、调整大小或更改其属性。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-145">You cannot move or size the control, or change its properties.</span></span> <span data-ttu-id="a5a8d-146">如果控件是其他控件的容器（例如分组框），则无法添加新控件，也无法移除现有控件，即使那些控件是 public 控件。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-146">If the control is a container of other controls, like a group box, new controls cannot be added and existing controls cannot be removed, even if those controls were public.</span></span> <span data-ttu-id="a5a8d-147">此控件只能由声明它的类进行访问。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-147">The control can only be accessed by the class that declares it.</span></span>|  
  
     <span data-ttu-id="a5a8d-148">若要了解如何更改基窗体的外观，请参阅[修改基窗体外观的效果](effects-of-modifying-base-form-appearance.md)。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-148">For information about how to alter a base form's appearance, see [Effects of Modifying a Base Form's Appearance](effects-of-modifying-base-form-appearance.md).</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="a5a8d-149">将继承的控件和组件与 Windows 窗体上的标准控件和组件组合到一起时，可能会与 Z 排序发生冲突。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-149">When you combine inherited controls and components with standard controls and components on Windows Forms, you might encounter conflicts with the z-ordering.</span></span> <span data-ttu-id="a5a8d-150">可通过修改 z 顺序纠正冲突，方法是单击“格式”菜单，指向“排序”，然后单击“置于顶层”或“置于底层”。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-150">You can correct this by modifying the z-order, which is done by clicking in the **Format** menu, pointing to **Order**, and then clicking **Bring To Front** or **Send To Back**.</span></span> <span data-ttu-id="a5a8d-151">控件的 z 顺序的详细信息，请参阅[如何：在 Windows 窗体上的对象分层](../controls/how-to-layer-objects-on-windows-forms.md)。</span><span class="sxs-lookup"><span data-stu-id="a5a8d-151">For more information about the z-order of controls, see [How to: Layer Objects on Windows Forms](../controls/how-to-layer-objects-on-windows-forms.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a5a8d-152">请参阅</span><span class="sxs-lookup"><span data-stu-id="a5a8d-152">See also</span></span>

- [<span data-ttu-id="a5a8d-153">Inherits Statement</span><span class="sxs-lookup"><span data-stu-id="a5a8d-153">Inherits Statement</span></span>](~/docs/visual-basic/language-reference/statements/inherits-statement.md)
- [<span data-ttu-id="a5a8d-154">using</span><span class="sxs-lookup"><span data-stu-id="a5a8d-154">using</span></span>](~/docs/csharp/language-reference/keywords/using.md)
- [<span data-ttu-id="a5a8d-155">修改基窗体的外观的效果</span><span class="sxs-lookup"><span data-stu-id="a5a8d-155">Effects of Modifying a Base Form's Appearance</span></span>](effects-of-modifying-base-form-appearance.md)
- [<span data-ttu-id="a5a8d-156">Windows 窗体可视化继承</span><span class="sxs-lookup"><span data-stu-id="a5a8d-156">Windows Forms Visual Inheritance</span></span>](windows-forms-visual-inheritance.md)
