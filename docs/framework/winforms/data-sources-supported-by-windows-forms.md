---
title: 支持的数据源
ms.date: 03/30/2017
helpviewer_keywords:
- collections [Windows Forms], binding to
- OLE DB providers [Windows Forms], Windows Forms
- DataTable class [Windows Forms], binding and Windows Forms
- Windows Forms, data binding
- DataView class [Windows Forms], binding and Windows Forms
- DataViewManager class [Windows Forms], binding and Windows Forms
- Windows Forms, source data
- arrays [Windows Forms]
- data sources [Windows Forms]
- data providers [Windows Forms]
- DataSet class [Windows Forms], binding and Windows Forms
- data [Windows Forms], data providers
ms.assetid: 3d2c43f6-462b-4d35-9c86-13e9afe012e1
ms.openlocfilehash: 83ce4bb0d6f0bf81bcad4e38af212dccc3483ca5
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/24/2020
ms.locfileid: "76742310"
---
# <a name="data-sources-supported-by-windows-forms"></a><span data-ttu-id="8657d-102">Windows 窗体支持的数据源</span><span class="sxs-lookup"><span data-stu-id="8657d-102">Data Sources Supported by Windows Forms</span></span>
<span data-ttu-id="8657d-103">通常，在应用程序中使用数据绑定来利用存储在数据库中的数据。</span><span class="sxs-lookup"><span data-stu-id="8657d-103">Traditionally, data binding has been used within applications to take advantage of data stored in databases.</span></span> <span data-ttu-id="8657d-104">使用 Windows 窗体数据绑定，只要满足某些最低要求，你就可以访问数据库中的数据以及其他结构中的数据（如数组和集合）。</span><span class="sxs-lookup"><span data-stu-id="8657d-104">With Windows Forms data binding, you can access data from databases as well as data in other structures, such as arrays and collections, so long as certain minimum requirements have been met.</span></span>  
  
## <a name="structures-to-bind-to"></a><span data-ttu-id="8657d-105">要绑定到的结构</span><span class="sxs-lookup"><span data-stu-id="8657d-105">Structures to Bind To</span></span>  
 <span data-ttu-id="8657d-106">在 Windows 窗体中，可以绑定到各种结构，从简单对象（简单绑定）到复杂列表，如 ADO.NET 数据表（复杂绑定）。</span><span class="sxs-lookup"><span data-stu-id="8657d-106">In Windows Forms, you can bind to a wide variety of structures, from simple objects (simple binding) to complex lists such as ADO.NET data tables (complex binding).</span></span> <span data-ttu-id="8657d-107">对于简单绑定，Windows 窗体支持绑定到简单对象上的公共属性。</span><span class="sxs-lookup"><span data-stu-id="8657d-107">For simple binding, Windows Forms supports binding to the public properties on the simple object.</span></span> <span data-ttu-id="8657d-108">Windows 窗体基于列表的绑定通常要求对象支持 <xref:System.Collections.IList> 接口或 <xref:System.ComponentModel.IListSource> 接口。</span><span class="sxs-lookup"><span data-stu-id="8657d-108">Windows Forms list-based binding generally requires that the object support the <xref:System.Collections.IList> interface or the <xref:System.ComponentModel.IListSource> interface.</span></span> <span data-ttu-id="8657d-109">此外，如果通过 <xref:System.Windows.Forms.BindingSource> 组件进行绑定，则可以绑定到支持 <xref:System.Collections.IEnumerable> 接口的对象。</span><span class="sxs-lookup"><span data-stu-id="8657d-109">Additionally, if you are binding with through a <xref:System.Windows.Forms.BindingSource> component, you can bind to an object that supports the <xref:System.Collections.IEnumerable> interface.</span></span> <span data-ttu-id="8657d-110">有关与数据绑定相关的接口的详细信息，请参阅与[数据绑定相关的接口](interfaces-related-to-data-binding.md)。</span><span class="sxs-lookup"><span data-stu-id="8657d-110">For more information about interfaces related to data binding, see [Interfaces Related to Data Binding](interfaces-related-to-data-binding.md).</span></span>  
  
 <span data-ttu-id="8657d-111">以下列表显示了可以在 Windows 窗体中绑定到的结构。</span><span class="sxs-lookup"><span data-stu-id="8657d-111">The following list shows the structures you can bind to in Windows Forms.</span></span>  
  
 <xref:System.Windows.Forms.BindingSource>  
 <span data-ttu-id="8657d-112"><xref:System.Windows.Forms.BindingSource> 是最常见的 Windows 窗体数据源，可在数据源和 Windows 窗体控件之间使用代理。</span><span class="sxs-lookup"><span data-stu-id="8657d-112">A <xref:System.Windows.Forms.BindingSource> is the most common Windows Forms data source and acts a proxy between a data source and Windows Forms controls.</span></span> <span data-ttu-id="8657d-113">常规 <xref:System.Windows.Forms.BindingSource> 使用模式是将控件绑定到 <xref:System.Windows.Forms.BindingSource> 并将 <xref:System.Windows.Forms.BindingSource> 绑定到数据源（例如 ADO.NET 数据表或业务对象）。</span><span class="sxs-lookup"><span data-stu-id="8657d-113">The general <xref:System.Windows.Forms.BindingSource> usage pattern is to bind your controls to the <xref:System.Windows.Forms.BindingSource> and bind the <xref:System.Windows.Forms.BindingSource> to the data source (for example, an ADO.NET data table or a business object).</span></span> <span data-ttu-id="8657d-114"><xref:System.Windows.Forms.BindingSource> 提供了一些服务，这些服务可实现和提高数据绑定支持的级别。</span><span class="sxs-lookup"><span data-stu-id="8657d-114">The <xref:System.Windows.Forms.BindingSource> provides services that enable and improve the level of data binding support.</span></span> <span data-ttu-id="8657d-115">例如，Windows 窗体基于列表的控件（如 <xref:System.Windows.Forms.DataGridView> 和 <xref:System.Windows.Forms.ComboBox>）不直接支持绑定到 <xref:System.Collections.IEnumerable> 数据源，但你可以通过绑定 <xref:System.Windows.Forms.BindingSource>来启用此方案。</span><span class="sxs-lookup"><span data-stu-id="8657d-115">For example, Windows Forms list based controls such as the <xref:System.Windows.Forms.DataGridView> and <xref:System.Windows.Forms.ComboBox> do not directly support binding to <xref:System.Collections.IEnumerable> data sources however, you can enable this scenario by binding through a <xref:System.Windows.Forms.BindingSource>.</span></span> <span data-ttu-id="8657d-116">在这种情况下，<xref:System.Windows.Forms.BindingSource> 会将数据源转换为 <xref:System.Collections.IList>。</span><span class="sxs-lookup"><span data-stu-id="8657d-116">In this case, the <xref:System.Windows.Forms.BindingSource> will convert the data source to an <xref:System.Collections.IList>.</span></span>  
  
 <span data-ttu-id="8657d-117">简单对象</span><span class="sxs-lookup"><span data-stu-id="8657d-117">Simple objects</span></span>  
 <span data-ttu-id="8657d-118">Windows 窗体使用 <xref:System.Windows.Forms.Binding> 类型对对象实例上的公共属性支持数据绑定控件属性。</span><span class="sxs-lookup"><span data-stu-id="8657d-118">Windows Forms supports data binding control properties to public properties on the instance of an object using the <xref:System.Windows.Forms.Binding> type.</span></span> <span data-ttu-id="8657d-119">Windows 窗体还支持绑定列表控件，例如在使用 <xref:System.Windows.Forms.BindingSource> 时，<xref:System.Windows.Forms.ListControl> 到对象实例。</span><span class="sxs-lookup"><span data-stu-id="8657d-119">Windows Forms also supports binding list based controls, such as a <xref:System.Windows.Forms.ListControl> to an object instance when a <xref:System.Windows.Forms.BindingSource> is used.</span></span>  
  
 <span data-ttu-id="8657d-120">数组或集合</span><span class="sxs-lookup"><span data-stu-id="8657d-120">array or collection</span></span>  
 <span data-ttu-id="8657d-121">若要作为数据源，列表必须实现 <xref:System.Collections.IList> 接口;一个示例是 <xref:System.Array> 类的实例。</span><span class="sxs-lookup"><span data-stu-id="8657d-121">To act as a data source, a list must implement the <xref:System.Collections.IList> interface; one example would be an array that is an instance of the <xref:System.Array> class.</span></span> <span data-ttu-id="8657d-122">有关数组的详细信息，请参阅[如何：创建对象数组（Visual Basic）](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/487y7874(v=vs.100))。</span><span class="sxs-lookup"><span data-stu-id="8657d-122">For more information on arrays, see [How to: Create an Array of Objects (Visual Basic)](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/487y7874(v=vs.100)).</span></span>  
  
 <span data-ttu-id="8657d-123">通常，为数据绑定创建对象列表时，应使用 <xref:System.ComponentModel.BindingList%601>。</span><span class="sxs-lookup"><span data-stu-id="8657d-123">In general, you should use <xref:System.ComponentModel.BindingList%601> when you create lists of objects for data binding.</span></span> <span data-ttu-id="8657d-124"><xref:System.ComponentModel.BindingList%601> 是 <xref:System.ComponentModel.IBindingList> 接口的泛型版本。</span><span class="sxs-lookup"><span data-stu-id="8657d-124"><xref:System.ComponentModel.BindingList%601> is a generic version of the <xref:System.ComponentModel.IBindingList> interface.</span></span> <span data-ttu-id="8657d-125"><xref:System.ComponentModel.IBindingList> 接口通过添加双向数据绑定所需的属性、方法和事件来扩展 <xref:System.Collections.IList> 接口。</span><span class="sxs-lookup"><span data-stu-id="8657d-125">The <xref:System.ComponentModel.IBindingList> interface extends the <xref:System.Collections.IList> interface by adding properties, methods and events necessary for two-way data binding.</span></span>  
  
 <xref:System.Collections.IEnumerable>  
 <span data-ttu-id="8657d-126">Windows 窗体控件可以绑定到仅支持 <xref:System.Collections.IEnumerable> 接口（如果它们通过 <xref:System.Windows.Forms.BindingSource> 组件绑定）的数据源。</span><span class="sxs-lookup"><span data-stu-id="8657d-126">Windows Forms controls can be bound to data sources that only support the <xref:System.Collections.IEnumerable> interface if they are bound through a <xref:System.Windows.Forms.BindingSource> component.</span></span>  
  
 <span data-ttu-id="8657d-127">ADO.NET 数据对象</span><span class="sxs-lookup"><span data-stu-id="8657d-127">ADO.NET data objects</span></span>  
 <span data-ttu-id="8657d-128">ADO.NET 提供了一些适合绑定到的数据结构。</span><span class="sxs-lookup"><span data-stu-id="8657d-128">ADO.NET provides a number of data structures suitable for binding to.</span></span> <span data-ttu-id="8657d-129">每个变量的复杂程度和复杂性各不相同。</span><span class="sxs-lookup"><span data-stu-id="8657d-129">Each varies in its sophistication and complexity.</span></span>  
  
- <span data-ttu-id="8657d-130"><xref:System.Data.DataColumn> 列中的一个值匹配。</span><span class="sxs-lookup"><span data-stu-id="8657d-130"><xref:System.Data.DataColumn>.</span></span> <span data-ttu-id="8657d-131"><xref:System.Data.DataColumn> 是 <xref:System.Data.DataTable>的基本构建基块，因为许多列包含一个表。</span><span class="sxs-lookup"><span data-stu-id="8657d-131">A <xref:System.Data.DataColumn> is the essential building block of a <xref:System.Data.DataTable>, in that a number of columns comprise a table.</span></span> <span data-ttu-id="8657d-132">每个 <xref:System.Data.DataColumn> 都有一个 <xref:System.Data.DataColumn.DataType%2A> 属性，该属性确定列包含的数据类型（例如，在描述汽车的表中创建汽车的类型）。</span><span class="sxs-lookup"><span data-stu-id="8657d-132">Each <xref:System.Data.DataColumn> has a <xref:System.Data.DataColumn.DataType%2A> property that determines the kind of data the column holds (for example, the make of an automobile in a table describing cars).</span></span> <span data-ttu-id="8657d-133">您可以简单地将控件（如 <xref:System.Windows.Forms.TextBox> 控件的 <xref:System.Windows.Forms.Control.Text%2A> 属性）绑定到数据表中的列。</span><span class="sxs-lookup"><span data-stu-id="8657d-133">You can simple-bind a control (such as a <xref:System.Windows.Forms.TextBox> control's <xref:System.Windows.Forms.Control.Text%2A> property) to a column within a data table.</span></span>  
  
- <span data-ttu-id="8657d-134"><xref:System.Data.DataTable> 列中的一个值匹配。</span><span class="sxs-lookup"><span data-stu-id="8657d-134"><xref:System.Data.DataTable>.</span></span> <span data-ttu-id="8657d-135"><xref:System.Data.DataTable> 是 ADO.NET 中具有行和列的表的表示形式。</span><span class="sxs-lookup"><span data-stu-id="8657d-135">A <xref:System.Data.DataTable> is the representation of a table, with rows and columns, in ADO.NET.</span></span> <span data-ttu-id="8657d-136">数据表包含两个集合： <xref:System.Data.DataColumn>，表示给定表中的数据列（最终确定可输入到该表中的数据类型）和 <xref:System.Data.DataRow>，表示给定表中的数据行。</span><span class="sxs-lookup"><span data-stu-id="8657d-136">A data table contains two collections: <xref:System.Data.DataColumn>, representing the columns of data in a given table (which ultimately determine the kinds of data that can be entered into that table), and <xref:System.Data.DataRow>, representing the rows of data in a given table.</span></span> <span data-ttu-id="8657d-137">您可以将控件复杂地绑定到数据表中包含的信息（例如，将 <xref:System.Windows.Forms.DataGridView> 控件绑定到数据表）。</span><span class="sxs-lookup"><span data-stu-id="8657d-137">You can complex-bind a control to the information contained in a data table (such as binding the <xref:System.Windows.Forms.DataGridView> control to a data table).</span></span> <span data-ttu-id="8657d-138">但是，当您绑定到 <xref:System.Data.DataTable>时，实际上就是绑定到表的默认视图。</span><span class="sxs-lookup"><span data-stu-id="8657d-138">However, when you bind to a <xref:System.Data.DataTable>, you are a really binding to the table's default view.</span></span>  
  
- <span data-ttu-id="8657d-139"><xref:System.Data.DataView> 列中的一个值匹配。</span><span class="sxs-lookup"><span data-stu-id="8657d-139"><xref:System.Data.DataView>.</span></span> <span data-ttu-id="8657d-140"><xref:System.Data.DataView> 是可以进行筛选或排序的单个数据表的自定义视图。</span><span class="sxs-lookup"><span data-stu-id="8657d-140">A <xref:System.Data.DataView> is a customized view of a single data table that may be filtered or sorted.</span></span> <span data-ttu-id="8657d-141">数据视图是复杂绑定控件使用的数据 "快照"。</span><span class="sxs-lookup"><span data-stu-id="8657d-141">A data view is the data "snapshot" used by complex-bound controls.</span></span> <span data-ttu-id="8657d-142">您可以简单绑定或复杂地绑定到数据视图中的数据，但请注意，您要绑定到数据的固定 "图片"，而不是清除、更新数据源。</span><span class="sxs-lookup"><span data-stu-id="8657d-142">You can simple-bind or complex-bind to the data within a data view, but be aware that you are binding to a fixed "picture" of the data rather than a clean, updating data source.</span></span>  
  
- <span data-ttu-id="8657d-143"><xref:System.Data.DataSet> 列中的一个值匹配。</span><span class="sxs-lookup"><span data-stu-id="8657d-143"><xref:System.Data.DataSet>.</span></span> <span data-ttu-id="8657d-144">"<xref:System.Data.DataSet>" 是指数据库中数据的表、关系和约束的集合。</span><span class="sxs-lookup"><span data-stu-id="8657d-144">A <xref:System.Data.DataSet> is a collection of tables, relationships, and constraints of the data in a database.</span></span> <span data-ttu-id="8657d-145">您可以简单地绑定或复杂绑定到数据集中的数据，但请注意，您要绑定到 <xref:System.Data.DataSet> 的默认 <xref:System.Data.DataViewManager> （请参阅下一个项目符号）。</span><span class="sxs-lookup"><span data-stu-id="8657d-145">You can simple-bind or complex-bind to the data within a dataset, but be aware that you are binding to the default <xref:System.Data.DataViewManager> for the <xref:System.Data.DataSet> (see the next bullet point).</span></span>  
  
- <span data-ttu-id="8657d-146"><xref:System.Data.DataViewManager> 列中的一个值匹配。</span><span class="sxs-lookup"><span data-stu-id="8657d-146"><xref:System.Data.DataViewManager>.</span></span> <span data-ttu-id="8657d-147"><xref:System.Data.DataViewManager> 是整个 <xref:System.Data.DataSet>的自定义视图，与 <xref:System.Data.DataView>相似，但包含关系。</span><span class="sxs-lookup"><span data-stu-id="8657d-147">A <xref:System.Data.DataViewManager> is a customized view of the entire <xref:System.Data.DataSet>, analogous to a <xref:System.Data.DataView>, but with relations included.</span></span> <span data-ttu-id="8657d-148">使用 <xref:System.Data.DataViewManager.DataViewSettings%2A> 集合，可以为给定表的 <xref:System.Data.DataViewManager> 的任何视图设置默认筛选器和排序选项。</span><span class="sxs-lookup"><span data-stu-id="8657d-148">With a <xref:System.Data.DataViewManager.DataViewSettings%2A> collection, you can set default filters and sort options for any views that the <xref:System.Data.DataViewManager> has for a given table.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8657d-149">另请参阅</span><span class="sxs-lookup"><span data-stu-id="8657d-149">See also</span></span>

- [<span data-ttu-id="8657d-150">Windows 窗体数据绑定中的更改通知</span><span class="sxs-lookup"><span data-stu-id="8657d-150">Change Notification in Windows Forms Data Binding</span></span>](change-notification-in-windows-forms-data-binding.md)
- [<span data-ttu-id="8657d-151">数据绑定和 Windows 窗体</span><span class="sxs-lookup"><span data-stu-id="8657d-151">Data Binding and Windows Forms</span></span>](data-binding-and-windows-forms.md)
- [<span data-ttu-id="8657d-152">Windows 窗体数据绑定</span><span class="sxs-lookup"><span data-stu-id="8657d-152">Windows Forms Data Binding</span></span>](windows-forms-data-binding.md)
