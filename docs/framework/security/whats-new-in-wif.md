---
title: Windows Identity Foundation 4.5 中的新增功能
ms.date: 03/30/2017
ms.assetid: 3b381f04-593b-471f-bd33-0362be1aade5
author: BrucePerlerMS
ms.openlocfilehash: 9009f3bd6e782aefdeca0f071dc70d6247c3987b
ms.sourcegitcommit: 14355b4b2fe5bcf874cac96d0a9e6376b567e4c7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/30/2019
ms.locfileid: "55275413"
---
# <a name="whats-new-in-windows-identity-foundation-45"></a><span data-ttu-id="e3740-102">Windows Identity Foundation 4.5 中的新增功能</span><span class="sxs-lookup"><span data-stu-id="e3740-102">What's New in Windows Identity Foundation 4.5</span></span>
<span data-ttu-id="e3740-103">Windows Identity Foundation (WIF) 的首个版本是作为单独的下载文件而发布的，因为在 .NET 3.5 SP1 期间推出，所以称为 WIF 3.5。</span><span class="sxs-lookup"><span data-stu-id="e3740-103">The first version of Windows Identity Foundation (WIF) shipped as a standalone download and is known as WIF 3.5 because it was introduced in the .NET 3.5 SP1 timeframe.</span></span> <span data-ttu-id="e3740-104">从 .NET 4.5 开始，WIF 便成为 .NET Framework 的一部分。</span><span class="sxs-lookup"><span data-stu-id="e3740-104">Starting with .NET 4.5, WIF is part of the .NET framework.</span></span> <span data-ttu-id="e3740-105">通过使 WIF 类直接在框架中可用，可以在 .NET 中更深度地集成基于声明的标识，从而更轻松地使用声明。</span><span class="sxs-lookup"><span data-stu-id="e3740-105">Having the WIF classes directly available in the framework allows for a much deeper integration of claims-based identity in .NET, making it easier to use claims.</span></span> <span data-ttu-id="e3740-106">针对 WIF 3.5 而编写的应用程序需要进行修改才能利用新模型；有关信息，请参阅[使用 WIF 3.5 至 WIF 4.5 构建的应用程序的迁移指南](../../../docs/framework/security/guidelines-for-migrating-an-application-built-using-wif-3-5-to-wif-4-5.md)。</span><span class="sxs-lookup"><span data-stu-id="e3740-106">Applications written for WIF 3.5 will need to be modified in order to take advantage of the new model; for information, see [Guidelines for Migrating an Application Built Using WIF 3.5 to WIF 4.5](../../../docs/framework/security/guidelines-for-migrating-an-application-built-using-wif-3-5-to-wif-4-5.md).</span></span>  
  
 <span data-ttu-id="e3740-107">在下文中，你可以发现一些突出的主要更改。</span><span class="sxs-lookup"><span data-stu-id="e3740-107">Below you can find some highlights of the main changes.</span></span>  
  
## <a name="wif-is-now-part-of-the-net-framework"></a><span data-ttu-id="e3740-108">WIF 现在是 .NET Framework 的一部分</span><span class="sxs-lookup"><span data-stu-id="e3740-108">WIF Is Now Part of the .NET Framework</span></span>  
 <span data-ttu-id="e3740-109">WIF 类现在涵盖多个程序集，主要包括 `mscorlib`、`System.IdentityModel`、`System.IdentityModel.Services` 和 `System.ServiceModel`。</span><span class="sxs-lookup"><span data-stu-id="e3740-109">WIF classes are now spread across several assemblies, the main ones being `mscorlib`, `System.IdentityModel`, `System.IdentityModel.Services`, and `System.ServiceModel`.</span></span> <span data-ttu-id="e3740-110">同样，WIF 类涵盖多个命名空间：<xref:System.Security.Claims?displayProperty=nameWithType>、多个 [System.IdentityModel](https://go.microsoft.com/fwlink/?LinkId=272004) 命名空间，以及 <xref:System.ServiceModel.Security?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="e3740-110">Likewise, the WIF classes are spread across several namespaces: <xref:System.Security.Claims?displayProperty=nameWithType>, several [System.IdentityModel](https://go.microsoft.com/fwlink/?LinkId=272004) namespaces, and <xref:System.ServiceModel.Security?displayProperty=nameWithType>.</span></span> <span data-ttu-id="e3740-111"><xref:System.Security.Claims?displayProperty=nameWithType> 命名空间包含新的 <xref:System.Security.Claims.ClaimsPrincipal> 和 <xref:System.Security.Claims.ClaimsIdentity> 类（请参阅下文）。</span><span class="sxs-lookup"><span data-stu-id="e3740-111">The <xref:System.Security.Claims?displayProperty=nameWithType> namespace contains the new <xref:System.Security.Claims.ClaimsPrincipal> and <xref:System.Security.Claims.ClaimsIdentity> classes (see below).</span></span> <span data-ttu-id="e3740-112">.NET 中的所有主体现在均派生自 <xref:System.Security.Claims.ClaimsPrincipal>。</span><span class="sxs-lookup"><span data-stu-id="e3740-112">All principals in .NET now derive from <xref:System.Security.Claims.ClaimsPrincipal>.</span></span> <span data-ttu-id="e3740-113">有关 WIF 命名空间及其包含的类种类的详细信息，请参阅 [WIF API 参考](../../../docs/framework/security/wif-api-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="e3740-113">For more detailed information about the WIF namespaces and the kinds of classes that they contain, see [WIF API Reference](../../../docs/framework/security/wif-api-reference.md).</span></span> <span data-ttu-id="e3740-114">有关 WIF 3.5 和 WIF 4.5 之间命名空间映射方式的信息，请参阅 [WIF 3.5 和 WIF 4.5 之间的命名空间映射](../../../docs/framework/security/namespace-mapping-between-wif-3-5-and-wif-4-5.md)。</span><span class="sxs-lookup"><span data-stu-id="e3740-114">For information about how namespaces map between WIF 3.5 and WIF 4.5, see [Namespace Mapping between WIF 3.5 and WIF 4.5](../../../docs/framework/security/namespace-mapping-between-wif-3-5-and-wif-4-5.md).</span></span>  
  
## <a name="new-claims-model-and-principal-object"></a><span data-ttu-id="e3740-115">新声明模型和主体对象</span><span class="sxs-lookup"><span data-stu-id="e3740-115">New Claims Model and Principal Object</span></span>  
 <span data-ttu-id="e3740-116">声明是 .NET Framework 4.5 的核心所在。</span><span class="sxs-lookup"><span data-stu-id="e3740-116">Claims are at the very core of the .NET Framework 4.5.</span></span> <span data-ttu-id="e3740-117">基声明类（<xref:System.Security.Claims.Claim>、<xref:System.Security.Claims.ClaimsIdentity>、<xref:System.Security.Claims.ClaimsPrincipal>、<xref:System.Security.Claims.ClaimTypes> 和 <xref:System.Security.Claims.ClaimValueTypes>）全部直接存在于 `mscorlib` 命名空间的 <xref:System.Security.Claims?displayProperty=nameWithType> 中。</span><span class="sxs-lookup"><span data-stu-id="e3740-117">The base claim classes (<xref:System.Security.Claims.Claim>, <xref:System.Security.Claims.ClaimsIdentity>, <xref:System.Security.Claims.ClaimsPrincipal>, <xref:System.Security.Claims.ClaimTypes>, and <xref:System.Security.Claims.ClaimValueTypes>) all live directly in `mscorlib` in the <xref:System.Security.Claims?displayProperty=nameWithType> namespace.</span></span> <span data-ttu-id="e3740-118">现在已不再需要使用接口来将声明插入到 .NET 标识系统中：<xref:System.Security.Principal.WindowsPrincipal>、<xref:System.Security.Principal.GenericPrincipal> 和 <xref:System.Web.Security.RolePrincipal> 现在继承自 <xref:System.Security.Claims.ClaimsPrincipal>；而 <xref:System.Security.Principal.WindowsIdentity>、<xref:System.Security.Principal.GenericIdentity> 和 <xref:System.Web.Security.FormsIdentity> 现在继承自 <xref:System.Security.Claims.ClaimsIdentity>。</span><span class="sxs-lookup"><span data-stu-id="e3740-118">It is no longer necessary to use interfaces in order to plug claims into the .NET identity system: <xref:System.Security.Principal.WindowsPrincipal>, <xref:System.Security.Principal.GenericPrincipal>, and <xref:System.Web.Security.RolePrincipal> now inherit from <xref:System.Security.Claims.ClaimsPrincipal>; and <xref:System.Security.Principal.WindowsIdentity>, <xref:System.Security.Principal.GenericIdentity>, and <xref:System.Web.Security.FormsIdentity> now inherit from <xref:System.Security.Claims.ClaimsIdentity>.</span></span> <span data-ttu-id="e3740-119">简言之，每个主体类现在都服务于声明。</span><span class="sxs-lookup"><span data-stu-id="e3740-119">In short, every principal class will now serve claims.</span></span> <span data-ttu-id="e3740-120">因此，WIF 3.5 集成类和接口（`WindowsClaimsIdentity`、`WindowsClaimsPrincipal`、`IClaimsPrincipal`、`IClaimsIdentity`）现在已被移除。</span><span class="sxs-lookup"><span data-stu-id="e3740-120">The WIF 3.5 integration classes and interfaces (`WindowsClaimsIdentity`, `WindowsClaimsPrincipal`, `IClaimsPrincipal`, `IClaimsIdentity`) have thus been removed.</span></span> <span data-ttu-id="e3740-121">此外，<xref:System.Security.Claims.ClaimsIdentity> 类现在已将方法公开，以便更轻松地查询标识的声明集合。</span><span class="sxs-lookup"><span data-stu-id="e3740-121">In addition, the <xref:System.Security.Claims.ClaimsIdentity> class now exposes methods which make it easier to query the identity’s claims collection.</span></span>  
  
## <a name="changes-to-the-wif-45-visual-studio-experience"></a><span data-ttu-id="e3740-122">WIF 4.5 Visual Studio 体验方面的更改</span><span class="sxs-lookup"><span data-stu-id="e3740-122">Changes to the WIF 4.5 Visual Studio Experience</span></span>  
  
-   <span data-ttu-id="e3740-123">**添加 STS 引用…**</span><span class="sxs-lookup"><span data-stu-id="e3740-123">The **Add STS Reference …**</span></span> <span data-ttu-id="e3740-124">Visual Studio 功能（命令行实用工具 FedUtil）已不存在；现在，可以使用新的 Visual Studio 扩展：用于 Visual Studio 2012 标识和访问工具。</span><span class="sxs-lookup"><span data-stu-id="e3740-124">Visual Studio functionality (cmdline utility FedUtil) no longer exists; instead you can use the new Visual Studio extension **Identity and Access Tool for Visual Studio 2012**.</span></span> <span data-ttu-id="e3740-125">这可以让你与现有 STS 联合，或使用 LocalSTS 来测试你的解决方案。</span><span class="sxs-lookup"><span data-stu-id="e3740-125">This allows you to federate with an existing STS or use LocalSTS to test your solutions.</span></span> <span data-ttu-id="e3740-126">在安装此扩展后，你可以右击项目并在上下文菜单中查找“标识和访问”。</span><span class="sxs-lookup"><span data-stu-id="e3740-126">After installing the extension you can right-click on your project and look for **Identity and Access** in the context menu.</span></span>  
  
-   <span data-ttu-id="e3740-127">ASP.NET 和 STS 模板不再作为声明提供，可以直接在 ASP.NET、网站和 WCF 的现有项目模板中使用。</span><span class="sxs-lookup"><span data-stu-id="e3740-127">The ASP.NET and STS templates are no longer provided as claims can be used directly in existing project templates for ASP.Net, web sites, and WCF.</span></span>  
  
-   <span data-ttu-id="e3740-128">`Microsoft.IdentityModel.Web.Controls` 命名空间中的控件（`SignInControl`、`FederatedPassiveSignInControl` 和 `FederatedPassiveSignInStatus`）不会转入到 WIF 4.5 中。</span><span class="sxs-lookup"><span data-stu-id="e3740-128">The controls in the `Microsoft.IdentityModel.Web.Controls` namespace (`SignInControl`, `FederatedPassiveSignInControl`, and `FederatedPassiveSignInStatus`) are not carried over into WIF 4.5.</span></span>  
  
## <a name="changes-to-the-wif-45-api"></a><span data-ttu-id="e3740-129">WIF 4.5 API 的更改</span><span class="sxs-lookup"><span data-stu-id="e3740-129">Changes to the WIF 4.5 API</span></span>  
  
-   <span data-ttu-id="e3740-130">通常，与声明相关的类位于 <xref:System.Security.Claims?displayProperty=nameWithType> 命名空间中；与 WCF 相关的类（服务协定、通道、通道工厂以及用于 WS-Trust 方案的服务主机）位于 <xref:System.ServiceModel.Security?displayProperty=nameWithType> 中；而所有其他 WIF 类分布于各个 [System.IdentityModel](https://go.microsoft.com/fwlink/?LinkId=272004) 命名空间，其中包括表示 WS-\* 和 SAML 项目的类、令牌处理程序和相关类，以及用于 WS 联合身份验证方案的类。</span><span class="sxs-lookup"><span data-stu-id="e3740-130">In general, claims related classes are in the <xref:System.Security.Claims?displayProperty=nameWithType> namespace; WCF related classes –- service contracts, channels, channel factories, and service hosts that are used for WS-Trust scenarios -- are in <xref:System.ServiceModel.Security?displayProperty=nameWithType>; and all other WIF classes are spread across various [System.IdentityModel](https://go.microsoft.com/fwlink/?LinkId=272004) namespaces – these include, for example, classes that represent WS-\* and SAML artifacts, token handlers and related classes, and classes used in WS-Federation scenarios.</span></span> <span data-ttu-id="e3740-131">有关更多信息，请参阅 [WIF 3.5 和 WIF 4.5 之间的命名空间映射](../../../docs/framework/security/namespace-mapping-between-wif-3-5-and-wif-4-5.md)和 [WIF API 参考](../../../docs/framework/security/wif-api-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="e3740-131">For more information, see [Namespace Mapping between WIF 3.5 and WIF 4.5](../../../docs/framework/security/namespace-mapping-between-wif-3-5-and-wif-4-5.md) and [WIF API Reference](../../../docs/framework/security/wif-api-reference.md).</span></span>  
  
-   <span data-ttu-id="e3740-132">已启用计算机密钥，以便用于 Web 场方案的会话 Cookie。</span><span class="sxs-lookup"><span data-stu-id="e3740-132">Machine key has been enabled for use in session cookies for web farm scenarios.</span></span> <span data-ttu-id="e3740-133">有关更多信息，请参阅 [WIF 和 Web 场](../../../docs/framework/security/wif-and-web-farms.md)。</span><span class="sxs-lookup"><span data-stu-id="e3740-133">For more information, see [WIF and Web Farms](../../../docs/framework/security/wif-and-web-farms.md).</span></span>  
  
-   <span data-ttu-id="e3740-134">现在可以以声明的方式在 [\<system.identityModel>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/system-identitymodel.md) 和 [\<system.identityModel.services>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/system-identitymodel-services.md) 元素下配置 WIF。</span><span class="sxs-lookup"><span data-stu-id="e3740-134">You now declaratively configure WIF under the [\<system.identityModel>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/system-identitymodel.md) and [\<system.identityModel.services>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/system-identitymodel-services.md) elements.</span></span> <span data-ttu-id="e3740-135">有关 WIF 配置的详细信息，请参阅 [WIF 配置参考](../../../docs/framework/security/wif-configuration-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="e3740-135">For more information about WIF configuration, see [WIF Configuration Reference](../../../docs/framework/security/wif-configuration-reference.md).</span></span>  
  
## <a name="other-notable-net-changes-or-features-that-are-caused-by-the-integration-of-wif-into-net"></a><span data-ttu-id="e3740-136">其他由于 WIF 集成到 .NET 而引起的重要更改或功能</span><span class="sxs-lookup"><span data-stu-id="e3740-136">Other notable .NET changes or features that are caused by the integration of WIF into .NET</span></span>  
  
-   <span data-ttu-id="e3740-137">现在，执行基于声明的授权 (CBAC) 这种可能性是 .NET Framework 的必要组成部分。</span><span class="sxs-lookup"><span data-stu-id="e3740-137">The potential for performing claims-based authorization (CBAC) is now integral to the .NET framework.</span></span> <span data-ttu-id="e3740-138">你可以配置 <xref:System.Security.Claims.ClaimsAuthorizationManager> 对象，然后使用 <xref:System.IdentityModel.Services.ClaimsPrincipalPermission> 和 <xref:System.IdentityModel.Services.ClaimsPrincipalPermissionAttribute> 类在你的代码中执行命令式和声明式访问检查。</span><span class="sxs-lookup"><span data-stu-id="e3740-138">You can configure a <xref:System.Security.Claims.ClaimsAuthorizationManager> object and then use the <xref:System.IdentityModel.Services.ClaimsPrincipalPermission> and <xref:System.IdentityModel.Services.ClaimsPrincipalPermissionAttribute> classes to perform imperative and declarative access checks in your code.</span></span> <span data-ttu-id="e3740-139">与传统基于角色的访问检查 (RBAC) 相比，CBAC 可提供更大的灵活性和精细度。</span><span class="sxs-lookup"><span data-stu-id="e3740-139">CBAC provides more flexibility and greater granularity than traditional role-based access checks (RBAC).</span></span> <span data-ttu-id="e3740-140">它还允许将授权策略与业务逻辑进行更大程度的分离，因为业务逻辑可以使访问检查基于特定的声明或声明组，而这些声明的授权策略可以在 [\<claimsAuthorizationManager>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/claimsauthorizationmanager.md) 元素下以声明方式进行配置。</span><span class="sxs-lookup"><span data-stu-id="e3740-140">It also allows greater separation of authorization policy from business logic because the business logic can base the access check on a specific claim or set of claims and the authorization policy for those claims can be configured declaratively under the [\<claimsAuthorizationManager>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/claimsauthorizationmanager.md) element.</span></span>  
  
## <a name="wcf-changes-as-a-result-of-wif-integration"></a><span data-ttu-id="e3740-141">因 WIF 集成而导致的 WCF 更改：</span><span class="sxs-lookup"><span data-stu-id="e3740-141">WCF changes as a result of WIF integration:</span></span>  
  
-   <span data-ttu-id="e3740-142">WCF 基于声明的标识模型已被 WIF 取代。</span><span class="sxs-lookup"><span data-stu-id="e3740-142">The WCF claims-based identity model is superseded by WIF.</span></span> <span data-ttu-id="e3740-143">这意味着应放弃 <xref:System.IdentityModel.Claims?displayProperty=nameWithType>、<xref:System.IdentityModel.Policy?displayProperty=nameWithType> 和 <xref:System.IdentityModel.Selectors?displayProperty=nameWithType> 命名空间中的类，以便使用 WIF 类。</span><span class="sxs-lookup"><span data-stu-id="e3740-143">This means that classes in the <xref:System.IdentityModel.Claims?displayProperty=nameWithType>, <xref:System.IdentityModel.Policy?displayProperty=nameWithType>, and <xref:System.IdentityModel.Selectors?displayProperty=nameWithType> namespaces should be dropped in favor of using WIF classes.</span></span>  
  
-   <span data-ttu-id="e3740-144">现在，通过指定 `<system.serviceModel>`/`<behaviors>`/`<serviceBehaviors>`/`<serviceCredentials>` 元素上的 `useIdentityConfiguration` 特性，可以在 WCF 服务上启用 WIF，如下列 XML 中所示：</span><span class="sxs-lookup"><span data-stu-id="e3740-144">WIF is now enabled on a WCF service by specifying the `useIdentityConfiguration` attribute on the `<system.serviceModel>`/`<behaviors>`/`<serviceBehaviors>`/`<serviceCredentials>` element as in the following XML:</span></span>  
  
    ```xml  
    <serviceCredentials useIdentityConfiguration="true">  
        <!--Certificate added by Identity And Access VS Package.  Subject='CN=localhost', Issuer='CN=localhost'. Make sure you have this certificate installed. The Identity and Access tool does not install this certificate.-->  
        <serviceCertificate findValue="CN=localhost" storeLocation="LocalMachine" storeName="My" x509FindType="FindBySubjectDistinguishedName" />  
    </serviceCredentials>  
    ```  
  
     <span data-ttu-id="e3740-145">使用用于 Visual Studio 2012 标识和访问工具时（请参阅上文 Visual Studio 体验方面的更改），此工具会添加一个 `<serviceCredentials>` 元素，该元素具有 `useIdentityConfiguration` 特性，并且此特性设置为你的配置文件。</span><span class="sxs-lookup"><span data-stu-id="e3740-145">When you use the **Identity and Access Tool for Visual Studio 2012** (see **Changes to the Visual Studio Experience** above), the tool adds a `<serviceCredentials>` element with the `useIdentityConfiguration` attribute set to the configuration file for you.</span></span> <span data-ttu-id="e3740-146">它还会添加一个包含 WIF 配置设置的对应 [\<system.identityModel>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/system-identitymodel.md) 元素，并添加一个绑定以及其他必要的设置，以便将身份验证外包给你所选择的 STS。</span><span class="sxs-lookup"><span data-stu-id="e3740-146">It also adds a corresponding [\<system.identityModel>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/system-identitymodel.md) element that contains the WIF configuration settings and adds a binding and other settings necessary to outsource authentication to your chosen STS.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e3740-147">请参阅</span><span class="sxs-lookup"><span data-stu-id="e3740-147">See also</span></span>
- [<span data-ttu-id="e3740-148">使用 WIF 3.5 至 WIF 4.5 生成的应用程序的迁移指南</span><span class="sxs-lookup"><span data-stu-id="e3740-148">Guidelines for Migrating an Application Built Using WIF 3.5 to WIF 4.5</span></span>](../../../docs/framework/security/guidelines-for-migrating-an-application-built-using-wif-3-5-to-wif-4-5.md)
- [<span data-ttu-id="e3740-149">WIF 3.5 和 WIF 4.5 之间的命名空间映射</span><span class="sxs-lookup"><span data-stu-id="e3740-149">Namespace Mapping between WIF 3.5 and WIF 4.5</span></span>](../../../docs/framework/security/namespace-mapping-between-wif-3-5-and-wif-4-5.md)
- [<span data-ttu-id="e3740-150">WIF API 参考</span><span class="sxs-lookup"><span data-stu-id="e3740-150">WIF API Reference</span></span>](../../../docs/framework/security/wif-api-reference.md)
- [<span data-ttu-id="e3740-151">WIF 配置参考</span><span class="sxs-lookup"><span data-stu-id="e3740-151">WIF Configuration Reference</span></span>](../../../docs/framework/security/wif-configuration-reference.md)
