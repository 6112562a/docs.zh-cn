---
title: XAML 的集合类型
ms.date: 03/30/2017
ms.assetid: 58f8e7c6-9a41-4f25-8551-c042f1315baa
ms.openlocfilehash: 4123b64545f7c47a96c4cae496046a89b7e576b0
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "61954175"
---
# <a name="collections-and-collection-types-for-xaml"></a><span data-ttu-id="9ca11-102">XAML 的集合类型</span><span class="sxs-lookup"><span data-stu-id="9ca11-102">Collections and Collection Types for XAML</span></span>

<span data-ttu-id="9ca11-103">本主题介绍如何定义旨在支持一个集合，并以支持 XAML 语法用于实例化作为父对象元素或属性元素的子元素的集合项的类型的属性。</span><span class="sxs-lookup"><span data-stu-id="9ca11-103">This topic describes how to define properties of types that are intended to support a collection, and to support the XAML syntax for instantiating collection items as element children of a parent object element or property element.</span></span>

## <a name="xaml-collection-concepts"></a><span data-ttu-id="9ca11-104">XAML 集合概念</span><span class="sxs-lookup"><span data-stu-id="9ca11-104">XAML Collection Concepts</span></span>

<span data-ttu-id="9ca11-105">从概念上讲，任何关系中其中有多个作用域内的 XAML 对象元素的子项目或 XAML 属性元素必须实现为集合的 XAML。</span><span class="sxs-lookup"><span data-stu-id="9ca11-105">Conceptually, any relationship in XAML where there are multiple child items within the scope of a XAML object element or XAML property element must be implemented as a collection.</span></span> <span data-ttu-id="9ca11-106">该集合必须与该关系中的父级的 XAML 类型的特定 XAML 属性相关联。</span><span class="sxs-lookup"><span data-stu-id="9ca11-106">That collection must be associated with a particular XAML property of the XAML type that is the parent in that relationship.</span></span> <span data-ttu-id="9ca11-107">该属性必须是集合，因为 XAML 处理器需要分配标记为新添加的项的支持集合属性中的每个项。</span><span class="sxs-lookup"><span data-stu-id="9ca11-107">The property must be a collection because a XAML processor expects to assign each item in markup to be a newly added item of the backing collection property.</span></span>

<span data-ttu-id="9ca11-108">在 XAML 语言级别，集合支持的确切要求未完全定义。</span><span class="sxs-lookup"><span data-stu-id="9ca11-108">At the XAML language level, the exact requirements of collection support are not fully defined.</span></span> <span data-ttu-id="9ca11-109">集合可以是列表或字典 （而不是两者） 的概念定义 XAML 语言级别，但后备类型表示任一列表或字典不由 XAML 语言定义。</span><span class="sxs-lookup"><span data-stu-id="9ca11-109">The concept that a collection can be either a list or a dictionary(but not both) is defined at the XAML language level, but which backing types represent either lists or dictionaries is not defined by the XAML language.</span></span>

<span data-ttu-id="9ca11-110">在.NET Framework XAML 服务中，按照后备类型的.NET Framework 更清楚地定义 XAML 集合支持的概念。</span><span class="sxs-lookup"><span data-stu-id="9ca11-110">In .NET Framework XAML Services, the concept of XAML collection support is more clearly defined in terms of .NET Framework backing types.</span></span> <span data-ttu-id="9ca11-111">具体而言，集合的 XAML 支持基于多个.NET Framework 概念和 Api，它们对于列表和在常规的.NET Framework 编程的字典。</span><span class="sxs-lookup"><span data-stu-id="9ca11-111">Specifically, the XAML support for collections is based on several .NET Framework concepts and APIs that are used for lists and dictionaries in general .NET Framework programming.</span></span>

1. <span data-ttu-id="9ca11-112"><xref:System.Collections.IList>接口指示列表集合。</span><span class="sxs-lookup"><span data-stu-id="9ca11-112">The <xref:System.Collections.IList> interface indicates a list collection.</span></span>

2. <span data-ttu-id="9ca11-113"><xref:System.Collections.IDictionary>接口指示字典集合。</span><span class="sxs-lookup"><span data-stu-id="9ca11-113">The <xref:System.Collections.IDictionary> interface indicates a dictionary collection.</span></span>

3. <span data-ttu-id="9ca11-114"><xref:System.Array> 表示一个数组和数组支持<xref:System.Collections.IList>方法。</span><span class="sxs-lookup"><span data-stu-id="9ca11-114"><xref:System.Array> represents an array, and an array supports <xref:System.Collections.IList> methods.</span></span>

<span data-ttu-id="9ca11-115">在每个集合概念，.NET Framework XAML 服务 XAML 处理器需要调用`Add`集合属性的类型的特定实例上的方法。</span><span class="sxs-lookup"><span data-stu-id="9ca11-115">In each of these collection concepts, a .NET Framework XAML Services XAML processor expects to call the `Add` method on a specific instance of the collection property's type.</span></span> <span data-ttu-id="9ca11-116">或者，在序列化方案中，XAML 处理器生成的每个项列表、 字典或数组基于每个集合的特定概念的"项"中的离散 XAML 类型实例。</span><span class="sxs-lookup"><span data-stu-id="9ca11-116">Or, in a serialization scenario, a XAML processor produces discrete XAML-type instances for each item found in the list, dictionary or array based on each collection's specific concept of "Items".</span></span> <span data-ttu-id="9ca11-117">这些是： <xref:System.Collections.IList.Item%2A>;<xref:System.Collections.IDictionary.Item%2A>; 显式<xref:System.Array.System%23Collections%23IList%23Item%2A>为<xref:System.Array>。</span><span class="sxs-lookup"><span data-stu-id="9ca11-117">These are : <xref:System.Collections.IList.Item%2A>; <xref:System.Collections.IDictionary.Item%2A>; the explicit <xref:System.Array.System%23Collections%23IList%23Item%2A> for <xref:System.Array>.</span></span>

## <a name="generic-collections"></a><span data-ttu-id="9ca11-118">泛型集合</span><span class="sxs-lookup"><span data-stu-id="9ca11-118">Generic Collections</span></span>

<span data-ttu-id="9ca11-119">泛型集合可用于常规.NET Framework 编程，并且还可用于 XAML 集合属性。</span><span class="sxs-lookup"><span data-stu-id="9ca11-119">Generic collections can be useful for general .NET Framework programming, and can also be used for XAML collection properties.</span></span> <span data-ttu-id="9ca11-120">但是，泛型接口<xref:System.Collections.Generic.IList%601>并<xref:System.Collections.Generic.IDictionary%602>不识别的视为等效于非泛型的.NET Framework XAML 服务 XAML 处理器<xref:System.Collections.IList>或<xref:System.Collections.IDictionary>。</span><span class="sxs-lookup"><span data-stu-id="9ca11-120">However, the generic interfaces <xref:System.Collections.Generic.IList%601> and <xref:System.Collections.Generic.IDictionary%602> are not identified by .NET Framework XAML Services XAML processors as being equivalent to the non-generic <xref:System.Collections.IList> or <xref:System.Collections.IDictionary>.</span></span> <span data-ttu-id="9ca11-121">而不是实现接口，泛型集合属性类型的建议的方法是从类派生<xref:System.Collections.Generic.List%601>或<xref:System.Collections.Generic.Dictionary%602>。</span><span class="sxs-lookup"><span data-stu-id="9ca11-121">Rather than implementing the interfaces, a recommended approach for generic collection property types is to derive from the classes <xref:System.Collections.Generic.List%601> or <xref:System.Collections.Generic.Dictionary%602>.</span></span> <span data-ttu-id="9ca11-122">这些类实现非泛型接口，并因此在基实现中包含 XAML 集合的预期的支持。</span><span class="sxs-lookup"><span data-stu-id="9ca11-122">These classes implement the non-generic interfaces and thus include the expected support for XAML collections in the base implementation.</span></span>

## <a name="read-only-collections-and-initialization-logic"></a><span data-ttu-id="9ca11-123">只读集合和初始化逻辑</span><span class="sxs-lookup"><span data-stu-id="9ca11-123">Read-Only Collections and Initialization Logic</span></span>

<span data-ttu-id="9ca11-124">在.NET Framework 编程，它是常见的设计模式，以使任何属性，保存集合为只读集合的值。</span><span class="sxs-lookup"><span data-stu-id="9ca11-124">In .NET Framework programming, it is a common design pattern to make any property that holds a value of a collection as a read-only collection.</span></span> <span data-ttu-id="9ca11-125">此模式允许拥有更好地控制集合会发生什么情况的集合属性的实例...</span><span class="sxs-lookup"><span data-stu-id="9ca11-125">This pattern permits the instance that owns the collection property to better control what happens to the collection..</span></span> <span data-ttu-id="9ca11-126">具体而言，该模式通过将属性设置阻止意外替换整个预先存在的收集。</span><span class="sxs-lookup"><span data-stu-id="9ca11-126">Specifically, the pattern prevents accidental replacement of the entire pre-existing collection by setting the property.</span></span> <span data-ttu-id="9ca11-127">在此模式下，对由调用方的集合的任何访问而是应将通过调用方法或属性，如支持的集合类型和/或相关集合接口<xref:System.Collections.IList>。</span><span class="sxs-lookup"><span data-stu-id="9ca11-127">In this pattern, any access to the collection by callers should instead be made by calling methods or properties as supported by the collection type and/or the relevant collection interfaces such as <xref:System.Collections.IList>.</span></span>

<span data-ttu-id="9ca11-128">使用此模式意味着任何公开的只读集合属性的类必须先初始化该属性，包含一个空集合。</span><span class="sxs-lookup"><span data-stu-id="9ca11-128">Using this pattern implies that any class that exposes a read-only collection property must first initialize that property to hold an empty collection.</span></span> <span data-ttu-id="9ca11-129">通常作为类的构造行为的一部分执行初始化。</span><span class="sxs-lookup"><span data-stu-id="9ca11-129">Typically the initialization is performed as part of the construction behavior for the class.</span></span> <span data-ttu-id="9ca11-130">可用于 XAML，它很重要，默认构造函数中，始终引用此类逻辑因为 XAML 通常调用默认构造函数之前处理属性 (集合属性或其他)。</span><span class="sxs-lookup"><span data-stu-id="9ca11-130">To be useful for XAML, it is important that such logic is always referenced by the default constructor, because XAML generally calls the default constructor prior to processing the properties (collection properties or otherwise).</span></span>

## <a name="xaml-type-system-support-and-collections"></a><span data-ttu-id="9ca11-131">XAML 类型系统支持和集合</span><span class="sxs-lookup"><span data-stu-id="9ca11-131">XAML Type System Support and Collections</span></span>

<span data-ttu-id="9ca11-132">除了分析 XAML 和填充或序列化集合属性的基本机制，在.NET Framework XAML 服务中实现的 XAML 类型系统包括适用于 XAML 中的集合的多种设计功能。</span><span class="sxs-lookup"><span data-stu-id="9ca11-132">Beyond the basic mechanics of parsing XAML and populating or serializing collection properties, the XAML type system as implemented in .NET Framework XAML Services includes several design features that pertain to collections in XAML.</span></span>

1. <span data-ttu-id="9ca11-133"><xref:System.Xaml.XamlType.IsCollection%2A> 如果 XAML 类型由提供 XAML 集合支持的类型，，返回 true。</span><span class="sxs-lookup"><span data-stu-id="9ca11-133"><xref:System.Xaml.XamlType.IsCollection%2A> returns true if the XAML type is backed by a type that provides XAML collection support.</span></span>

2. <span data-ttu-id="9ca11-134"><xref:System.Xaml.XamlType.IsDictionary%2A> 和<xref:System.Xaml.XamlType.IsArray%2A>可以进一步确定支持的 XAML 类型的收集模式。</span><span class="sxs-lookup"><span data-stu-id="9ca11-134"><xref:System.Xaml.XamlType.IsDictionary%2A> and <xref:System.Xaml.XamlType.IsArray%2A> can further identify which collection mode the XAML type supports.</span></span> <span data-ttu-id="9ca11-135">对于自定义 XAML 处理器的基于.NET Framework XAML 服务和 XAML 类型系统，但不是基于现有<xref:System.Xaml.XamlWriter>实现中，了解所使用的集合模式可能需要这样才能知道要调用的方法集合处理。</span><span class="sxs-lookup"><span data-stu-id="9ca11-135">For custom XAML processors that are based on .NET Framework XAML Services and the XAML type system but not based on existing <xref:System.Xaml.XamlWriter> implementations, knowing which collection mode is used might be necessary in order to know which method to invoke for collection processing.</span></span>

3. <span data-ttu-id="9ca11-136">每个以前的属性值可能会受到的重写<xref:System.Xaml.XamlType.LookupCollectionKind%2A>XAML 类型。</span><span class="sxs-lookup"><span data-stu-id="9ca11-136">Each of the previous property values are potentially influenced by overrides of <xref:System.Xaml.XamlType.LookupCollectionKind%2A> on a XAML type.</span></span>
