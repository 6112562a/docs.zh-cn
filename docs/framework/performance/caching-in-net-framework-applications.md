---
title: .NET Framework 应用程序中的缓存
ms.date: 03/30/2017
helpviewer_keywords:
- ASP.NET caching
- caching [.NET Framework]
- caching [ASP.NET]
ms.assetid: c4b47ee0-4b82-4124-9bce-818088385e34
author: tdykstra
ms.openlocfilehash: 9fc63f860bad96d7dd304de31dd6e9b6626c90b6
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/23/2019
ms.locfileid: "54721059"
---
# <a name="caching-in-net-framework-applications"></a><span data-ttu-id="3470c-102">.NET Framework 应用程序中的缓存</span><span class="sxs-lookup"><span data-stu-id="3470c-102">Caching in .NET Framework Applications</span></span>
<span data-ttu-id="3470c-103">缓存可以将数据存储在内存中以便快速访问。</span><span class="sxs-lookup"><span data-stu-id="3470c-103">Caching enables you to store data in memory for rapid access.</span></span> <span data-ttu-id="3470c-104">再次访问数据时，应用程序可以从缓存获取数据，而不是从原始源检索数据。</span><span class="sxs-lookup"><span data-stu-id="3470c-104">When the data is accessed again, applications can get the data from the cache instead of retrieving it from the original source.</span></span> <span data-ttu-id="3470c-105">这可改善性能和可伸缩性。</span><span class="sxs-lookup"><span data-stu-id="3470c-105">This can improve performance and scalability.</span></span> <span data-ttu-id="3470c-106">此外，数据源暂时不可用时，缓存可提供数据。</span><span class="sxs-lookup"><span data-stu-id="3470c-106">In addition, caching makes data available when the data source is temporarily unavailable.</span></span>  
  
 <span data-ttu-id="3470c-107">.NET Framework 提供了缓存功能，可提高 Windows 客户端和服务器应用程序（包括 ASP.NET）的性能和可伸缩性。</span><span class="sxs-lookup"><span data-stu-id="3470c-107">The .NET Framework provides caching functionality that you can use to improve the performance and scalability of both Windows client and server applications, including ASP.NET.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3470c-108">在 [!INCLUDE[net_v35_short](../../../includes/net-v35-short-md.md)] 和早期版本中，ASP.NET 在 <xref:System.Web.Caching> 命名空间中提供内存中缓存实现。</span><span class="sxs-lookup"><span data-stu-id="3470c-108">In the [!INCLUDE[net_v35_short](../../../includes/net-v35-short-md.md)] and earlier versions, ASP.NET provided an in-memory cache implementation in the <xref:System.Web.Caching> namespace.</span></span> <span data-ttu-id="3470c-109">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 以前的版本中，缓存仅在 <xref:System.Web> 命名空间可用，因此，需要 ASP.NET 类上的一个依赖项。</span><span class="sxs-lookup"><span data-stu-id="3470c-109">In previous versions of the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)], caching was available only in the <xref:System.Web> namespace and therefore required a dependency on ASP.NET classes.</span></span> <span data-ttu-id="3470c-110">在 .NET Framework 4 中，<xref:System.Runtime.Caching> 命名空间包含为 Web 和非 Web 应用程序设计的 API。</span><span class="sxs-lookup"><span data-stu-id="3470c-110">In the .NET Framework 4, the <xref:System.Runtime.Caching> namespace contains APIs that are designed for both Web and non-Web applications.</span></span>  
  
## <a name="caching-data"></a><span data-ttu-id="3470c-111">缓存数据</span><span class="sxs-lookup"><span data-stu-id="3470c-111">Caching Data</span></span>  
 <span data-ttu-id="3470c-112">可使用 <xref:System.Runtime.Caching> 命名空间中的类来缓存信息。</span><span class="sxs-lookup"><span data-stu-id="3470c-112">You can cache information by using classes in the <xref:System.Runtime.Caching> namespace.</span></span> <span data-ttu-id="3470c-113">此命名空间中的缓存类提供下列功能：</span><span class="sxs-lookup"><span data-stu-id="3470c-113">The caching classes in this namespace provide the following features:</span></span>  
  
-   <span data-ttu-id="3470c-114">为创建自定义缓存实现提供基础的抽象类型。</span><span class="sxs-lookup"><span data-stu-id="3470c-114">Abstract types that provide the foundation for creating custom cache implementations.</span></span>  
  
-   <span data-ttu-id="3470c-115">具体的内存中对象缓存实现。</span><span class="sxs-lookup"><span data-stu-id="3470c-115">A concrete in-memory object cache implementation.</span></span>  
  
 <span data-ttu-id="3470c-116">抽象基缓存类 (<xref:System.Runtime.Caching.ObjectCache>) 定义以下缓存任务：</span><span class="sxs-lookup"><span data-stu-id="3470c-116">The abstract base caching class (<xref:System.Runtime.Caching.ObjectCache>) defines the following caching tasks:</span></span>  
  
-   <span data-ttu-id="3470c-117">创建和管理缓存项。</span><span class="sxs-lookup"><span data-stu-id="3470c-117">Creating and managing cache entries.</span></span>  
  
-   <span data-ttu-id="3470c-118">指定过期和逐出信息。</span><span class="sxs-lookup"><span data-stu-id="3470c-118">Specifying expiration and eviction information.</span></span>  
  
-   <span data-ttu-id="3470c-119">触发响应缓存项更改而引发的事件。</span><span class="sxs-lookup"><span data-stu-id="3470c-119">Triggering events that are raised in response to changes in cache entries.</span></span>  
  
 <span data-ttu-id="3470c-120"><xref:System.Runtime.Caching.MemoryCache> 类是 <xref:System.Runtime.Caching.ObjectCache> 类的内存中对象缓存实现。</span><span class="sxs-lookup"><span data-stu-id="3470c-120">The <xref:System.Runtime.Caching.MemoryCache> class is an in-memory object cache implementation of the <xref:System.Runtime.Caching.ObjectCache> class.</span></span> <span data-ttu-id="3470c-121"><xref:System.Runtime.Caching.MemoryCache> 类可用于大多数缓存任务。</span><span class="sxs-lookup"><span data-stu-id="3470c-121">You can use the <xref:System.Runtime.Caching.MemoryCache> class for most caching tasks.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3470c-122"><xref:System.Runtime.Caching.MemoryCache> 类在 <xref:System.Web.Caching> 命名空间中定义的 ASP.NET 缓存对象中建模。</span><span class="sxs-lookup"><span data-stu-id="3470c-122">The <xref:System.Runtime.Caching.MemoryCache> class is modeled on the ASP.NET cache object that is defined in the <xref:System.Web.Caching> namespace.</span></span> <span data-ttu-id="3470c-123">因此，内部缓存逻辑与 ASP.NET 早期版本所提供的逻辑相似。</span><span class="sxs-lookup"><span data-stu-id="3470c-123">Therefore, the internal caching logic similar to the logic that was provided in earlier versions of ASP.NET.</span></span>  
  
 <span data-ttu-id="3470c-124">有关如何使用缓存在 WPF 应用程序的示例，请参阅[演练：缓存在 WPF 应用程序的应用程序数据](../../../docs/framework/wpf/advanced/walkthrough-caching-application-data-in-a-wpf-application.md)。</span><span class="sxs-lookup"><span data-stu-id="3470c-124">For an example of how to use to caching in a WPF application, see [Walkthrough: Caching Application Data in a WPF Application](../../../docs/framework/wpf/advanced/walkthrough-caching-application-data-in-a-wpf-application.md).</span></span>  
  
## <a name="caching-in-aspnet-applications"></a><span data-ttu-id="3470c-125">在 ASP.NET 应用程序中进行缓存</span><span class="sxs-lookup"><span data-stu-id="3470c-125">Caching in ASP.NET Applications</span></span>  
 <span data-ttu-id="3470c-126"><xref:System.Runtime.Caching> 命名空间中的缓存类提供在 ASP.NET 中缓存数据的功能。</span><span class="sxs-lookup"><span data-stu-id="3470c-126">The caching classes in the <xref:System.Runtime.Caching> namespace provide functionality for caching data in ASP.NET.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3470c-127">如果应用程序针对 [!INCLUDE[net_v35_short](../../../includes/net-v35-short-md.md)] 或更早版本，必须使用在 <xref:System.Web.Caching> 命名空间中定义的缓存类。</span><span class="sxs-lookup"><span data-stu-id="3470c-127">If your application targets the [!INCLUDE[net_v35_short](../../../includes/net-v35-short-md.md)] or earlier, you must use the caching classes that are defined in the <xref:System.Web.Caching> namespace.</span></span> <span data-ttu-id="3470c-128">有关详细信息，请参阅 [ASP.NET 缓存概述](https://msdn.microsoft.com/library/5ec28012-4972-4dc3-b3e8-9d20401fe11d)。</span><span class="sxs-lookup"><span data-stu-id="3470c-128">For more information, see [ASP.NET Caching Overview](https://msdn.microsoft.com/library/5ec28012-4972-4dc3-b3e8-9d20401fe11d).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3470c-129">开发新应用程序时，建议使用 <xref:System.Runtime.Caching.MemoryCache> 类。</span><span class="sxs-lookup"><span data-stu-id="3470c-129">When you develop new applications, we recommend that you use the <xref:System.Runtime.Caching.MemoryCache> class.</span></span> <span data-ttu-id="3470c-130"><xref:System.Runtime.Caching> 命名空间中提供的 API 与 <xref:System.Web.Caching.Cache> 命名空间中提供的 API 类似。</span><span class="sxs-lookup"><span data-stu-id="3470c-130">The API that is provided in the <xref:System.Runtime.Caching> namespace is like the API that is provided in the <xref:System.Web.Caching.Cache> namespace.</span></span> <span data-ttu-id="3470c-131">因此，如果你已在 ASP.NET 早期版本中使用过缓存，那么将会对 API 感到熟悉。</span><span class="sxs-lookup"><span data-stu-id="3470c-131">Therefore, the API will be familiar if you used caching in earlier versions of ASP.NET.</span></span> <span data-ttu-id="3470c-132">有关如何使用 ASP.NET 应用程序中缓存的示例，请参阅[演练：缓存在 ASP.NET 中的应用程序数据](https://msdn.microsoft.com/library/942236f6-0138-4aaf-af71-a5ea451a1e23)。</span><span class="sxs-lookup"><span data-stu-id="3470c-132">For an example of how to use caching in ASP.NET applications, see [Walkthrough: Caching Application Data in ASP.NET](https://msdn.microsoft.com/library/942236f6-0138-4aaf-af71-a5ea451a1e23).</span></span>  
  
### <a name="output-caching"></a><span data-ttu-id="3470c-133">输出缓存</span><span class="sxs-lookup"><span data-stu-id="3470c-133">Output Caching</span></span>  
 <span data-ttu-id="3470c-134">若要手动缓存应用程序数据，可使用 ASP.NET 中的 <xref:System.Runtime.Caching.MemoryCache> 类。</span><span class="sxs-lookup"><span data-stu-id="3470c-134">To manually cache application data, you can use the <xref:System.Runtime.Caching.MemoryCache> class in ASP.NET.</span></span> <span data-ttu-id="3470c-135">ASP.NET 还支持输出缓存，在内存中存储生成的页面输出、控件和 HTTP 响应。</span><span class="sxs-lookup"><span data-stu-id="3470c-135">ASP.NET also supports output caching, which stores the generated output of pages, controls, and HTTP responses in memory.</span></span> <span data-ttu-id="3470c-136">可在 ASP.NET Web 页中通过声明方式或使用 Web.config 文件中的设置，配置输出缓存。</span><span class="sxs-lookup"><span data-stu-id="3470c-136">You can configure output caching declaratively in an ASP.NET Web page or by using settings in the Web.config file.</span></span> <span data-ttu-id="3470c-137">有关详细信息，请参阅[用于缓存的 outputCache 元素（ASP.NET 设置架构）](https://msdn.microsoft.com/library/47cd2b47-316f-4dfd-bbf8-539be3066fee)。</span><span class="sxs-lookup"><span data-stu-id="3470c-137">For more information, see [outputCache Element for caching (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/47cd2b47-316f-4dfd-bbf8-539be3066fee).</span></span>  
  
 <span data-ttu-id="3470c-138">借助 ASP.NET，可通过创建自定义输出缓存提供程序扩展输出缓存。</span><span class="sxs-lookup"><span data-stu-id="3470c-138">ASP.NET lets you extend output caching by creating custom output-cache providers.</span></span> <span data-ttu-id="3470c-139">通过自定义提供程序，可使用磁盘、云存储和分布式缓存引擎等其他存储设备，存储缓存内容。</span><span class="sxs-lookup"><span data-stu-id="3470c-139">By using custom providers, you can store cached content using other storage devices such as disks, cloud storage, and distributed cache engines.</span></span> <span data-ttu-id="3470c-140">若要创建自定义输出缓存提供程序，可创建 <xref:System.Web.Caching.OutputCacheProvider> 类的派生类，并将应用程序配置为使用自定义输出缓存提供程序。</span><span class="sxs-lookup"><span data-stu-id="3470c-140">To create a custom output cache provider, you create a class that derives from the <xref:System.Web.Caching.OutputCacheProvider> class and configure the application to use the custom output cache provider.</span></span>  
  
## <a name="caching-in-wcf-rest-services"></a><span data-ttu-id="3470c-141">在 WCF REST 服务中进行缓存</span><span class="sxs-lookup"><span data-stu-id="3470c-141">Caching in WCF REST Services</span></span>  
 <span data-ttu-id="3470c-142">对于 WCF REST 服务，.NET Framework 可充分利用 ASP.NET 中提供的声明性输出缓存。</span><span class="sxs-lookup"><span data-stu-id="3470c-142">For WCF REST services, the .NET Framework enables you to take advantage of the declarative output caching that is available in ASP.NET.</span></span> <span data-ttu-id="3470c-143">这便可以缓存来自 WCF REST 服务操作的响应。</span><span class="sxs-lookup"><span data-stu-id="3470c-143">This enables you to cache responses from your WCF REST service operations.</span></span> <span data-ttu-id="3470c-144">如果用户向配置为进行缓存的服务发送了 HTTP GET 请求，那么 ASP.NET 将返回已缓存响应，且不会调用服务方法。</span><span class="sxs-lookup"><span data-stu-id="3470c-144">When a user sends an HTTP GET request to a service that is configured for caching, ASP.NET sends back the cached response, and the service method is not called.</span></span> <span data-ttu-id="3470c-145">缓存过期后，下次用户发送 HTTP GET 请求时，将会调用服务方法且再次缓存响应。</span><span class="sxs-lookup"><span data-stu-id="3470c-145">After the cache expires, the next time that a user sends an HTTP GET request, your service method is called and the response is again cached.</span></span>  
  
 <span data-ttu-id="3470c-146">.NET Framework 还可实现条件 HTTP GET 缓存。</span><span class="sxs-lookup"><span data-stu-id="3470c-146">The .NET Framework also enables you to implement conditional HTTP GET caching.</span></span> <span data-ttu-id="3470c-147">在 REST 方案中，条件 HTTP GET 请求通常由服务用来实现智能 HTTP 缓存，如 [HTTP 规范](https://go.microsoft.com/fwlink/?LinkId=165800)中所述。</span><span class="sxs-lookup"><span data-stu-id="3470c-147">In REST scenarios, a conditional HTTP GET request is often used by services to implement intelligent HTTP caching as described in the [HTTP Specification](https://go.microsoft.com/fwlink/?LinkId=165800).</span></span> <span data-ttu-id="3470c-148">有关详细信息，请参阅 [Caching Support for WCF Web HTTP Services](https://go.microsoft.com/fwlink/?LinkId=184598)（对 WCF Web HTTP 服务的缓存支持）。</span><span class="sxs-lookup"><span data-stu-id="3470c-148">For more information, see [Caching Support for WCF Web HTTP Services](https://go.microsoft.com/fwlink/?LinkId=184598).</span></span>  
  
## <a name="extending-caching-in-the-net-framework"></a><span data-ttu-id="3470c-149">在 .NET Framework 中扩展缓存</span><span class="sxs-lookup"><span data-stu-id="3470c-149">Extending Caching in the .NET Framework</span></span>  
 <span data-ttu-id="3470c-150">.NET Framework 中的缓存设计为可扩展。</span><span class="sxs-lookup"><span data-stu-id="3470c-150">Caching in the .NET Framework is designed to be extensible.</span></span> <span data-ttu-id="3470c-151"><xref:System.Runtime.Caching.ObjectCache> 类能够创建自定义缓存实现。</span><span class="sxs-lookup"><span data-stu-id="3470c-151">The <xref:System.Runtime.Caching.ObjectCache> class enables you to create a custom cache implementation.</span></span> <span data-ttu-id="3470c-152">此类提供可用于所有托管应用程序（包括 Windows 窗体、Windows Presentation Foundation (WPF) 和 Windows Communications Foundation (WCF)）的成员。</span><span class="sxs-lookup"><span data-stu-id="3470c-152">This class provides members that are available to all managed applications, including Windows Forms, Windows Presentation Foundation (WPF), and Windows Communications Foundation (WCF).</span></span> <span data-ttu-id="3470c-153">若要创建使用不同存储机制的缓存类或希望精确地控制缓存操作，可能需要执行此操作。</span><span class="sxs-lookup"><span data-stu-id="3470c-153">You might do this in order to create a cache class that uses a different storage mechanism, or if you want granular control over cache operations.</span></span>  
  
 <span data-ttu-id="3470c-154">要扩展缓存可执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="3470c-154">To extend caching you can do the following:</span></span>  
  
-   <span data-ttu-id="3470c-155">创建一个派生自 <xref:System.Runtime.Caching.ObjectCache> 类的自定义类，然后在此派生类中提供自定义缓存实现。</span><span class="sxs-lookup"><span data-stu-id="3470c-155">Create a custom class that derives from the <xref:System.Runtime.Caching.ObjectCache> class and then provide a custom cache implementation in the derived class.</span></span>  
  
-   <span data-ttu-id="3470c-156">创建一个派生自 <xref:System.Runtime.Caching.MemoryCache> 类的类，并自定义或扩展此派生类。</span><span class="sxs-lookup"><span data-stu-id="3470c-156">Create a class that derives from <xref:System.Runtime.Caching.MemoryCache> class and customize or extend the derived class.</span></span> <span data-ttu-id="3470c-157">有关如何执行此操作的示例，请参阅[在 ASP.NET 应用程序中使用多个缓存对象来缓存应用程序数据](https://blogs.msdn.com/aspnetue/archive/2010/03/22/caching-application-data-by-using-multiple-cache-objects-in-an-asp-net-application.aspx)。</span><span class="sxs-lookup"><span data-stu-id="3470c-157">For an example of how to do this, see [Caching Application Data by Using Multiple Cache Objects in an ASP.NET Application](https://blogs.msdn.com/aspnetue/archive/2010/03/22/caching-application-data-by-using-multiple-cache-objects-in-an-asp-net-application.aspx).</span></span>  
  
-   <span data-ttu-id="3470c-158">创建 <xref:System.Web.Caching.OutputCacheProvider> 类的派生类，并配置应用程序以使用自定义输出缓存提供程序。</span><span class="sxs-lookup"><span data-stu-id="3470c-158">Create a class that derives from the <xref:System.Web.Caching.OutputCacheProvider> class and configure the application to use the custom output cache provider.</span></span>  
  
 <span data-ttu-id="3470c-159">有关详细信息，请参阅 Scott Guthrie 博客上的 [ASP.NET 4 的可扩展输出缓存（VS 2010 和 .NET 4.0 系列）](https://go.microsoft.com/fwlink/?LinkId=185772)文章。</span><span class="sxs-lookup"><span data-stu-id="3470c-159">For more information, see the entry [Extensible Output Caching with ASP.NET 4 (VS 2010 and .NET 4.0 Series)](https://go.microsoft.com/fwlink/?LinkId=185772) on Scott Guthrie's blog.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3470c-160">请参阅</span><span class="sxs-lookup"><span data-stu-id="3470c-160">See also</span></span>
- <xref:System.Runtime.Caching.ObjectCache>
- <xref:System.Runtime.Caching.MemoryCache>
- [<span data-ttu-id="3470c-161">演练：缓存在 WPF 应用程序的应用程序数据</span><span class="sxs-lookup"><span data-stu-id="3470c-161">Walkthrough: Caching Application Data in a WPF Application</span></span>](../../../docs/framework/wpf/advanced/walkthrough-caching-application-data-in-a-wpf-application.md)
- [<span data-ttu-id="3470c-162">演练：在 ASP.NET 中缓存应用程序数据</span><span class="sxs-lookup"><span data-stu-id="3470c-162">Walkthrough: Caching Application Data in ASP.NET</span></span>](https://msdn.microsoft.com/library/942236f6-0138-4aaf-af71-a5ea451a1e23)
