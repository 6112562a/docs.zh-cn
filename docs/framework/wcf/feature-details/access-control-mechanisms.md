---
title: 访问控制机制
ms.date: 03/30/2017
helpviewer_keywords:
- WCF security
- access control [WCF]
ms.assetid: 9d576122-3f55-4425-9acf-b23d0781e966
ms.openlocfilehash: 78d2bb3e49ae971b54d521585184a9565c4ff105
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/23/2019
ms.locfileid: "54512601"
---
# <a name="access-control-mechanisms"></a><span data-ttu-id="db8a7-102">访问控制机制</span><span class="sxs-lookup"><span data-stu-id="db8a7-102">Access Control Mechanisms</span></span>
<span data-ttu-id="db8a7-103">您可以控制采用多种方式使用 Windows Communication Foundation (WCF) 的访问。</span><span class="sxs-lookup"><span data-stu-id="db8a7-103">You can control access in several way with Windows Communication Foundation (WCF).</span></span> <span data-ttu-id="db8a7-104">本主题简要讨论各种机制并提供关于何时使用每种机制的建议；旨在帮助您选择使用正确的机制。</span><span class="sxs-lookup"><span data-stu-id="db8a7-104">This topic briefly discusses the various mechanisms and provides suggestions on when to use each; it is intended to help you select the correct mechanism to use.</span></span> <span data-ttu-id="db8a7-105">访问技术按复杂程度顺序列出。</span><span class="sxs-lookup"><span data-stu-id="db8a7-105">The access technologies are listed in order of complexity.</span></span> <span data-ttu-id="db8a7-106">最简单的是 <xref:System.Security.Permissions.PrincipalPermissionAttribute>；而最复杂的是标识模型。</span><span class="sxs-lookup"><span data-stu-id="db8a7-106">The simplest is the <xref:System.Security.Permissions.PrincipalPermissionAttribute>; the most complex is the Identity Model.</span></span>  
  
 <span data-ttu-id="db8a7-107">除了这些机制，模拟和委托使用 WCF 所述[委托和模拟](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md)。</span><span class="sxs-lookup"><span data-stu-id="db8a7-107">In addition to these mechanisms, impersonation and delegation with WCF is explained in [Delegation and Impersonation](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span></span>  
  
## <a name="principalpermissionattribute"></a><span data-ttu-id="db8a7-108">PrincipalPermissionAttribute</span><span class="sxs-lookup"><span data-stu-id="db8a7-108">PrincipalPermissionAttribute</span></span>  
 <span data-ttu-id="db8a7-109"><xref:System.Security.Permissions.PrincipalPermissionAttribute> 用于限制对服务方法的访问。</span><span class="sxs-lookup"><span data-stu-id="db8a7-109">The <xref:System.Security.Permissions.PrincipalPermissionAttribute> is used to restrict access to a service method.</span></span> <span data-ttu-id="db8a7-110">将该属性应用于方法时，它可用于请求特定调用方在 Windows 组或 [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] 角色中的标识或成员资格。</span><span class="sxs-lookup"><span data-stu-id="db8a7-110">When the attribute is applied to a method, it can be used to demand a specific caller's identity or membership in a Windows group or [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] role.</span></span> <span data-ttu-id="db8a7-111">如果使用 X.509 证书对客户端进行身份验证，则将为该客户端提供一个由该证书的主题名称和指纹组成的主标识。</span><span class="sxs-lookup"><span data-stu-id="db8a7-111">If the client is authenticated using an X.509 certificate, it is given a primary identity that consists of the subject name plus the thumbprint of the certificate.</span></span>  
  
 <span data-ttu-id="db8a7-112">如果服务用户将始终属于运行服务的同一个 Windows 域的成员，请使用 <xref:System.Security.Permissions.PrincipalPermissionAttribute> 来控制对运行服务的计算机上的资源的访问。</span><span class="sxs-lookup"><span data-stu-id="db8a7-112">Use the <xref:System.Security.Permissions.PrincipalPermissionAttribute> to control access to resources on the computer that the service is running on, and if the users of the service will always be part of the same Windows domain that the service is running on.</span></span> <span data-ttu-id="db8a7-113">您可以轻松创建已指定访问级别（如，无、只读或读写）的 Windows 组。</span><span class="sxs-lookup"><span data-stu-id="db8a7-113">You can easily create Windows groups that have specified levels of access (such as none, read-only, or read and write).</span></span>  
  
 <span data-ttu-id="db8a7-114">有关使用特性的详细信息，请参阅[如何：使用 PrincipalPermissionAttribute 类限制访问](../../../../docs/framework/wcf/how-to-restrict-access-with-the-principalpermissionattribute-class.md)。</span><span class="sxs-lookup"><span data-stu-id="db8a7-114">For more information about using the attribute, see [How to: Restrict Access with the PrincipalPermissionAttribute Class](../../../../docs/framework/wcf/how-to-restrict-access-with-the-principalpermissionattribute-class.md).</span></span> <span data-ttu-id="db8a7-115">有关标识的详细信息，请参阅[服务标识和身份验证](../../../../docs/framework/wcf/feature-details/service-identity-and-authentication.md)。</span><span class="sxs-lookup"><span data-stu-id="db8a7-115">For more information about identity, see [Service Identity and Authentication](../../../../docs/framework/wcf/feature-details/service-identity-and-authentication.md).</span></span>  
  
## <a name="aspnet-membership-provider"></a><span data-ttu-id="db8a7-116">ASP.NET 成员身份提供程序</span><span class="sxs-lookup"><span data-stu-id="db8a7-116">ASP.NET Membership Provider</span></span>  
 <span data-ttu-id="db8a7-117">成员资格提供程序是 [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] 中的一项功能。</span><span class="sxs-lookup"><span data-stu-id="db8a7-117">A feature of [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] is the membership provider.</span></span> <span data-ttu-id="db8a7-118">虽然成员资格提供程序在技术上不是访问控制机制，但它允许通过限制可以访问服务终结点的可能标识的集来控制对服务的访问。</span><span class="sxs-lookup"><span data-stu-id="db8a7-118">Even though the membership provider is not technically an access control mechanism, it allows controlling access to the service by limiting the set of possible identities that can access the service's endpoint.</span></span> <span data-ttu-id="db8a7-119">成员资格功能包括一个可以用用户名/密码组合（允许网站用户开立该网站的帐户）来填充的数据库。</span><span class="sxs-lookup"><span data-stu-id="db8a7-119">The membership feature includes a database that can be populated with user name/password combinations that enable users of a Web site to establish accounts with the site.</span></span> <span data-ttu-id="db8a7-120">若要访问使用成员资格提供程序的服务，用户必须使用自己的用户名和密码登录。</span><span class="sxs-lookup"><span data-stu-id="db8a7-120">To access a service that uses the membership provider, a user must log on with his or her user name and password.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db8a7-121">您首先必须填充数据库使用[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]功能 WCF 服务才能使用它进行授权。</span><span class="sxs-lookup"><span data-stu-id="db8a7-121">You must first populate the database using the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] feature before a WCF service can use it for authorization purposes.</span></span>  
  
 <span data-ttu-id="db8a7-122">如果已拥有现有 [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] 网站的成员资格数据库并希望使相同的用户可以使用你的服务（使用相同的用户名和密码授权的），则也可以使用成员资格功能。</span><span class="sxs-lookup"><span data-stu-id="db8a7-122">You can also use the membership feature if you already have a membership database from an existing [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Web site and you want to enable the same users to use your service, authorized with the same user names and passwords.</span></span>  
  
 <span data-ttu-id="db8a7-123">有关使用 WCF 服务中的成员资格功能的详细信息，请参阅[如何：使用 ASP.NET 成员资格提供程序](../../../../docs/framework/wcf/feature-details/how-to-use-the-aspnet-membership-provider.md)。</span><span class="sxs-lookup"><span data-stu-id="db8a7-123">For more information about using the membership feature in a WCF service, see [How to: Use the ASP.NET Membership Provider](../../../../docs/framework/wcf/feature-details/how-to-use-the-aspnet-membership-provider.md).</span></span>  
  
## <a name="aspnet-role-provider"></a><span data-ttu-id="db8a7-124">ASP.NET 角色提供程序</span><span class="sxs-lookup"><span data-stu-id="db8a7-124">ASP.NET Role Provider</span></span>  
 <span data-ttu-id="db8a7-125">[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] 还有一项使用角色管理授权的功能。</span><span class="sxs-lookup"><span data-stu-id="db8a7-125">Another feature of [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] is the ability to manage authorization using roles.</span></span> <span data-ttu-id="db8a7-126">使用 [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] 角色提供程序，开发人员可以为用户创建角色，然后将每个用户分配给一个或多个角色。</span><span class="sxs-lookup"><span data-stu-id="db8a7-126">The [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] role provider enables a developer to create roles for users and to assign each user to a role or roles.</span></span> <span data-ttu-id="db8a7-127">与成员资格提供程序一样，角色和分配也存储在数据库中，而且可以使用由 [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] 角色提供程序的专门实现所提供的工具来进行填充。</span><span class="sxs-lookup"><span data-stu-id="db8a7-127">As with the membership provider, the roles and assignments are stored in a database, and can be populated using tools provided by a particular implementation of the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] role provider.</span></span> <span data-ttu-id="db8a7-128">作为成员资格功能，使用 WCF 开发人员信息可用于在数据库中授权服务用户角色。</span><span class="sxs-lookup"><span data-stu-id="db8a7-128">As with the membership feature, WCF developers can use the information in the database to authorize service users by roles.</span></span> <span data-ttu-id="db8a7-129">例如，他们可以将该角色提供程序与上述 `PrincipalPermissionAttribute` 访问控制机制结合使用。</span><span class="sxs-lookup"><span data-stu-id="db8a7-129">They can, for example, use the role provider in combination with the `PrincipalPermissionAttribute` access control mechanism described above.</span></span>  
  
 <span data-ttu-id="db8a7-130">此外可以使用[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]角色提供程序，如果你有一个现成[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]角色提供程序数据库，并想要在您的 WCF 服务中使用的规则和用户分配相同的组。</span><span class="sxs-lookup"><span data-stu-id="db8a7-130">You can also use the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] role provider if you have an existing [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] role provider database and want to use the same set of rules and user assignments in your WCF service.</span></span>  
  
 <span data-ttu-id="db8a7-131">有关使用角色提供程序功能的详细信息，请参阅[如何：与服务一起使用 ASP.NET 角色提供程序](../../../../docs/framework/wcf/feature-details/how-to-use-the-aspnet-role-provider-with-a-service.md)。</span><span class="sxs-lookup"><span data-stu-id="db8a7-131">For more information about using the role provider feature, see [How to: Use the ASP.NET Role Provider with a Service](../../../../docs/framework/wcf/feature-details/how-to-use-the-aspnet-role-provider-with-a-service.md).</span></span>  
  
## <a name="authorization-manager"></a><span data-ttu-id="db8a7-132">授权管理器</span><span class="sxs-lookup"><span data-stu-id="db8a7-132">Authorization Manager</span></span>  
 <span data-ttu-id="db8a7-133">另一个功能将授权管理器 (AzMan) 与 [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] 角色提供程序结合在一起对客户端进行授权。</span><span class="sxs-lookup"><span data-stu-id="db8a7-133">Another feature combines the Authorization Manager (AzMan) with the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] role provider to authorize clients.</span></span> <span data-ttu-id="db8a7-134">当 [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] 承载 Web 服务时，可以将 AzMan 集成到应用程序中，以便可以通过 AzMan 完成向服务的授权。</span><span class="sxs-lookup"><span data-stu-id="db8a7-134">When [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] hosts a Web service, AzMan can be integrated into the application so that authorization to the service is done through AzMan.</span></span> [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] <span data-ttu-id="db8a7-135">角色管理器提供了一个 API，该 API 使您能够管理应用程序角色、在角色中添加和移除用户以及检查角色的成员资格，但不允许您查询用户是否经授权可执行命名的任务或操作。</span><span class="sxs-lookup"><span data-stu-id="db8a7-135">role manager provides an API that enables you to manage application roles, add and remove users from roles, and check role membership, but it does not allow you to query whether a user is authorized to perform a named task or operation.</span></span> <span data-ttu-id="db8a7-136">AzMan 允许您定义单个操作，然后将这些操作组合成任务。</span><span class="sxs-lookup"><span data-stu-id="db8a7-136">AzMan allows you to define individual operations and combine them into tasks.</span></span> <span data-ttu-id="db8a7-137">使用 AZMan，除了可以执行角色检查以外，还可以检查用户是否可以执行某项任务。</span><span class="sxs-lookup"><span data-stu-id="db8a7-137">With AZMan, in addition to role checks, you can also check whether a user can perform a task.</span></span> <span data-ttu-id="db8a7-138">角色分配和任务授权可以在应用程序外部配置，也可以在应用程序内部以编程方式执行。</span><span class="sxs-lookup"><span data-stu-id="db8a7-138">Role assignment and task authorization can be configured outside of the application or performed programmatically within the application.</span></span> <span data-ttu-id="db8a7-139">使用 AzMan 管理 Microsoft 管理控制台 (MMC) 管理单元，管理员可以更改角色可以在运行时执行的任务，还可以管理每个用户的角色成员资格。</span><span class="sxs-lookup"><span data-stu-id="db8a7-139">The AzMan administration Microsoft Management Console (MMC) snap-in allows administrators to change the tasks a role can perform at run time and to manage each user's membership of roles.</span></span>  
  
 <span data-ttu-id="db8a7-140">如果已拥有对现有 AzMan 安装的访问权并希望使用 AzMan/角色提供程序组合功能向服务用户进行授权，则也可以使用 AzMan 和 [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] 角色提供程序。</span><span class="sxs-lookup"><span data-stu-id="db8a7-140">You can also use AzMan and the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] role provider if you already have access to an existing AzMan installation and want to authorize your service users using the features of the AzMan/role provider combination.</span></span>  
  
 <span data-ttu-id="db8a7-141">详细了解 AzMan 和[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]角色提供程序，请参阅[How To:使用授权管理器 (AzMan) 与 ASP.NET 2.0](https://go.microsoft.com/fwlink/?LinkId=88951)。</span><span class="sxs-lookup"><span data-stu-id="db8a7-141">For more information about AzMan and the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] role provider, see [How To: Use Authorization Manager (AzMan) with ASP.NET 2.0](https://go.microsoft.com/fwlink/?LinkId=88951).</span></span> <span data-ttu-id="db8a7-142">有关为 WCF 服务使用 AzMan 和角色提供程序的详细信息，请参阅[如何：将 ASP.NET 授权管理器角色提供程序用于服务](../../../../docs/framework/wcf/feature-details/how-to-use-the-aspnet-authorization-manager-role-provider-with-a-service.md)。</span><span class="sxs-lookup"><span data-stu-id="db8a7-142">For more information about using AzMan and the role provider for WCF services, see [How to: Use the ASP.NET Authorization Manager Role Provider with a Service](../../../../docs/framework/wcf/feature-details/how-to-use-the-aspnet-authorization-manager-role-provider-with-a-service.md).</span></span>  
  
## <a name="identity-model"></a><span data-ttu-id="db8a7-143">标识模型</span><span class="sxs-lookup"><span data-stu-id="db8a7-143">Identity Model</span></span>  
 <span data-ttu-id="db8a7-144">标识模型是一组 API，可以用于管理用于向客户端授权的声明和策略。</span><span class="sxs-lookup"><span data-stu-id="db8a7-144">The Identity Model is a set of APIs that enable you to manage claims and policies to authorize clients.</span></span> <span data-ttu-id="db8a7-145">使用标识模型，可以检查包含在调用方用于将其自身向服务进行身份验证的凭据中的每个声明，将这些声明与服务策略的集进行比较，然后基于比较结果授予或拒绝访问权限。</span><span class="sxs-lookup"><span data-stu-id="db8a7-145">With the Identity Model, you can examine every claim contained in credentials that the caller used to authenticate itself to the service, compare the claims to the set of policies for the service, and grant or deny access based on the comparison.</span></span>  
  
 <span data-ttu-id="db8a7-146">如果在授予访问权限之前需要良好的控制以及可以设置特定的条件，请使用标识模型。</span><span class="sxs-lookup"><span data-stu-id="db8a7-146">Use the Identity Model if you need fine control and the ability to set specific criteria before granting access.</span></span> <span data-ttu-id="db8a7-147">例如，在使用 <xref:System.Security.Permissions.PrincipalPermissionAttribute> 时，标准不过是对用户的标识进行身份验证以及该用户标识属于特定的角色。</span><span class="sxs-lookup"><span data-stu-id="db8a7-147">For example, when using the <xref:System.Security.Permissions.PrincipalPermissionAttribute>, the criterion is simply that the identity of the user is authenticated and belongs to a specific role.</span></span> <span data-ttu-id="db8a7-148">相比之下，使用标识模型，您可以创建如下策略：规定用户必须年满 18 周岁，并且必须持有有效的驾驶执照才准许查看文档。</span><span class="sxs-lookup"><span data-stu-id="db8a7-148">In contrast, using the Identity Model, you can create a policy that states the user must be over 18 years of age and possesses a valid driver's license before being allowed to view a document.</span></span>  
  
 <span data-ttu-id="db8a7-149">您可以从标识模型基于声明的访问控制中获益的一个示例是在颁发的令牌方案中使用联合身份验证凭据的情形。</span><span class="sxs-lookup"><span data-stu-id="db8a7-149">One example where you can benefit from the Identity Model claim-based access control is when using federation credentials in the issued token scenario.</span></span> <span data-ttu-id="db8a7-150">有关联合身份验证和已颁发的令牌的详细信息，请参阅[联合身份验证和颁发令牌](../../../../docs/framework/wcf/feature-details/federation-and-issued-tokens.md)。</span><span class="sxs-lookup"><span data-stu-id="db8a7-150">For more information about federation and issued tokens, see [Federation and Issued Tokens](../../../../docs/framework/wcf/feature-details/federation-and-issued-tokens.md).</span></span>  
  
 <span data-ttu-id="db8a7-151">有关标识模型的详细信息，请参阅[管理声明和使用标识模型的授权](../../../../docs/framework/wcf/feature-details/managing-claims-and-authorization-with-the-identity-model.md)。</span><span class="sxs-lookup"><span data-stu-id="db8a7-151">For more information about the Identity Model, see [Managing Claims and Authorization with the Identity Model](../../../../docs/framework/wcf/feature-details/managing-claims-and-authorization-with-the-identity-model.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="db8a7-152">请参阅</span><span class="sxs-lookup"><span data-stu-id="db8a7-152">See also</span></span>
- <xref:System.Security.Permissions.PrincipalPermissionAttribute>
- [<span data-ttu-id="db8a7-153">如何：使用 PrincipalPermissionAttribute 类限制访问</span><span class="sxs-lookup"><span data-stu-id="db8a7-153">How to: Restrict Access with the PrincipalPermissionAttribute Class</span></span>](../../../../docs/framework/wcf/how-to-restrict-access-with-the-principalpermissionattribute-class.md)
- [<span data-ttu-id="db8a7-154">如何：与服务一起使用 ASP.NET 角色提供程序</span><span class="sxs-lookup"><span data-stu-id="db8a7-154">How to: Use the ASP.NET Role Provider with a Service</span></span>](../../../../docs/framework/wcf/feature-details/how-to-use-the-aspnet-role-provider-with-a-service.md)
- [<span data-ttu-id="db8a7-155">如何：将用于服务 ASP.NET 授权管理器角色提供程序</span><span class="sxs-lookup"><span data-stu-id="db8a7-155">How to: Use the ASP.NET Authorization Manager Role Provider with a Service</span></span>](../../../../docs/framework/wcf/feature-details/how-to-use-the-aspnet-authorization-manager-role-provider-with-a-service.md)
- [<span data-ttu-id="db8a7-156">使用标识模型管理声明和授权</span><span class="sxs-lookup"><span data-stu-id="db8a7-156">Managing Claims and Authorization with the Identity Model</span></span>](../../../../docs/framework/wcf/feature-details/managing-claims-and-authorization-with-the-identity-model.md)
- [<span data-ttu-id="db8a7-157">委托和模拟</span><span class="sxs-lookup"><span data-stu-id="db8a7-157">Delegation and Impersonation</span></span>](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md)
