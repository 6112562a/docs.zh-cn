---
title: 使用 NAT 和防火墙
ms.date: 03/30/2017
helpviewer_keywords:
- firewalls [WCF]
- NATs [WCF]
ms.assetid: 74db0632-1bf0-428b-89c8-bd53b64332e7
ms.openlocfilehash: b8be10740c8e92d3dac7094f07b3372e8d78a3d9
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/24/2020
ms.locfileid: "76743870"
---
# <a name="working-with-nats-and-firewalls"></a><span data-ttu-id="0c7ef-102">使用 NAT 和防火墙</span><span class="sxs-lookup"><span data-stu-id="0c7ef-102">Working with NATs and Firewalls</span></span>
<span data-ttu-id="0c7ef-103">网络连接的客户端和服务器通常不具有用于进行通信的直接和开放的路径。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-103">The client and server of a network connection frequently do not have a direct and open path for communication.</span></span> <span data-ttu-id="0c7ef-104">数据包在终结点计算机和网络中的中间计算机上进行筛选、路由、分析和转换。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-104">Packets are filtered, routed, analyzed, and transformed both on the endpoint machines and by intermediate machines on the network.</span></span> <span data-ttu-id="0c7ef-105">网络地址转换 (NAT) 和防火墙是可以参与网络通信的中间应用程序的常见示例。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-105">Network address translations (NATs) and firewalls are common examples of intermediate applications that can participate in network communication.</span></span>  
  
 <span data-ttu-id="0c7ef-106">Windows Communication Foundation （WCF）传输和消息交换模式（Mep）的响应方式与 Nat 和防火墙的状态不同。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-106">Windows Communication Foundation (WCF) transports, and message exchange patterns (MEPs) react differently to, the presence of NATs and firewalls.</span></span> <span data-ttu-id="0c7ef-107">本主题介绍 NAT 和防火墙在常见网络拓扑中是如何工作的。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-107">This topic describes how NATs and firewalls function in common network topologies.</span></span> <span data-ttu-id="0c7ef-108">给定 WCF 传输和 Mep 的特定组合的建议，可帮助使应用程序更可靠地用于网络上的 Nat 和防火墙。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-108">Recommendations for specific combinations of WCF transports and MEPs are given that help make your applications more robust to NATs and firewalls on the network.</span></span>  
  
## <a name="how-nats-affect-communication"></a><span data-ttu-id="0c7ef-109">NAT 如何影响通信</span><span class="sxs-lookup"><span data-stu-id="0c7ef-109">How NATs Affect Communication</span></span>  
 <span data-ttu-id="0c7ef-110">创建 NAT 的目的是使数台计算机能够共享单个外部 IP 地址。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-110">NAT was created to enable several machines to share a single external IP address.</span></span> <span data-ttu-id="0c7ef-111">端口重新映射 NAT 将连接的内部 IP 地址和端口映射到具有新端口号的外部 IP 地址。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-111">A port-remapping NAT maps an internal IP address and port for a connection to an external IP address with a new port number.</span></span> <span data-ttu-id="0c7ef-112">新端口号使 NAT 可以将返回通信与原始通信相互关联。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-112">The new port number allows the NAT to correlate return traffic with the original communication.</span></span> <span data-ttu-id="0c7ef-113">很多家庭用户现在拥有只能以专用方式路由的 IP 地址，并且依赖于 NAT 来提供数据包的全局路由。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-113">Many home users now have an IP address that is only privately routable and rely on a NAT to provide global routing of packets.</span></span>  
  
 <span data-ttu-id="0c7ef-114">NAT 不提供安全边界。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-114">A NAT does not provide a security boundary.</span></span> <span data-ttu-id="0c7ef-115">但是，常见 NAT 配置能够防止内部计算机被直接寻址。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-115">However, common NAT configurations prevent the internal machines from being directly addressed.</span></span> <span data-ttu-id="0c7ef-116">这不仅可以防止内部计算机参与一些不需要的连接，而且增加了编写必须将数据异步发回客户端的服务器应用程序的难度。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-116">This both protects the internal machines from some unwanted connections and makes it difficult to write server applications that must asynchronously send data back to the client.</span></span> <span data-ttu-id="0c7ef-117">NAT 将地址重新写入数据包，以便制造连接源于 NAT 计算机的假象。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-117">The NAT rewrites the addresses in packets to make it seem like connections are originating at the NAT machine.</span></span> <span data-ttu-id="0c7ef-118">这导致服务器在试图打开通往客户端的反向连接时失败。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-118">This causes the server to fail when it attempts to open a connection back to the client.</span></span> <span data-ttu-id="0c7ef-119">如果服务器使用觉察到的客户端地址，则会因为该客户端地址无法公开路由而失败。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-119">If the server uses the client's perceived address, it fails because the client address cannot be publicly routed.</span></span> <span data-ttu-id="0c7ef-120">如果服务器使用 NAT 地址，则会因为没有应用程序正在该计算机上侦听而无法连接。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-120">If the server uses the NAT address, it fails to connect because no application is listening on that machine.</span></span>  
  
 <span data-ttu-id="0c7ef-121">某些 NAT 支持配置转发规则，以使外部计算机可以连接到特定的内部计算机。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-121">Some NATs support the configuration of forwarding rules to allow external machines to connect to a particular internal machine.</span></span> <span data-ttu-id="0c7ef-122">对于不同的 NAT，有关配置转发规则的说明也各异；而且，对于大多数应用程序来说，要求最终用户更改其 NAT 配置都不是值得推荐的做法。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-122">The instructions for configuring forwarding rules varies among different NATs, and asking end users to change their NAT configuration is not recommended for most applications.</span></span> <span data-ttu-id="0c7ef-123">很多最终用户无法或者不希望针对特定应用程序更改他们的 NAT 配置。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-123">Many end users either cannot or do not want to change their NAT configuration for a particular application.</span></span>  
  
## <a name="how-firewalls-affect-communication"></a><span data-ttu-id="0c7ef-124">防火墙如何影响通信</span><span class="sxs-lookup"><span data-stu-id="0c7ef-124">How Firewalls Affect Communication</span></span>  
 <span data-ttu-id="0c7ef-125">*防火墙*是一种软件或硬件设备，可将规则应用于传递到的流量，以决定是允许还是拒绝发送。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-125">A *firewall* is a software or hardware device that applies rules to the traffic passing through to decide whether to allow or deny passage.</span></span> <span data-ttu-id="0c7ef-126">可以配置防火墙以检查传入和/或传出的通信流。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-126">You can configure firewalls to examine incoming and/or outgoing streams of traffic.</span></span> <span data-ttu-id="0c7ef-127">防火墙在网络边缘或终结点宿主上为网络提供了安全边界。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-127">The firewall provides a security boundary for the network at either the edge of the network or on the endpoint host.</span></span> <span data-ttu-id="0c7ef-128">企业用户传统上将其服务器放在防火墙后面，以防止恶意攻击。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-128">Business users have traditionally kept their servers behind a firewall to prevent malicious attacks.</span></span> <span data-ttu-id="0c7ef-129">自从在 [!INCLUDE[wxpsp2](../../../../includes/wxpsp2-md.md)] 中引入了个人防火墙以来，位于防火墙后面的家庭用户的数量也已经大大增加。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-129">Since the introduction of the personal firewall in [!INCLUDE[wxpsp2](../../../../includes/wxpsp2-md.md)], the number of home users behind a firewall has greatly increased as well.</span></span> <span data-ttu-id="0c7ef-130">这样，很可能连接的一端或两端具有检查数据包的防火墙。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-130">This makes it likely that one or both ends of a connection have a firewall examining packets.</span></span>  
  
 <span data-ttu-id="0c7ef-131">防火墙在其复杂性以及检查数据包的能力方面差异极大。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-131">Firewalls vary greatly in terms of their complexity and capability for examining packets.</span></span> <span data-ttu-id="0c7ef-132">简单防火墙基于数据包中的源和目标地址以及端口应用规则。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-132">Simple firewalls apply rules based on the source and destination addresses and ports in packets.</span></span> <span data-ttu-id="0c7ef-133">智能防火墙还可以检查数据包的内容以便做出决定。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-133">Intelligent firewalls can also examine the contents of packets to make decisions.</span></span> <span data-ttu-id="0c7ef-134">这些防火墙具有很多不同配置，并且通常用于专用应用程序。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-134">These firewalls come in many different configurations and are often used for specialized applications.</span></span>  
  
 <span data-ttu-id="0c7ef-135">家庭用户防火墙的常见配置是禁止传入连接，除非以前与该计算机之间建立过传出连接。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-135">A common configuration for a home user firewall is to prohibit incoming connections unless an outgoing connection was made to that machine previously.</span></span> <span data-ttu-id="0c7ef-136">企业用户防火墙的常见配置是在所有端口上禁止传入连接，除非该连接来自专门标识的组。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-136">A common configuration for a business user firewall is to prohibit incoming connections on all ports except a group specifically identified.</span></span> <span data-ttu-id="0c7ef-137">这方面的一个示例是这样一个防火墙，它在除端口 80 和 443 以外的所有端口上禁止连接，以便提供 HTTP 和 HTTPS 服务。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-137">An example is a firewall that prohibits connections on all ports except for ports 80 and 443 to provide HTTP and HTTPS service.</span></span> <span data-ttu-id="0c7ef-138">家庭和企业用户都存在托管防火墙，它允许计算机上受信任的用户或进程更改防火墙配置。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-138">Managed firewalls exist for both home and business users that permit a trusted user or process on the machine to change the firewall configuration.</span></span> <span data-ttu-id="0c7ef-139">对于没有用于控制网络使用的公司策略的家庭用户而言，托管防火墙更为常见。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-139">Managed firewalls are more common for home users where there is no corporate policy controlling network usage.</span></span>  
  
## <a name="using-teredo"></a><span data-ttu-id="0c7ef-140">使用 Teredo</span><span class="sxs-lookup"><span data-stu-id="0c7ef-140">Using Teredo</span></span>  

 <span data-ttu-id="0c7ef-141">Teredo 是一种 IPv6 过渡技术，可用来对位于 NAT 后面的计算机进行直接寻址。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-141">Teredo is an IPv6 transition technology that enables the direct addressability of machines behind a NAT.</span></span> <span data-ttu-id="0c7ef-142">Teredo 依靠使用可以公开和全局路由的服务器来公布潜在的连接。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-142">Teredo relies on the use of a server that can be publicly and globally routed to advertise potential connections.</span></span> <span data-ttu-id="0c7ef-143">Teredo 服务器为应用程序客户端和服务器提供了一个公用的接头地点，以便它们可以交换连接信息。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-143">The Teredo server gives the application client and server a common meeting point at which they can exchange connection information.</span></span> <span data-ttu-id="0c7ef-144">然后，这些计算机请求一个临时 Teredo 地址，并且通过现有网络对数据包进行隧道路由。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-144">The machines then request a temporary Teredo address, and packets are tunneled through the existing network.</span></span> <span data-ttu-id="0c7ef-145">WCF 中的 Teredo 支持需要在操作系统中启用 IPv6 和 Teredo 支持。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-145">Teredo support in WCF requires enabling IPv6 and Teredo support in the operating system.</span></span> [!INCLUDE[wxp](../../../../includes/wxp-md.md)] <span data-ttu-id="0c7ef-146">和更高版本的操作系统支持 Teredo。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-146">and later operating systems support Teredo.</span></span> <span data-ttu-id="0c7ef-147">默认情况下，Windows Vista 和更高版本的操作系统支持 IPv6，并且仅要求用户启用 Teredo。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-147">Windows Vista and later operating systems support IPv6 by default and only require the user to enable Teredo.</span></span> [!INCLUDE[wxpsp2](../../../../includes/wxpsp2-md.md)] <span data-ttu-id="0c7ef-148">和 Windows Server 2003 要求用户同时启用 IPv6 和 Teredo。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-148">and Windows Server 2003 require the user to enable both IPv6 and Teredo.</span></span> <span data-ttu-id="0c7ef-149">有关详细信息，请参阅[Teredo 概述](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-xp/bb457011(v%3dtechnet.10))。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-149">For more information, see the [Teredo Overview](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-xp/bb457011(v%3dtechnet.10)).</span></span>  
  
## <a name="choosing-a-transport-and-message-exchange-pattern"></a><span data-ttu-id="0c7ef-150">选择传输协议和消息交换模式</span><span class="sxs-lookup"><span data-stu-id="0c7ef-150">Choosing a Transport and Message Exchange Pattern</span></span>  
 <span data-ttu-id="0c7ef-151">选择传输协议和 MEP 的过程分为三步：</span><span class="sxs-lookup"><span data-stu-id="0c7ef-151">Selecting a transport and MEP is a three-step process:</span></span>  
  
1. <span data-ttu-id="0c7ef-152">分析终结点计算机的可寻址性。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-152">Analyze the addressability of the endpoint machines.</span></span> <span data-ttu-id="0c7ef-153">企业服务器通常具有直接可寻址性，而最终用户通常让 NAT 阻止他们的可寻址性。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-153">Enterprise servers commonly have direct addressability, while end users commonly have their addressability blocked by NATs.</span></span> <span data-ttu-id="0c7ef-154">如果两个终结点都位于 NAT 后面（例如，最终用户之间的对等方案），那么可能需要使用像 Teredo 这样的技术来提供可寻址性。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-154">If both endpoints are behind a NAT, such as in peer-to-peer scenarios between end users, then you might need a technology such as Teredo to provide addressability.</span></span>  
  
2. <span data-ttu-id="0c7ef-155">分析终结点计算机的协议和端口限制。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-155">Analyze the protocol and port restrictions of the endpoint machines.</span></span> <span data-ttu-id="0c7ef-156">企业服务器通常位于阻止很多端口的强大防火墙后面。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-156">Enterprise servers are typically behind strong firewalls that block many ports.</span></span> <span data-ttu-id="0c7ef-157">但是，通常开放端口 80 以允许 HTTP 通信，开放端口 443 以允许 HTTPS 通信。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-157">However, port 80 is frequently open to permit HTTP traffic, and port 443 is open to permit HTTPS traffic.</span></span> <span data-ttu-id="0c7ef-158">最终用户不太可能具有端口限制，但可能位于只允许传出连接的防火墙后面。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-158">End users are less likely to have port restrictions but might be behind a firewall that permits only outgoing connections.</span></span> <span data-ttu-id="0c7ef-159">一些防火墙允许由终结点上的应用程序进行管理，以便有选择地开放连接。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-159">Some firewalls permit management by applications on the endpoint to selectively open connections.</span></span>  
  
3. <span data-ttu-id="0c7ef-160">计算网络的可寻址性和端口限制所允许的传输协议和 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-160">Compute the transports and MEPs that the addressability and port restrictions of the network permit.</span></span>  
  
 <span data-ttu-id="0c7ef-161">客户端-服务器应用程序的一种常见拓扑是让位于 NAT 后面且没有 Teredo 的客户端位于仅出站防火墙的后面，让可直接寻址的服务器位于强大防火墙后面。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-161">A common topology for client-server applications is to have clients that are behind a NAT without Teredo with an outbound-only firewall and a server that is directly addressable with a strong firewall.</span></span> <span data-ttu-id="0c7ef-162">在此方案中，使用双工 MEP 的 TCP 传输协议和使用请求-答复 MEP 的 HTTP 传输协议都能正常工作。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-162">In this scenario, the TCP transport with a duplex MEP and an HTTP transport with a request-reply MEP work well.</span></span> <span data-ttu-id="0c7ef-163">对等应用程序的一种常见拓扑是让两个终结点都位于 NAT 和防火墙的后面。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-163">A common topology for peer-to-peer applications is to have both endpoints behind NATs and firewalls.</span></span> <span data-ttu-id="0c7ef-164">在此方案以及网络拓扑未知的其他方案中，请考虑下面的建议：</span><span class="sxs-lookup"><span data-stu-id="0c7ef-164">In this scenario, and in scenarios where the network topology is unknown, consider the following recommendations:</span></span>  
  
- <span data-ttu-id="0c7ef-165">不要使用双向传输协议。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-165">Do not use dual transports.</span></span> <span data-ttu-id="0c7ef-166">双向传输协议会打开更多连接，从而降低成功连接的可能性。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-166">A dual transport opens more connections, which reduces the chance of connecting successfully.</span></span>  
  
- <span data-ttu-id="0c7ef-167">支持在发起连接上建立反向通道。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-167">Support establishing back channels over the originating connection.</span></span> <span data-ttu-id="0c7ef-168">使用反向通道（例如，在双工 TCP 中）会打开较少的连接，从而提高成功连接的可能性。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-168">Using back channels, such as in duplex TCP, opens fewer connections, which increases the chance of connecting successfully.</span></span>  
  
- <span data-ttu-id="0c7ef-169">采用可访问的服务来注册终结点或中继通信。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-169">Employ a reachable service for either registering endpoints or relaying traffic.</span></span> <span data-ttu-id="0c7ef-170">使用可全局访问的连接服务（例如，Teredo 服务器）可以在网络拓扑具有限制性或未知时大大提高成功连接的可能性。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-170">Using a globally reachable connection service, such as a Teredo server, greatly increases the chance of connecting successfully when the network topology is restrictive or unknown.</span></span>  
  
 <span data-ttu-id="0c7ef-171">下表检查 WCF 中的单向、请求-答复和双工 Mep，以及标准 TCP、具有 Teredo 的 TCP 和双 HTTP 传输。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-171">The following tables examine the one-way, request-reply, and duplex MEPs, and the standard TCP, TCP with Teredo, and standard and dual HTTP transports in WCF.</span></span>  
  
|<span data-ttu-id="0c7ef-172">可寻址性</span><span class="sxs-lookup"><span data-stu-id="0c7ef-172">Addressability</span></span>|<span data-ttu-id="0c7ef-173">服务器直达</span><span class="sxs-lookup"><span data-stu-id="0c7ef-173">Server Direct</span></span>|<span data-ttu-id="0c7ef-174">使用 NAT 遍历的服务器直达</span><span class="sxs-lookup"><span data-stu-id="0c7ef-174">Server Direct with NAT traversal</span></span>|<span data-ttu-id="0c7ef-175">服务器 NAT</span><span class="sxs-lookup"><span data-stu-id="0c7ef-175">Server NAT</span></span>|<span data-ttu-id="0c7ef-176">使用 NAT 遍历的服务器 NAT</span><span class="sxs-lookup"><span data-stu-id="0c7ef-176">Server NAT with NAT traversal</span></span>|  
|--------------------|-------------------|--------------------------------------|----------------|-----------------------------------|  
|<span data-ttu-id="0c7ef-177">客户端直达</span><span class="sxs-lookup"><span data-stu-id="0c7ef-177">Client direct</span></span>|<span data-ttu-id="0c7ef-178">任何传输协议和 MEP</span><span class="sxs-lookup"><span data-stu-id="0c7ef-178">Any transport and MEP</span></span>|<span data-ttu-id="0c7ef-179">任何传输协议和 MEP</span><span class="sxs-lookup"><span data-stu-id="0c7ef-179">Any transport and MEP</span></span>|<span data-ttu-id="0c7ef-180">不支持。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-180">Not supported.</span></span>|<span data-ttu-id="0c7ef-181">不支持。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-181">Not supported.</span></span>|  
|<span data-ttu-id="0c7ef-182">使用 NAT 遍历的客户端直达</span><span class="sxs-lookup"><span data-stu-id="0c7ef-182">Client direct with NAT traversal</span></span>|<span data-ttu-id="0c7ef-183">任何传输协议和 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-183">Any transport and MEP.</span></span>|<span data-ttu-id="0c7ef-184">任何传输协议和 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-184">Any transport and MEP.</span></span>|<span data-ttu-id="0c7ef-185">不支持。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-185">Not supported.</span></span>|<span data-ttu-id="0c7ef-186">使用 Teredo 的 TCP 和任何 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-186">TCP with Teredo and any MEP.</span></span> <span data-ttu-id="0c7ef-187">Windows Vista 提供了计算机范围的配置选项以支持使用 Teredo 的 HTTP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-187">Windows Vista has a machine-wide configuration option to support HTTP with Teredo.</span></span>|  
|<span data-ttu-id="0c7ef-188">客户端 NAT</span><span class="sxs-lookup"><span data-stu-id="0c7ef-188">Client NAT</span></span>|<span data-ttu-id="0c7ef-189">任何非双向传输协议和 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-189">Any non-dual transport and MEP.</span></span> <span data-ttu-id="0c7ef-190">双工 MEP 需要 TCP 传输协议。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-190">Duplex MEP requires TCP transport.</span></span>|<span data-ttu-id="0c7ef-191">任何非双向传输协议和 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-191">Any non-dual transport and MEP.</span></span> <span data-ttu-id="0c7ef-192">双工 MEP 需要 TCP 传输协议。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-192">Duplex MEP requires TCP transport.</span></span>|<span data-ttu-id="0c7ef-193">不支持。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-193">Not supported.</span></span>|<span data-ttu-id="0c7ef-194">不支持。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-194">Not supported.</span></span>|  
|<span data-ttu-id="0c7ef-195">使用 NAT 遍历的客户端 NAT</span><span class="sxs-lookup"><span data-stu-id="0c7ef-195">Client NAT with NAT traversal</span></span>|<span data-ttu-id="0c7ef-196">任何非双向传输协议和 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-196">Any non-dual transport and MEP.</span></span> <span data-ttu-id="0c7ef-197">双工 MEP 需要 TCP 传输协议。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-197">Duplex MEP requires TCP transport.</span></span>|<span data-ttu-id="0c7ef-198">除双向 HTTP 以外的所有传输协议和任何 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-198">All but dual HTTP and any MEP.</span></span> <span data-ttu-id="0c7ef-199">双工 MEP 需要 TCP 传输协议。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-199">Duplex MEP requires TCP transport.</span></span> <span data-ttu-id="0c7ef-200">双向 TCP 传输协议需要 Teredo。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-200">Dual TCP transport requires Teredo.</span></span> <span data-ttu-id="0c7ef-201">Windows Vista 提供了计算机范围的配置选项以支持使用 Teredo 的 HTTP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-201">Windows Vista has a machine-wide configuration option to support HTTP with Teredo.</span></span>|<span data-ttu-id="0c7ef-202">不支持。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-202">Not supported.</span></span>|<span data-ttu-id="0c7ef-203">使用 Teredo 的 TCP 和任何 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-203">TCP with Teredo and any MEP.</span></span> <span data-ttu-id="0c7ef-204">Windows Vista 提供了计算机范围的配置选项以支持使用 Teredo 的 HTTP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-204">Windows Vista has a machine-wide configuration option to support HTTP with Teredo.</span></span>|  
  
|<span data-ttu-id="0c7ef-205">防火墙限制</span><span class="sxs-lookup"><span data-stu-id="0c7ef-205">Firewall restrictions</span></span>|<span data-ttu-id="0c7ef-206">服务器开放</span><span class="sxs-lookup"><span data-stu-id="0c7ef-206">Server open</span></span>|<span data-ttu-id="0c7ef-207">使用托管防火墙的服务器</span><span class="sxs-lookup"><span data-stu-id="0c7ef-207">Server with managed firewall</span></span>|<span data-ttu-id="0c7ef-208">使用仅 HTTP 防火墙的服务器</span><span class="sxs-lookup"><span data-stu-id="0c7ef-208">Server with HTTP-only firewall</span></span>|<span data-ttu-id="0c7ef-209">使用仅出站防火墙的服务器</span><span class="sxs-lookup"><span data-stu-id="0c7ef-209">Server with outbound-only firewall</span></span>|  
|---------------------------|-----------------|----------------------------------|-------------------------------------|-----------------------------------------|  
|<span data-ttu-id="0c7ef-210">客户端开放</span><span class="sxs-lookup"><span data-stu-id="0c7ef-210">Client Open</span></span>|<span data-ttu-id="0c7ef-211">任何传输协议和 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-211">Any transport and MEP.</span></span>|<span data-ttu-id="0c7ef-212">任何传输协议和 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-212">Any transport and MEP.</span></span>|<span data-ttu-id="0c7ef-213">任何 HTTP 传输协议和 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-213">Any HTTP transport and MEP.</span></span>|<span data-ttu-id="0c7ef-214">不支持。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-214">Not supported.</span></span>|  
|<span data-ttu-id="0c7ef-215">使用托管防火墙的客户端</span><span class="sxs-lookup"><span data-stu-id="0c7ef-215">Client with managed firewall</span></span>|<span data-ttu-id="0c7ef-216">任何非双向传输协议和 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-216">Any non-dual transport and MEP.</span></span> <span data-ttu-id="0c7ef-217">双工 MEP 需要 TCP 传输协议。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-217">Duplex MEP requires TCP transport.</span></span>|<span data-ttu-id="0c7ef-218">任何非双向传输协议和 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-218">Any non-dual transport and MEP.</span></span> <span data-ttu-id="0c7ef-219">双工 MEP 需要 TCP 传输协议。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-219">Duplex MEP requires TCP transport.</span></span>|<span data-ttu-id="0c7ef-220">任何 HTTP 传输协议和 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-220">Any HTTP transport and MEP.</span></span>|<span data-ttu-id="0c7ef-221">不支持。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-221">Not supported.</span></span>|  
|<span data-ttu-id="0c7ef-222">使用仅 HTTP 防火墙的客户端</span><span class="sxs-lookup"><span data-stu-id="0c7ef-222">Client with HTTP-only firewall</span></span>|<span data-ttu-id="0c7ef-223">任何 HTTP 传输协议和 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-223">Any HTTP transport and MEP.</span></span>|<span data-ttu-id="0c7ef-224">任何 HTTP 传输协议和 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-224">Any HTTP transport and MEP.</span></span>|<span data-ttu-id="0c7ef-225">任何 HTTP 传输协议和 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-225">Any HTTP transport and MEP.</span></span>|<span data-ttu-id="0c7ef-226">不支持。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-226">Not supported.</span></span>|  
|<span data-ttu-id="0c7ef-227">使用仅出站防火墙的客户端</span><span class="sxs-lookup"><span data-stu-id="0c7ef-227">Client with outbound-only firewall</span></span>|<span data-ttu-id="0c7ef-228">任何非双向传输协议和 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-228">Any non-dual transport and MEP.</span></span> <span data-ttu-id="0c7ef-229">双工 MEP 需要 TCP 传输协议。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-229">Duplex MEP requires TCP transport.</span></span>|<span data-ttu-id="0c7ef-230">任何非双向传输协议和 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-230">Any non-dual transport and MEP.</span></span> <span data-ttu-id="0c7ef-231">双工 MEP 需要 TCP 传输协议。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-231">Duplex MEP requires TCP transport.</span></span>|<span data-ttu-id="0c7ef-232">任何 HTTP 传输协议和任何非双工 MEP。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-232">Any HTTP transport and any non-duplex MEP.</span></span>|<span data-ttu-id="0c7ef-233">不支持。</span><span class="sxs-lookup"><span data-stu-id="0c7ef-233">Not supported.</span></span>|
