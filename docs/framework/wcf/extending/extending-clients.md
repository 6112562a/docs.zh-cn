---
title: 扩展客户端
ms.date: 03/30/2017
helpviewer_keywords:
- proxy extensions [WCF]
ms.assetid: 1328c61c-06e5-455f-9ebd-ceefb59d3867
ms.openlocfilehash: 99b4dd5e4acfce8bea4d3c2cae3a53152585675d
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "61857930"
---
# <a name="extending-clients"></a><span data-ttu-id="80ddc-102">扩展客户端</span><span class="sxs-lookup"><span data-stu-id="80ddc-102">Extending Clients</span></span>
<span data-ttu-id="80ddc-103">在调用应用程序中，服务模型层负责将应用程序代码中的方法调用转换成出站消息、将它们推送到基础通道、将结果转换回应用程序代码中的返回值和 out 参数并将结果返回到调用方。</span><span class="sxs-lookup"><span data-stu-id="80ddc-103">In a calling application, the service model layer is responsible for translating method invocations in application code into outbound messages, pushing them to the underlying channels, translating results back into return values and out parameters in application code, and returning the results back to the caller.</span></span> <span data-ttu-id="80ddc-104">服务模型扩展将修改或实现执行或通信行为与功能，包括客户端或调度程序功能、自定义行为、消息和参数截获以及其他扩展功能。</span><span class="sxs-lookup"><span data-stu-id="80ddc-104">Service model extensions modify or implement execution or communication behavior and features involving client or dispatcher functionality, custom behaviors, message and parameter interception, and other extensibility functionality.</span></span>  
  
 <span data-ttu-id="80ddc-105">本主题介绍如何使用<xref:System.ServiceModel.Dispatcher.ClientRuntime>和<xref:System.ServiceModel.Dispatcher.ClientOperation>Windows Communication Foundation (WCF) 客户端应用程序，以修改默认执行行为的 WCF 客户端或若要截获或更改消息、 参数或返回值中的类之前或之后发送或从通道层检索它们。</span><span class="sxs-lookup"><span data-stu-id="80ddc-105">This topic describes how to use the <xref:System.ServiceModel.Dispatcher.ClientRuntime> and <xref:System.ServiceModel.Dispatcher.ClientOperation> classes in a Windows Communication Foundation (WCF) client application to modify the default execution behavior of a WCF client or to intercept or modify messages, parameters, or return values prior to or subsequent to sending or retrieving them from the channel layer.</span></span> <span data-ttu-id="80ddc-106">有关扩展服务运行时的详细信息，请参阅[扩展调度程序](../../../../docs/framework/wcf/extending/extending-dispatchers.md)。</span><span class="sxs-lookup"><span data-stu-id="80ddc-106">For more information about extending the service runtime, see [Extending Dispatchers](../../../../docs/framework/wcf/extending/extending-dispatchers.md).</span></span> <span data-ttu-id="80ddc-107">有关修改并将自定义对象插入到客户端运行时的行为的详细信息，请参阅[配置和扩展的运行时行为带有](../../../../docs/framework/wcf/extending/configuring-and-extending-the-runtime-with-behaviors.md)。</span><span class="sxs-lookup"><span data-stu-id="80ddc-107">For more information about the behaviors that modify and insert customization objects into the client runtime, see [Configuring and Extending the Runtime with Behaviors](../../../../docs/framework/wcf/extending/configuring-and-extending-the-runtime-with-behaviors.md).</span></span>  
  
## <a name="clients"></a><span data-ttu-id="80ddc-108">客户端</span><span class="sxs-lookup"><span data-stu-id="80ddc-108">Clients</span></span>  
 <span data-ttu-id="80ddc-109">在客户端，WCF 客户端对象或客户端通道将传出消息和操作结果返回给调用应用程序的传入消息转换为方法调用。</span><span class="sxs-lookup"><span data-stu-id="80ddc-109">On a client, a WCF client object or client channel converts method invocations into outgoing messages and incoming messages to operation results that are returned to the calling application.</span></span> <span data-ttu-id="80ddc-110">(有关客户端类型的详细信息，请参阅[WCF 客户端体系结构](../../../../docs/framework/wcf/feature-details/client-architecture.md)。)</span><span class="sxs-lookup"><span data-stu-id="80ddc-110">(For more information about client types, see [WCF Client Architecture](../../../../docs/framework/wcf/feature-details/client-architecture.md).)</span></span>  
  
 <span data-ttu-id="80ddc-111">WCF 客户端类型具有处理此终结点和操作级别功能的运行时类型。</span><span class="sxs-lookup"><span data-stu-id="80ddc-111">WCF client types have runtime types that handle this endpoint- and operation-level functionality.</span></span> <span data-ttu-id="80ddc-112">当应用程序调用操作时，<xref:System.ServiceModel.Dispatcher.ClientOperation> 会将出站对象转换为消息、处理拦截器、确认出站调用符合目标约定并将出站消息传递给 <xref:System.ServiceModel.Dispatcher.ClientRuntime>，而后者负责创建和管理出站通道（和双工服务情况下的入站通道）、处理额外的出站消息处理（比如标头修改）、处理双向消息拦截器以及将入站双向调用路由到相应的客户端 <xref:System.ServiceModel.Dispatcher.DispatchRuntime> 对象。</span><span class="sxs-lookup"><span data-stu-id="80ddc-112">When an application calls an operation, the <xref:System.ServiceModel.Dispatcher.ClientOperation> translates the outbound objects into a message, processes interceptors, confirms that the outbound call conforms to the target contract, and hands the outbound message to the <xref:System.ServiceModel.Dispatcher.ClientRuntime>, which is responsible for creating and managing outbound channels (and inbound channels in the case of duplex services), handling extra outbound message processing (such as header modification), processing message interceptors in both directions, and routing inbound duplex calls to the appropriate client-side <xref:System.ServiceModel.Dispatcher.DispatchRuntime> object.</span></span> <span data-ttu-id="80ddc-113">当消息（包括错误）返回到客户端时，<xref:System.ServiceModel.Dispatcher.ClientOperation> 和 <xref:System.ServiceModel.Dispatcher.ClientRuntime> 提供相似的服务。</span><span class="sxs-lookup"><span data-stu-id="80ddc-113">Both the <xref:System.ServiceModel.Dispatcher.ClientOperation> and <xref:System.ServiceModel.Dispatcher.ClientRuntime> provide similar services when messages (including faults) are returned to the client.</span></span>  
  
 <span data-ttu-id="80ddc-114">这两个运行时类是主要的扩展，以自定义 WCF 客户端对象和通道的处理。</span><span class="sxs-lookup"><span data-stu-id="80ddc-114">These two runtime classes are the main extension to customize the processing of WCF client objects and channels.</span></span> <span data-ttu-id="80ddc-115"><xref:System.ServiceModel.Dispatcher.ClientRuntime> 类允许用户截获和扩展约定中所有消息的客户端执行。</span><span class="sxs-lookup"><span data-stu-id="80ddc-115">The <xref:System.ServiceModel.Dispatcher.ClientRuntime> class allows users to intercept and extend client execution across all messages in the contract.</span></span> <span data-ttu-id="80ddc-116"><xref:System.ServiceModel.Dispatcher.ClientOperation> 类允许用户截获和扩展给定操作中所有消息的客户端执行。</span><span class="sxs-lookup"><span data-stu-id="80ddc-116">The <xref:System.ServiceModel.Dispatcher.ClientOperation> class allows users to intercept and extend client execution for all messages in a given operation.</span></span>  
  
 <span data-ttu-id="80ddc-117">修改属性或插入自定义可以通过使用约定、终结点和操作行为来完成。</span><span class="sxs-lookup"><span data-stu-id="80ddc-117">Modifying the properties or inserting customizations are done by using contract, endpoint, and operation behaviors.</span></span> <span data-ttu-id="80ddc-118">有关如何使用这些类型的行为来执行客户端运行时自定义设置的详细信息，请参阅[配置和扩展的运行时行为带有](../../../../docs/framework/wcf/extending/configuring-and-extending-the-runtime-with-behaviors.md)。</span><span class="sxs-lookup"><span data-stu-id="80ddc-118">For more information about how to use these types of behaviors to perform client runtime customizations, see [Configuring and Extending the Runtime with Behaviors](../../../../docs/framework/wcf/extending/configuring-and-extending-the-runtime-with-behaviors.md).</span></span>  
  
## <a name="scenarios"></a><span data-ttu-id="80ddc-119">方案</span><span class="sxs-lookup"><span data-stu-id="80ddc-119">Scenarios</span></span>  
 <span data-ttu-id="80ddc-120">扩展客户端系统有多个理由，包括：</span><span class="sxs-lookup"><span data-stu-id="80ddc-120">There a number of reasons to extend the client system, including:</span></span>  
  
-   <span data-ttu-id="80ddc-121">自定义消息验证。</span><span class="sxs-lookup"><span data-stu-id="80ddc-121">Custom Message Validation.</span></span> <span data-ttu-id="80ddc-122">用户可能需要强制消息对某些架构有效。</span><span class="sxs-lookup"><span data-stu-id="80ddc-122">A user may want to enforce that a message is valid for a certain schema.</span></span> <span data-ttu-id="80ddc-123">通过实现 <xref:System.ServiceModel.Dispatcher.IClientMessageInspector> 接口并将该实现分配给 <xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageInspectors%2A> 属性可以做到这一点。</span><span class="sxs-lookup"><span data-stu-id="80ddc-123">This can be done by implementing the <xref:System.ServiceModel.Dispatcher.IClientMessageInspector> interface and assigning the implementation to the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageInspectors%2A> property.</span></span> <span data-ttu-id="80ddc-124">相关示例，请参阅[如何：检查或修改客户端的消息](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-messages-on-the-client.md)和[如何：检查或修改客户端的消息](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-messages-on-the-client.md)。</span><span class="sxs-lookup"><span data-stu-id="80ddc-124">For examples, see [How to: Inspect or Modify Messages on the Client](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-messages-on-the-client.md) and [How to: Inspect or Modify Messages on the Client](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-messages-on-the-client.md).</span></span>  
  
-   <span data-ttu-id="80ddc-125">自定义消息日志记录。</span><span class="sxs-lookup"><span data-stu-id="80ddc-125">Custom Message Logging.</span></span> <span data-ttu-id="80ddc-126">用户可能需要检查和记录流过某个终结点的应用程序消息集。</span><span class="sxs-lookup"><span data-stu-id="80ddc-126">A user may want to inspect and log some set of application messages that flow through an endpoint.</span></span> <span data-ttu-id="80ddc-127">此操作也可以使用消息拦截器接口完成。</span><span class="sxs-lookup"><span data-stu-id="80ddc-127">This can also be accomplished with the message interceptor interfaces.</span></span>  
  
-   <span data-ttu-id="80ddc-128">自定义消息转换。</span><span class="sxs-lookup"><span data-stu-id="80ddc-128">Custom Message Transformations.</span></span> <span data-ttu-id="80ddc-129">用户可能需要在运行时对消息应用某些转换而不修改应用程序代码（例如，对于版本控制）。</span><span class="sxs-lookup"><span data-stu-id="80ddc-129">Rather than modifying application code, the user may want to apply certain transformations to the message in the runtime (for example, for versioning).</span></span> <span data-ttu-id="80ddc-130">此操作也可以使用消息拦截器接口完成。</span><span class="sxs-lookup"><span data-stu-id="80ddc-130">This can be accomplished, again, with the message interceptor interfaces.</span></span>  
  
-   <span data-ttu-id="80ddc-131">自定义数据模型。</span><span class="sxs-lookup"><span data-stu-id="80ddc-131">Custom Data Model.</span></span> <span data-ttu-id="80ddc-132">用户可能想要具有不支持默认情况下，WCF 中的数据或序列化模型 (即<xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType>， <xref:System.Xml.Serialization.XmlSerializer?displayProperty=nameWithType>，和<xref:System.ServiceModel.Channels.Message?displayProperty=nameWithType>对象)。</span><span class="sxs-lookup"><span data-stu-id="80ddc-132">A user may want to have a data or serialization model other than those supported by default in WCF (namely, <xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType>, <xref:System.Xml.Serialization.XmlSerializer?displayProperty=nameWithType>, and <xref:System.ServiceModel.Channels.Message?displayProperty=nameWithType> objects).</span></span> <span data-ttu-id="80ddc-133">这可以通过实现消息格式化程序接口来完成。</span><span class="sxs-lookup"><span data-stu-id="80ddc-133">This can be done by implementing the message formatter interfaces.</span></span> <span data-ttu-id="80ddc-134">有关更多信息，请参见 <xref:System.ServiceModel.Dispatcher.IClientMessageFormatter?displayProperty=nameWithType> 和 <xref:System.ServiceModel.Dispatcher.ClientOperation.Formatter%2A?displayProperty=nameWithType> 属性。</span><span class="sxs-lookup"><span data-stu-id="80ddc-134">For more information, see <xref:System.ServiceModel.Dispatcher.IClientMessageFormatter?displayProperty=nameWithType> and the <xref:System.ServiceModel.Dispatcher.ClientOperation.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
-   <span data-ttu-id="80ddc-135">自定义参数验证。</span><span class="sxs-lookup"><span data-stu-id="80ddc-135">Custom Parameter Validation.</span></span> <span data-ttu-id="80ddc-136">用户可能需要强制类型化参数有效（与 XML 相对）。</span><span class="sxs-lookup"><span data-stu-id="80ddc-136">A user may want to enforce that typed parameters are valid (as opposed to XML).</span></span> <span data-ttu-id="80ddc-137">可以使用参数检查器来完成此操作。</span><span class="sxs-lookup"><span data-stu-id="80ddc-137">This can be done using the parameter inspector interfaces.</span></span> <span data-ttu-id="80ddc-138">有关示例，请参见 [如何：检查或修改参数](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-parameters.md)或[客户端验证](../../../../docs/framework/wcf/samples/client-validation.md)。</span><span class="sxs-lookup"><span data-stu-id="80ddc-138">For an example, see [How to: Inspect or Modify Parameters](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-parameters.md) or [Client Validation](../../../../docs/framework/wcf/samples/client-validation.md).</span></span>  
  
### <a name="using-the-clientruntime-class"></a><span data-ttu-id="80ddc-139">使用 ClientRuntime 类</span><span class="sxs-lookup"><span data-stu-id="80ddc-139">Using the ClientRuntime Class</span></span>  
 <span data-ttu-id="80ddc-140"><xref:System.ServiceModel.Dispatcher.ClientRuntime> 类是一个扩展点，您可以将截获消息和扩展客户端行为的扩展对象添加到该扩展点。</span><span class="sxs-lookup"><span data-stu-id="80ddc-140">The <xref:System.ServiceModel.Dispatcher.ClientRuntime> class is an extensibility point to which you can add extension objects that intercept messages and extend client behavior.</span></span> <span data-ttu-id="80ddc-141">截获对象可以在特定的约定中处理所有消息，仅处理特定操作的消息，执行自定义通道初始化，以及实现其他自定义客户端应用程序行为。</span><span class="sxs-lookup"><span data-stu-id="80ddc-141">Interception objects can process all messages in a particular contract, process only messages for particular operations, perform custom channel initialization, and implement other custom client application behavior.</span></span>  
  
-   <span data-ttu-id="80ddc-142"><xref:System.ServiceModel.Dispatcher.ClientRuntime.CallbackDispatchRuntime%2A> 属性返回服务启动的回调客户端的调度运行时对象。</span><span class="sxs-lookup"><span data-stu-id="80ddc-142">The <xref:System.ServiceModel.Dispatcher.ClientRuntime.CallbackDispatchRuntime%2A> property returns the dispatch run-time object for service-initiated callback clients.</span></span>  
  
-   <span data-ttu-id="80ddc-143"><xref:System.ServiceModel.Dispatcher.ClientRuntime.OperationSelector%2A> 属性接受自定义操作选择器对象。</span><span class="sxs-lookup"><span data-stu-id="80ddc-143">The <xref:System.ServiceModel.Dispatcher.ClientRuntime.OperationSelector%2A> property accepts a custom operation selector object.</span></span>  
  
-   <span data-ttu-id="80ddc-144">使用 <xref:System.ServiceModel.Dispatcher.ClientRuntime.ChannelInitializers%2A> 属性可以添加检查或修改客户端通道的通道初始值设定项。</span><span class="sxs-lookup"><span data-stu-id="80ddc-144">The <xref:System.ServiceModel.Dispatcher.ClientRuntime.ChannelInitializers%2A> property enables the addition of a channel initializer that can inspect or modify the client channel.</span></span>  
  
-   <span data-ttu-id="80ddc-145"><xref:System.ServiceModel.Dispatcher.ClientRuntime.Operations%2A> 属性获取 <xref:System.ServiceModel.Dispatcher.ClientOperation> 对象的集合，您可以将提供特定于该操作的消息的功能的自定义消息拦截器添加到该集合。</span><span class="sxs-lookup"><span data-stu-id="80ddc-145">The <xref:System.ServiceModel.Dispatcher.ClientRuntime.Operations%2A> property gets a collection of <xref:System.ServiceModel.Dispatcher.ClientOperation> objects to which you can add custom message interceptors that provide functionality specific to the messages of that operation.</span></span>  
  
-   <span data-ttu-id="80ddc-146">使用 <xref:System.ServiceModel.Dispatcher.ClientRuntime.ManualAddressing%2A> 属性，应用程序可以关闭某些自动寻址标头来直接控制寻址。</span><span class="sxs-lookup"><span data-stu-id="80ddc-146">The <xref:System.ServiceModel.Dispatcher.ClientRuntime.ManualAddressing%2A> property enables an application to turn off some automatic addressing headers to directly control addressing.</span></span>  
  
-   <span data-ttu-id="80ddc-147"><xref:System.ServiceModel.Dispatcher.ClientRuntime.Via%2A> 属性设置传输级别的消息的目标的值，来支持中介以及其他方案。</span><span class="sxs-lookup"><span data-stu-id="80ddc-147">The <xref:System.ServiceModel.Dispatcher.ClientRuntime.Via%2A> property sets the value of the destination of the message at the transport level to support intermediaries and other scenarios.</span></span>  
  
-   <span data-ttu-id="80ddc-148"><xref:System.ServiceModel.Dispatcher.ClientRuntime.MessageInspectors%2A>属性获取一系列<xref:System.ServiceModel.Dispatcher.IClientMessageInspector>可向其中添加的所有消息通过 WCF 客户端的自定义消息拦截器的对象。</span><span class="sxs-lookup"><span data-stu-id="80ddc-148">The <xref:System.ServiceModel.Dispatcher.ClientRuntime.MessageInspectors%2A> property gets a collection of <xref:System.ServiceModel.Dispatcher.IClientMessageInspector> objects to which you can add custom message interceptors for all messages traveling through a WCF client.</span></span>  
  
 <span data-ttu-id="80ddc-149">另外，还有其他多个属性可以检索约定信息：</span><span class="sxs-lookup"><span data-stu-id="80ddc-149">In addition, there are a number of other properties that retrieve the contract information:</span></span>  
  
-   <xref:System.ServiceModel.Dispatcher.ClientRuntime.ContractName%2A>  
  
-   <xref:System.ServiceModel.Dispatcher.ClientRuntime.ContractNamespace%2A>  
  
-   <xref:System.ServiceModel.Dispatcher.ClientRuntime.ContractClientType%2A>  
  
 <span data-ttu-id="80ddc-150">如果 WCF 客户端是双工 WCF 客户端，以下属性还可以检索回调 WCF 客户端信息：</span><span class="sxs-lookup"><span data-stu-id="80ddc-150">If the WCF client is a duplex WCF client, the following properties also retrieve the callback WCF client information:</span></span>  
  
-   <xref:System.ServiceModel.Dispatcher.ClientRuntime.CallbackClientType%2A>  
  
-   <xref:System.ServiceModel.Dispatcher.ClientRuntime.CallbackDispatchRuntime%2A>  
  
 <span data-ttu-id="80ddc-151">若要跨整个的 WCF 客户端扩展 WCF 客户端执行，查看可用的属性<xref:System.ServiceModel.Dispatcher.ClientRuntime>类以查看修改属性或实现接口并将其添加到属性是否创建正在寻求的功能。</span><span class="sxs-lookup"><span data-stu-id="80ddc-151">To extend WCF client execution across an entire WCF client, review the properties available on the <xref:System.ServiceModel.Dispatcher.ClientRuntime> class to see whether modifying a property or implementing an interface and adding it to a property creates the functionality you are seeking.</span></span> <span data-ttu-id="80ddc-152">在选择了要生成的特定扩展后，通过实现调用时可访问 <xref:System.ServiceModel.Dispatcher.ClientRuntime> 类的客户端行为来将您的扩展插入相应的 <xref:System.ServiceModel.Dispatcher.ClientRuntime> 属性。</span><span class="sxs-lookup"><span data-stu-id="80ddc-152">Once you have chosen a particular extension to build, insert your extension into the appropriate <xref:System.ServiceModel.Dispatcher.ClientRuntime> property by implementing a client behavior that provides access to the <xref:System.ServiceModel.Dispatcher.ClientRuntime> class when invoked.</span></span>  
  
 <span data-ttu-id="80ddc-153">您可以使用操作行为（实现 <xref:System.ServiceModel.Description.IOperationBehavior> 的对象）、约定行为（实现 <xref:System.ServiceModel.Description.IContractBehavior> 的对象）或终结点行为（实现 <xref:System.ServiceModel.Description.IEndpointBehavior> 的对象）将自定义扩展对象插入到集合中。</span><span class="sxs-lookup"><span data-stu-id="80ddc-153">You can insert custom extension objects into a collection using an operation behavior (an object that implements <xref:System.ServiceModel.Description.IOperationBehavior>), a contract behavior (an object that implements <xref:System.ServiceModel.Description.IContractBehavior>), or an endpoint behavior (an object that implements <xref:System.ServiceModel.Description.IEndpointBehavior>).</span></span> <span data-ttu-id="80ddc-154">安装行为对象可以编程方式、声明方式（通过实现自定义属性）或通过实现自定义 <xref:System.ServiceModel.Configuration.BehaviorExtensionElement> 对象的方式添加到相应的行为集合中，以使该行为可以使用应用程序配置文件进行插入。</span><span class="sxs-lookup"><span data-stu-id="80ddc-154">The installing behavior object is added to the appropriate collection of behaviors either programmatically, declaratively (by implementing a custom attribute), or by implementing a custom <xref:System.ServiceModel.Configuration.BehaviorExtensionElement> object to enable the behavior to be inserted using an application configuration file.</span></span> <span data-ttu-id="80ddc-155">有关详细信息，请参阅[配置和扩展的运行时行为带有](../../../../docs/framework/wcf/extending/configuring-and-extending-the-runtime-with-behaviors.md)。</span><span class="sxs-lookup"><span data-stu-id="80ddc-155">For details, see [Configuring and Extending the Runtime with Behaviors](../../../../docs/framework/wcf/extending/configuring-and-extending-the-runtime-with-behaviors.md).</span></span>  
  
 <span data-ttu-id="80ddc-156">演示在 WCF 客户端之间的拦截的示例，请参阅[如何：检查或修改客户端的消息](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-messages-on-the-client.md)。</span><span class="sxs-lookup"><span data-stu-id="80ddc-156">For examples that demonstrate interception across a WCF client, see [How to: Inspect or Modify Messages on the Client](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-messages-on-the-client.md).</span></span>  
  
### <a name="using-the-clientoperation-class"></a><span data-ttu-id="80ddc-157">使用 ClientOperation 类</span><span class="sxs-lookup"><span data-stu-id="80ddc-157">Using the ClientOperation Class</span></span>  
 <span data-ttu-id="80ddc-158"><xref:System.ServiceModel.Dispatcher.ClientOperation> 类是仅一个服务操作范围内的自定义扩展的客户端运行时修改和插入点的位置。</span><span class="sxs-lookup"><span data-stu-id="80ddc-158">The <xref:System.ServiceModel.Dispatcher.ClientOperation> class is the location for client run-time modifications and insertion point for custom extensions that are scoped to only one service operation.</span></span> <span data-ttu-id="80ddc-159">（若要在约定中修改所有消息的客户端运行时行为，请使用 <xref:System.ServiceModel.Dispatcher.ClientRuntime> 类。）</span><span class="sxs-lookup"><span data-stu-id="80ddc-159">(To modify client run-time behavior for all messages in a contract, use the <xref:System.ServiceModel.Dispatcher.ClientRuntime> class.)</span></span>  
  
 <span data-ttu-id="80ddc-160">使用 <xref:System.ServiceModel.Dispatcher.ClientRuntime.Operations%2A> 属性可以查找表示特定服务操作的 <xref:System.ServiceModel.Dispatcher.ClientOperation> 对象。</span><span class="sxs-lookup"><span data-stu-id="80ddc-160">Use the <xref:System.ServiceModel.Dispatcher.ClientRuntime.Operations%2A> property to locate the <xref:System.ServiceModel.Dispatcher.ClientOperation> object that represents a particular service operation.</span></span> <span data-ttu-id="80ddc-161">以下属性，可以将自定义对象插入到 WCF 客户端系统：</span><span class="sxs-lookup"><span data-stu-id="80ddc-161">The following properties enable you to insert custom objects into the WCF client system:</span></span>  
  
-   <span data-ttu-id="80ddc-162">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.Formatter%2A> 属性插入某一操作的自定义 <xref:System.ServiceModel.Dispatcher.IClientMessageFormatter> 实现或修改当前格式化程序。</span><span class="sxs-lookup"><span data-stu-id="80ddc-162">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.Formatter%2A> property to insert a custom <xref:System.ServiceModel.Dispatcher.IClientMessageFormatter> implementation for an operation or modify the current formatter.</span></span>  
  
-   <span data-ttu-id="80ddc-163">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.ParameterInspectors%2A> 属性插入自定义 <xref:System.ServiceModel.Dispatcher.IParameterInspector> 实现或修改当前实现。</span><span class="sxs-lookup"><span data-stu-id="80ddc-163">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.ParameterInspectors%2A> property to insert a custom <xref:System.ServiceModel.Dispatcher.IParameterInspector> implementation or to modify the current one.</span></span>  
  
 <span data-ttu-id="80ddc-164">您可以使用下面的属性修改与格式化程序和自定义参数检查器进行交互的系统：</span><span class="sxs-lookup"><span data-stu-id="80ddc-164">The following properties enable you to modify the system in interaction with the formatter and custom parameter inspectors:</span></span>  
  
-   <span data-ttu-id="80ddc-165">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.SerializeRequest%2A> 属性控制出站消息的序列化。</span><span class="sxs-lookup"><span data-stu-id="80ddc-165">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.SerializeRequest%2A> property to control the serialization of an outbound message.</span></span>  
  
-   <span data-ttu-id="80ddc-166">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.DeserializeReply%2A> 属性控制入站消息的反序列化。</span><span class="sxs-lookup"><span data-stu-id="80ddc-166">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.DeserializeReply%2A> property to control the deserialization of an inbound message.</span></span>  
  
-   <span data-ttu-id="80ddc-167">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.Action%2A> 属性控制请求消息的 WS-Addressing 操作。</span><span class="sxs-lookup"><span data-stu-id="80ddc-167">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.Action%2A> property to control the WS-Addressing action of the request message.</span></span>  
  
-   <span data-ttu-id="80ddc-168">使用<xref:System.ServiceModel.Dispatcher.ClientOperation.BeginMethod%2A>和<xref:System.ServiceModel.Dispatcher.ClientOperation.EndMethod%2A>指定的 WCF 客户端方法与异步操作相关联。</span><span class="sxs-lookup"><span data-stu-id="80ddc-168">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.BeginMethod%2A> and <xref:System.ServiceModel.Dispatcher.ClientOperation.EndMethod%2A> to specify which WCF client methods are associated with an asynchronous operation.</span></span>  
  
-   <span data-ttu-id="80ddc-169">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.FaultContractInfos%2A> 属性获取包含可在 SOAP 错误中显示为详细信息类型的类型集合。</span><span class="sxs-lookup"><span data-stu-id="80ddc-169">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.FaultContractInfos%2A> property to get a collection that contains the types that can appear in SOAP faults as the detail type.</span></span>  
  
-   <span data-ttu-id="80ddc-170">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.IsInitiating%2A> 和 <xref:System.ServiceModel.Dispatcher.ClientOperation.IsTerminating%2A> 属性分别控制当调用操作时会话是已启动还是被撤销。</span><span class="sxs-lookup"><span data-stu-id="80ddc-170">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.IsInitiating%2A> and <xref:System.ServiceModel.Dispatcher.ClientOperation.IsTerminating%2A> properties to control whether a session is initiated or is torn down, respectively, when the operation is called.</span></span>  
  
-   <span data-ttu-id="80ddc-171">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.IsOneWay%2A> 属性控制操作是否为单向操作。</span><span class="sxs-lookup"><span data-stu-id="80ddc-171">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.IsOneWay%2A> property to control whether the operation is a one-way operation.</span></span>  
  
-   <span data-ttu-id="80ddc-172">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.Parent%2A> 属性获取包含 <xref:System.ServiceModel.Dispatcher.ClientRuntime> 对象。</span><span class="sxs-lookup"><span data-stu-id="80ddc-172">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.Parent%2A> property to obtain the containing <xref:System.ServiceModel.Dispatcher.ClientRuntime> object.</span></span>  
  
-   <span data-ttu-id="80ddc-173">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.Name%2A> 属性获取操作的名称。</span><span class="sxs-lookup"><span data-stu-id="80ddc-173">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.Name%2A> property to get the name of the operation.</span></span>  
  
-   <span data-ttu-id="80ddc-174">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.SyncMethod%2A> 属性控制将哪个方法映射到操作。</span><span class="sxs-lookup"><span data-stu-id="80ddc-174">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.SyncMethod%2A> property to control which method is mapped to the operation.</span></span>  
  
 <span data-ttu-id="80ddc-175">若要将 WCF 客户端执行扩展到仅一个服务操作，查看可用的属性<xref:System.ServiceModel.Dispatcher.ClientOperation>类以查看修改属性或实现接口并将其添加到属性是否创建正在寻求的功能。</span><span class="sxs-lookup"><span data-stu-id="80ddc-175">To extend WCF client execution across only one service operation, review the properties available on the <xref:System.ServiceModel.Dispatcher.ClientOperation> class to see whether modifying a property or implementing an interface and adding it to a property creates the functionality you are seeking.</span></span> <span data-ttu-id="80ddc-176">在选择了要生成的特定扩展后，通过实现调用时可访问 <xref:System.ServiceModel.Dispatcher.ClientOperation> 类的客户端行为来将您的扩展插入相应的 <xref:System.ServiceModel.Dispatcher.ClientOperation> 属性。</span><span class="sxs-lookup"><span data-stu-id="80ddc-176">Once you have chosen a particular extension to build, insert your extension into the appropriate <xref:System.ServiceModel.Dispatcher.ClientOperation> property by implementing a client behavior that provides access to the <xref:System.ServiceModel.Dispatcher.ClientOperation> class when invoked.</span></span> <span data-ttu-id="80ddc-177">然后，您可以在该行为中修改 <xref:System.ServiceModel.Dispatcher.ClientRuntime> 属性来符合您的要求。</span><span class="sxs-lookup"><span data-stu-id="80ddc-177">Inside that behavior you can then modify the <xref:System.ServiceModel.Dispatcher.ClientRuntime> property to fit your requirements.</span></span>  
  
 <span data-ttu-id="80ddc-178">通常情况下，实现操作行为（实现 <xref:System.ServiceModel.Description.IOperationBehavior> 接口的对象）就可以满足需要，但是也可以使用终结点行为和约定行为，通过定位特定操作的 <xref:System.ServiceModel.Description.OperationDescription> 并在其中附加行为，以此达到相同的效果。</span><span class="sxs-lookup"><span data-stu-id="80ddc-178">Typically, implementing an operation behavior (an object that implements the <xref:System.ServiceModel.Description.IOperationBehavior> interface) suffices, but you can also use endpoint behaviors and contract behaviors to accomplish the same thing by locating the <xref:System.ServiceModel.Description.OperationDescription> for a particular operation and attaching the behavior there.</span></span> <span data-ttu-id="80ddc-179">有关详细信息，请参阅[配置和扩展的运行时行为带有](../../../../docs/framework/wcf/extending/configuring-and-extending-the-runtime-with-behaviors.md)。</span><span class="sxs-lookup"><span data-stu-id="80ddc-179">For details, see [Configuring and Extending the Runtime with Behaviors](../../../../docs/framework/wcf/extending/configuring-and-extending-the-runtime-with-behaviors.md).</span></span>  
  
 <span data-ttu-id="80ddc-180">若要在配置中使用自定义行为，请使用自定义行为配置节处理程序安装您的行为。</span><span class="sxs-lookup"><span data-stu-id="80ddc-180">To use your custom behavior from configuration, install your behavior using a custom behavior configuration section handler.</span></span> <span data-ttu-id="80ddc-181">也可以通过创建自定义属性来安装您的行为。</span><span class="sxs-lookup"><span data-stu-id="80ddc-181">You can also install your behavior by creating a custom attribute.</span></span>  
  
 <span data-ttu-id="80ddc-182">演示在 WCF 客户端之间的拦截的示例，请参阅[如何：检查或修改参数](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-parameters.md)。</span><span class="sxs-lookup"><span data-stu-id="80ddc-182">For examples that demonstrate interception across a WCF client, see [How to: Inspect or Modify Parameters](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-parameters.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="80ddc-183">请参阅</span><span class="sxs-lookup"><span data-stu-id="80ddc-183">See also</span></span>

- <xref:System.ServiceModel.Dispatcher.ClientRuntime>
- <xref:System.ServiceModel.Dispatcher.ClientOperation>
- [<span data-ttu-id="80ddc-184">如何：检查或修改客户端的消息</span><span class="sxs-lookup"><span data-stu-id="80ddc-184">How to: Inspect or Modify Messages on the Client</span></span>](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-messages-on-the-client.md)
- [<span data-ttu-id="80ddc-185">如何：检查或修改参数</span><span class="sxs-lookup"><span data-stu-id="80ddc-185">How to: Inspect or Modify Parameters</span></span>](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-parameters.md)
