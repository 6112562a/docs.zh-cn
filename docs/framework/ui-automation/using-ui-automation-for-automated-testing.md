---
title: 使用 UI 自动化进行自动化测试
ms.date: 03/30/2017
helpviewer_keywords:
- automated testing
- testing, UI Automation
- UI Automation, automated testing
ms.assetid: 3a0435c0-a791-4ad7-ba92-a4c1d1231fde
ms.openlocfilehash: 2da0f994e809ff0ea9cd3165cd788ac467a87aef
ms.sourcegitcommit: 32a575bf4adccc901f00e264f92b759ced633379
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/04/2019
ms.locfileid: "74800783"
---
# <a name="using-ui-automation-for-automated-testing"></a><span data-ttu-id="6add0-102">使用 UI 自动化进行自动化测试</span><span class="sxs-lookup"><span data-stu-id="6add0-102">Using UI Automation for Automated Testing</span></span>
> [!NOTE]
> <span data-ttu-id="6add0-103">本文档适用于想要使用 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 命名空间中定义的托管 <xref:System.Windows.Automation> 类的 .NET Framework 开发人员。</span><span class="sxs-lookup"><span data-stu-id="6add0-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="6add0-104">有关 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]的最新信息，请参阅 [Windows 自动化 API：UI 自动化](/windows/win32/winauto/entry-uiauto-win32)。</span><span class="sxs-lookup"><span data-stu-id="6add0-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>  
  
 <span data-ttu-id="6add0-105">本概述介绍可如何将 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] 用作一个用于在自动测试方案中进行编程访问的框架。</span><span class="sxs-lookup"><span data-stu-id="6add0-105">This overview describes how [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] can be useful as a framework for programmatic access in automated testing scenarios.</span></span>  
  
 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="6add0-106">提供一个统一的对象模型，该模型使所有的 [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] 框架均能够以可访问并易于实现自动化的方式公开复杂且丰富的功能。</span><span class="sxs-lookup"><span data-stu-id="6add0-106">provides a unified object model that enables all [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] frameworks to expose complex and rich functionality in an accessible and easily automated manner.</span></span>  
  
 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="6add0-107">是作为 Microsoft Active Accessibility 的一个后续版本而开发的。</span><span class="sxs-lookup"><span data-stu-id="6add0-107">was developed as a successor to Microsoft Active Accessibility.</span></span> <span data-ttu-id="6add0-108">Active Accessibility 是一种现有框架，旨在提供使控件和应用程序可访问的解决方案。</span><span class="sxs-lookup"><span data-stu-id="6add0-108">Active Accessibility is an existing framework designed to provide a solution for making controls and applications accessible.</span></span> <span data-ttu-id="6add0-109">由于辅助功能和自动化的要求非常相似，因此 Active Accessibility 不会考虑测试自动化。</span><span class="sxs-lookup"><span data-stu-id="6add0-109">Active Accessibility was not designed with test automation in mind even though it evolved into that role due to the very similar requirements of accessibility and automation.</span></span> <span data-ttu-id="6add0-110">除了为辅助功能提供更完善的解决方案以外，[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]还专门用于提供进行自动测试的强大功能。</span><span class="sxs-lookup"><span data-stu-id="6add0-110">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], in addition to providing more refined solutions for accessibility, is also specifically designed to provide robust functionality for automated testing.</span></span> <span data-ttu-id="6add0-111">例如，Active Accessibility 依赖于单个接口来公开 UI 相关信息和收集 AT 产品所需的信息;[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 将两个模型分开。</span><span class="sxs-lookup"><span data-stu-id="6add0-111">For example, Active Accessibility relies on a single interface to both expose information about the UI and collect the information needed by AT products; [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] separates the two models.</span></span>  
  
 <span data-ttu-id="6add0-112">实现 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 需要提供程序和客户端，以便使其可以用作自动测试工具。</span><span class="sxs-lookup"><span data-stu-id="6add0-112">Both a provider and client are required to implement [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] for it to be useful as an automated test tool.</span></span> <span data-ttu-id="6add0-113">UI 自动化提供程序是 Microsoft Word、Excel 和其他第三方应用程序或基于 Microsoft Windows 操作系统的控件。</span><span class="sxs-lookup"><span data-stu-id="6add0-113">UI Automation providers are applications such as Microsoft Word, Excel, and other third-party applications or controls based on the Microsoft Windows operating system.</span></span> <span data-ttu-id="6add0-114">UI 自动化客户端包括自动测试脚本和辅助技术应用程序。</span><span class="sxs-lookup"><span data-stu-id="6add0-114">UI Automation clients include automated test scripts and assistive technology applications.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="6add0-115">本概述的目的在于展示 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]的新增及改进的自动测试功能。</span><span class="sxs-lookup"><span data-stu-id="6add0-115">The intent of this overview is to showcase the new and improved automated testing capabilities of [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span></span> <span data-ttu-id="6add0-116">本概述不提供有关辅助功能的信息，只有在必要时才会提到这些功能。</span><span class="sxs-lookup"><span data-stu-id="6add0-116">This overview is not intended to provide information on accessibility features and will not address accessibility other than where necessary.</span></span>  
  
## <a name="ui-automation-in-a-provider"></a><span data-ttu-id="6add0-117">提供程序中的 UI 自动化</span><span class="sxs-lookup"><span data-stu-id="6add0-117">UI Automation in a Provider</span></span>  
 <span data-ttu-id="6add0-118">对于要自动化的 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] ，应用程序或控件的开发人员必须查看最终用户可以使用标准键盘和鼠标交互对 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 对象执行哪些操作。</span><span class="sxs-lookup"><span data-stu-id="6add0-118">For a [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] to be automated, a developer of an application or control must look at what actions an end-user can perform on the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] object using standard keyboard and mouse interaction.</span></span>  
  
 <span data-ttu-id="6add0-119">确定这些键操作后，应在控件上实现相应的 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 控件模式（即将 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 元素的功能和行为进行镜像的控件模式）。</span><span class="sxs-lookup"><span data-stu-id="6add0-119">Once these key actions have been identified, the corresponding [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] control patterns (that is, the control patterns that mirror the functionality and behavior of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] element) should be implemented on the control.</span></span> <span data-ttu-id="6add0-120">例如，具有组合框控件（如运行对话框）的用户交互通常涉及展开和折叠组合框，以隐藏或显示项列表、从该列表中选择项或通过键盘输入添加新值。</span><span class="sxs-lookup"><span data-stu-id="6add0-120">For example, user interaction with a combo box control (such as the run dialog) typically involves expanding and collapsing the combo box to hide or display a list of items, selecting an item from that list, or adding a new value via keyboard input.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="6add0-121">对于其他辅助功能模型，开发人员必须直接从各个按钮、菜单或其他控件收集信息。</span><span class="sxs-lookup"><span data-stu-id="6add0-121">With other accessibility models, developers must gather information directly from individual buttons, menus, or other controls.</span></span> <span data-ttu-id="6add0-122">不便之处在于，每个控件类型都具有数十个次要变体。</span><span class="sxs-lookup"><span data-stu-id="6add0-122">Unfortunately, every control type comes in dozens of minor variations.</span></span> <span data-ttu-id="6add0-123">也就是说，尽管某个按钮的十种变体全都以相同的方式工作且执行相同的功能，也必须将它们全部视为唯一控件。</span><span class="sxs-lookup"><span data-stu-id="6add0-123">In other words, even though ten variations of a pushbutton may all work the same way and perform the same function, they must all be treated as unique controls.</span></span> <span data-ttu-id="6add0-124">无法知道这些控件在功能上是否相同。</span><span class="sxs-lookup"><span data-stu-id="6add0-124">There is no way to know that these controls are functionally equivalent.</span></span> <span data-ttu-id="6add0-125">所开发的控件模式可以表示这些常见的控件行为。</span><span class="sxs-lookup"><span data-stu-id="6add0-125">Control patterns were developed to represent these common control behaviors.</span></span> <span data-ttu-id="6add0-126">有关详细信息，请参阅 [UI Automation Control Patterns Overview](ui-automation-control-patterns-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="6add0-126">For more information, see [UI Automation Control Patterns Overview](ui-automation-control-patterns-overview.md).</span></span>  
  
### <a name="implementing-ui-automation"></a><span data-ttu-id="6add0-127">实现 UI 自动化</span><span class="sxs-lookup"><span data-stu-id="6add0-127">Implementing UI Automation</span></span>  
 <span data-ttu-id="6add0-128">如前所述，如果没有 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]提供的统一模型，则测试工具和开发人员必须了解特定于框架的信息才能公开该框架中控件的属性和行为。</span><span class="sxs-lookup"><span data-stu-id="6add0-128">As mentioned earlier, without the unified model provided by [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], test tools and developers are required to know framework-specific information in order to expose properties and behaviors of controls in that framework.</span></span> <span data-ttu-id="6add0-129">由于在 Windows 操作系统中，在任何时候都可以有多个不同的 UI 框架，包括 [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)]、[!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)]和 Windows Presentation Foundation （WPF），因此，使用看似相似的控件测试多个应用程序可能是一项艰巨的任务。</span><span class="sxs-lookup"><span data-stu-id="6add0-129">Since there can be several different UI frameworks present at any single time within Windows operating systems, including [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)], [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)], and Windows Presentation Foundation (WPF), it can be a daunting task to test multiple applications with controls that seem similar.</span></span> <span data-ttu-id="6add0-130">例如，下表概述了检索与按钮控件相关联的名称（或文本）所需的框架特定属性名，并显示了单个等效的 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 属性。</span><span class="sxs-lookup"><span data-stu-id="6add0-130">For example, the following table outlines the framework-specific property names required to retrieve the name (or text) associated with a button control and shows the single equivalent [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] property.</span></span>  
  
|<span data-ttu-id="6add0-131">UI 自动化控件类型</span><span class="sxs-lookup"><span data-stu-id="6add0-131">UI Automation Control Type</span></span>|<span data-ttu-id="6add0-132">UI 框架</span><span class="sxs-lookup"><span data-stu-id="6add0-132">UI Framework</span></span>|<span data-ttu-id="6add0-133">特定于框架的属性</span><span class="sxs-lookup"><span data-stu-id="6add0-133">Framework Specific Property</span></span>|<span data-ttu-id="6add0-134">UI 自动化属性</span><span class="sxs-lookup"><span data-stu-id="6add0-134">UI Automation Property</span></span>|  
|--------------------------------|------------------|---------------------------------|----------------------------|  
|<span data-ttu-id="6add0-135">Button</span><span class="sxs-lookup"><span data-stu-id="6add0-135">Button</span></span>|<span data-ttu-id="6add0-136">Windows Presentation Foundation</span><span class="sxs-lookup"><span data-stu-id="6add0-136">Windows Presentation Foundation</span></span>|<span data-ttu-id="6add0-137">Content</span><span class="sxs-lookup"><span data-stu-id="6add0-137">Content</span></span>|<span data-ttu-id="6add0-138">NameProperty</span><span class="sxs-lookup"><span data-stu-id="6add0-138">NameProperty</span></span>|  
|<span data-ttu-id="6add0-139">Button</span><span class="sxs-lookup"><span data-stu-id="6add0-139">Button</span></span>|<span data-ttu-id="6add0-140">Win32</span><span class="sxs-lookup"><span data-stu-id="6add0-140">Win32</span></span>|<span data-ttu-id="6add0-141">标题</span><span class="sxs-lookup"><span data-stu-id="6add0-141">Caption</span></span>|<span data-ttu-id="6add0-142">NameProperty</span><span class="sxs-lookup"><span data-stu-id="6add0-142">NameProperty</span></span>|  
|<span data-ttu-id="6add0-143">Image</span><span class="sxs-lookup"><span data-stu-id="6add0-143">Image</span></span>|<span data-ttu-id="6add0-144">HTML</span><span class="sxs-lookup"><span data-stu-id="6add0-144">HTML</span></span>|<span data-ttu-id="6add0-145">Alt</span><span class="sxs-lookup"><span data-stu-id="6add0-145">alt</span></span>|<span data-ttu-id="6add0-146">NameProperty</span><span class="sxs-lookup"><span data-stu-id="6add0-146">NameProperty</span></span>|  
  
 <span data-ttu-id="6add0-147">UI 自动化提供程序负责将其控件的特定于框架的属性映射到等效的 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 属性。</span><span class="sxs-lookup"><span data-stu-id="6add0-147">UI Automation providers are responsible for mapping the framework-specific properties of their controls to the equivalent [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] properties.</span></span>  
  
 <span data-ttu-id="6add0-148">有关在提供程序中实现 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 的信息，请参阅[托管代码的 UI 自动化提供程序](ui-automation-providers-for-managed-code.md)。</span><span class="sxs-lookup"><span data-stu-id="6add0-148">Information on implementing [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] in a provider can be found at [UI Automation Providers for Managed Code](ui-automation-providers-for-managed-code.md).</span></span> <span data-ttu-id="6add0-149">[UI Automation Control Patterns](ui-automation-control-patterns.md) 和 [UI Automation Text Pattern](ui-automation-text-pattern.md)中提供了有关实现控件模式的信息。</span><span class="sxs-lookup"><span data-stu-id="6add0-149">Information on implementing control patterns is available at [UI Automation Control Patterns](ui-automation-control-patterns.md) and [UI Automation Text Pattern](ui-automation-text-pattern.md).</span></span>  
  
## <a name="ui-automation-in-a-client"></a><span data-ttu-id="6add0-150">客户端中的 UI 自动化</span><span class="sxs-lookup"><span data-stu-id="6add0-150">UI Automation in a Client</span></span>  
 <span data-ttu-id="6add0-151">许多自动测试工具和方案的目标是以一致且可重复的方式操作用户界面。</span><span class="sxs-lookup"><span data-stu-id="6add0-151">The goal of many automated test tools and scenarios is the consistent and repeatable manipulation of the user interface.</span></span> <span data-ttu-id="6add0-152">该目标的范围包括：从对特定的控件进行单元测试，到录制并播放一些测试脚本，以便对一组控件循环执行一系列常规操作。</span><span class="sxs-lookup"><span data-stu-id="6add0-152">This can involve unit testing specific controls through to the recording and playback of test scripts that iterate through a series of generic actions on a group of controls.</span></span>  
  
 <span data-ttu-id="6add0-153">自动化应用程序存在的一个问题是难以将测试与动态目标同步。</span><span class="sxs-lookup"><span data-stu-id="6add0-153">A complication that arises from automated applications is the difficulty synchronizing a test with a dynamic target.</span></span> <span data-ttu-id="6add0-154">这种动态目标的示例包括显示当前运行应用程序的列表的列表框控件（Windows 任务管理器中就包含这种列表框控件）。</span><span class="sxs-lookup"><span data-stu-id="6add0-154">For example, a list box control, such as one contained in the Windows Task Manager, that displays a list of currently running applications.</span></span> <span data-ttu-id="6add0-155">由于该列表框中的项是不受测试应用程序的控制而动态更新的，因此总是无法在列表框中重复选择到前后一致的特定项。</span><span class="sxs-lookup"><span data-stu-id="6add0-155">Since the items in the list box are dynamically updated outside the control of the test application, attempting to repeat the selection of a specific item in the list box with any consistency is impossible.</span></span> <span data-ttu-id="6add0-156">尝试在不受测试应用程序控制的 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 中重复简单的焦点更改时，也会产生类似的问题。</span><span class="sxs-lookup"><span data-stu-id="6add0-156">Similar issues can also arise when attempting to repeat simple focus changes in a [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] that is outside the control of the test application.</span></span>  
  
### <a name="programmatic-access"></a><span data-ttu-id="6add0-157">编程访问</span><span class="sxs-lookup"><span data-stu-id="6add0-157">Programmatic Access</span></span>  
 <span data-ttu-id="6add0-158">使用编程访问可以通过代码模仿由传统鼠标和键盘输入展开的任何交互和体验。</span><span class="sxs-lookup"><span data-stu-id="6add0-158">Programmatic access provides the ability to imitate, through code, any interaction and experience exposed by traditional mouse and keyboard input.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="6add0-159">通过五个组件实现编程访问：</span><span class="sxs-lookup"><span data-stu-id="6add0-159">enables programmatic access through five components:</span></span>  
  
- <span data-ttu-id="6add0-160">借助 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 树，可以方便地在 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]结构中导航。</span><span class="sxs-lookup"><span data-stu-id="6add0-160">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree facilitates navigation through the structure of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="6add0-161">树是基于 hWnd 的集合生成的。</span><span class="sxs-lookup"><span data-stu-id="6add0-161">The tree is built from the collection of hWnd's.</span></span> <span data-ttu-id="6add0-162">有关详细信息，请参阅 [UI Automation Tree Overview](ui-automation-tree-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="6add0-162">For more information, see [UI Automation Tree Overview](ui-automation-tree-overview.md)</span></span>  
  
- <span data-ttu-id="6add0-163">自动化元素是 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]中的独立组件。</span><span class="sxs-lookup"><span data-stu-id="6add0-163">Automation elements are individual components in the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="6add0-164">这些组件的粒度级通常比 hWnd 更精细。</span><span class="sxs-lookup"><span data-stu-id="6add0-164">These can often be more granular than an hWnd.</span></span> <span data-ttu-id="6add0-165">有关详细信息，请参阅 [UI Automation Control Types Overview](ui-automation-control-types-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="6add0-165">For more information, see [UI Automation Control Types Overview](ui-automation-control-types-overview.md).</span></span>  
  
- <span data-ttu-id="6add0-166">自动化属性提供有关 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 元素的特定信息。</span><span class="sxs-lookup"><span data-stu-id="6add0-166">Automation properties provide specific information about [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] elements.</span></span> <span data-ttu-id="6add0-167">有关更多信息，请参见 [UI Automation Properties Overview](ui-automation-properties-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="6add0-167">For more information, see [UI Automation Properties Overview](ui-automation-properties-overview.md).</span></span>  
  
- <span data-ttu-id="6add0-168">控件模式定义了控件功能的特定方面；控件模式可以由属性、方法、事件和结构信息组成。</span><span class="sxs-lookup"><span data-stu-id="6add0-168">Control patterns define a particular aspect of a control's functionality; they can consist of property, method, event, and structure information.</span></span> <span data-ttu-id="6add0-169">有关详细信息，请参阅 [UI Automation Control Patterns Overview](ui-automation-control-patterns-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="6add0-169">For more information, see [UI Automation Control Patterns Overview](ui-automation-control-patterns-overview.md).</span></span>  
  
- <span data-ttu-id="6add0-170">自动化事件提供事件通知和信息。</span><span class="sxs-lookup"><span data-stu-id="6add0-170">Automation events provide event notifications and information.</span></span> <span data-ttu-id="6add0-171">有关更多信息，请参见 [UI Automation Events Overview](ui-automation-events-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="6add0-171">For more information, see [UI Automation Events Overview](ui-automation-events-overview.md).</span></span>  
  
### <a name="key-properties-for-test-automation"></a><span data-ttu-id="6add0-172">测试自动化的关键属性</span><span class="sxs-lookup"><span data-stu-id="6add0-172">Key Properties for Test Automation</span></span>  
 <span data-ttu-id="6add0-173">由于可以对 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 中的任何控件进行唯一标识，并且以后还能查找该控件，因此，自动测试应用程序可在此基础上对该 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]执行相应的操作。</span><span class="sxs-lookup"><span data-stu-id="6add0-173">The ability to uniquely identify and subsequently locate any control within the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] provides the basis for automated test applications to operate on that [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="6add0-174">客户端和提供程序使用一些 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] 属性来帮助实现此功能。</span><span class="sxs-lookup"><span data-stu-id="6add0-174">There are several [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] properties used by clients and providers that assist in this.</span></span>  
  
#### <a name="automationid"></a><span data-ttu-id="6add0-175">AutomationID</span><span class="sxs-lookup"><span data-stu-id="6add0-175">AutomationID</span></span>  
 <span data-ttu-id="6add0-176">将自动化元素从其同级中单独标识出来。</span><span class="sxs-lookup"><span data-stu-id="6add0-176">Uniquely identifies an automation element from its siblings.</span></span> <span data-ttu-id="6add0-177"><xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> 不同于 <xref:System.Windows.Automation.AutomationElement.NameProperty> 等属性，前者并未经过本地化；而对于后者，如果产品需要以多种语言提供，则这些属性通常已本地化。</span><span class="sxs-lookup"><span data-stu-id="6add0-177"><xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> is not localized, unlike a property such as <xref:System.Windows.Automation.AutomationElement.NameProperty> that is typically localized if a product gets shipped in multiple languages.</span></span> <span data-ttu-id="6add0-178">请参阅 [Use the AutomationID Property](use-the-automationid-property.md)。</span><span class="sxs-lookup"><span data-stu-id="6add0-178">See [Use the AutomationID Property](use-the-automationid-property.md).</span></span>  
  
> [!NOTE]
> <span data-ttu-id="6add0-179"><xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> 不保证整个自动化树使用唯一标识。</span><span class="sxs-lookup"><span data-stu-id="6add0-179"><xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> does not guarantee a unique identity throughout the automation tree.</span></span> <span data-ttu-id="6add0-180">例如，一个应用程序可能包含具有多个顶级菜单项的菜单控件，而这些顶级菜单项又具有多个子菜单项。</span><span class="sxs-lookup"><span data-stu-id="6add0-180">For example, an application may contain a menu control with multiple top-level menu items that, in turn, have multiple child menu items.</span></span> <span data-ttu-id="6add0-181">可以通过常规架构（如“Item1、Item2、Item3 等”）标识这些二级菜单项，并允许顶级菜单项中的子菜单项使用重复的标识符。</span><span class="sxs-lookup"><span data-stu-id="6add0-181">These secondary menu items may be identified by a generic scheme such as "Item1, Item 2, Item3, etc.", allowing duplicate identifiers for children across top-level menu items.</span></span>  
  
#### <a name="controltype"></a><span data-ttu-id="6add0-182">ControlType</span><span class="sxs-lookup"><span data-stu-id="6add0-182">ControlType</span></span>  
 <span data-ttu-id="6add0-183">标识由自动化元素表示的控件类型。</span><span class="sxs-lookup"><span data-stu-id="6add0-183">Identifies the type of control represented by an automation element.</span></span> <span data-ttu-id="6add0-184">通过了解控件类型可以推断出重要的信息。</span><span class="sxs-lookup"><span data-stu-id="6add0-184">Significant information can be inferred from knowledge of the control type.</span></span> <span data-ttu-id="6add0-185">请参阅 [UI Automation Control Types Overview](ui-automation-control-types-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="6add0-185">See [UI Automation Control Types Overview](ui-automation-control-types-overview.md).</span></span>  
  
#### <a name="nameproperty"></a><span data-ttu-id="6add0-186">NameProperty</span><span class="sxs-lookup"><span data-stu-id="6add0-186">NameProperty</span></span>  
 <span data-ttu-id="6add0-187">这是标识或说明控件的文本字符串。</span><span class="sxs-lookup"><span data-stu-id="6add0-187">This is a text string that identifies or explains a control.</span></span> <span data-ttu-id="6add0-188">应谨慎使用<xref:System.Windows.Automation.AutomationElement.NameProperty> ，因为可对其进行本地化。</span><span class="sxs-lookup"><span data-stu-id="6add0-188"><xref:System.Windows.Automation.AutomationElement.NameProperty> should be used with caution since it can be localized.</span></span> <span data-ttu-id="6add0-189">请参阅 [UI Automation Properties Overview](ui-automation-properties-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="6add0-189">See [UI Automation Properties Overview](ui-automation-properties-overview.md).</span></span>  
  
### <a name="implementing-ui-automation-in-a-test-application"></a><span data-ttu-id="6add0-190">在测试应用程序中实现 UI 自动化</span><span class="sxs-lookup"><span data-stu-id="6add0-190">Implementing UI Automation in a Test Application</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="6add0-191">添加 UI 自动化引用。</span><span class="sxs-lookup"><span data-stu-id="6add0-191">Add the UI Automation References.</span></span>|<span data-ttu-id="6add0-192">下面列出了 UI 自动化客户端所必需的 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] dll。</span><span class="sxs-lookup"><span data-stu-id="6add0-192">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] dll's necessary for UI Automation clients are listed here.</span></span><br /><br /> <span data-ttu-id="6add0-193">-Uiautomationclient.dll 提供对 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 客户端 Api 的访问。</span><span class="sxs-lookup"><span data-stu-id="6add0-193">-   UIAutomationClient.dll provides access to the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] client-side APIs.</span></span><br /><span data-ttu-id="6add0-194">-UIAutomationClientSideProvider 提供自动 [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)] 控件的功能。</span><span class="sxs-lookup"><span data-stu-id="6add0-194">-   UIAutomationClientSideProvider.dll provides the ability to automate [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)] controls.</span></span> <span data-ttu-id="6add0-195">请参阅 [UI Automation Support for Standard Controls](ui-automation-support-for-standard-controls.md)。</span><span class="sxs-lookup"><span data-stu-id="6add0-195">See [UI Automation Support for Standard Controls](ui-automation-support-for-standard-controls.md).</span></span><br /><span data-ttu-id="6add0-196">-Uiautomationtypes.dll 提供对 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]中定义的特定类型的访问。</span><span class="sxs-lookup"><span data-stu-id="6add0-196">-   UIAutomationTypes.dll provides access to the specific types defined in [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span></span>|  
|<span data-ttu-id="6add0-197">添加 <xref:System.Windows.Automation> 命名空间。</span><span class="sxs-lookup"><span data-stu-id="6add0-197">Add the <xref:System.Windows.Automation> namespace.</span></span>|<span data-ttu-id="6add0-198">此命名空间包含 UI 自动化客户端使用 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 的功能（文本处理除外）所需的一切内容。</span><span class="sxs-lookup"><span data-stu-id="6add0-198">This namespace contains everything UI Automation clients need to use the capabilities of [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] except text handling.</span></span>|  
|<span data-ttu-id="6add0-199">添加 <xref:System.Windows.Automation.Text> 命名空间。</span><span class="sxs-lookup"><span data-stu-id="6add0-199">Add the <xref:System.Windows.Automation.Text> namespace.</span></span>|<span data-ttu-id="6add0-200">此命名空间包含 UI 自动化客户端使用 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 文本处理的功能所需的一切内容。</span><span class="sxs-lookup"><span data-stu-id="6add0-200">This namespace contains everything a UI Automation clients need to use the capabilities of [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] text handling.</span></span>|  
|<span data-ttu-id="6add0-201">查找相关控件</span><span class="sxs-lookup"><span data-stu-id="6add0-201">Find controls of interest</span></span>|<span data-ttu-id="6add0-202">自动测试脚本可以查找表示自动化树中相关控件的 UI 自动化元素。</span><span class="sxs-lookup"><span data-stu-id="6add0-202">Automated test scripts locate UI Automation elements that represent controls of interest within the automation tree.</span></span><br /><br /> <span data-ttu-id="6add0-203">可使用多种方法来通过代码获取 UI 自动化元素。</span><span class="sxs-lookup"><span data-stu-id="6add0-203">There are multiple ways to obtain UI Automation elements with code.</span></span><br /><br /> <span data-ttu-id="6add0-204">-使用 <xref:System.Windows.Automation.Condition> 语句查询 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="6add0-204">-   Query the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] using a <xref:System.Windows.Automation.Condition> statement.</span></span> <span data-ttu-id="6add0-205">这通常是使用中性语言 <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> 的位置。</span><span class="sxs-lookup"><span data-stu-id="6add0-205">This is typically where the language-neutral <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> is used.</span></span> <span data-ttu-id="6add0-206">**注意：** 可使用可对控件的 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 属性进行列举的工具（如 cluster.exe）获取 <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty>。</span><span class="sxs-lookup"><span data-stu-id="6add0-206">**Note:**  An <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> can be obtained using a tool such as Inspect.exe that is able to itemize the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] properties of a control.</span></span> <br /><br /> <span data-ttu-id="6add0-207">-使用 <xref:System.Windows.Automation.TreeWalker> 类遍历整个 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 树或其中的一个子集。</span><span class="sxs-lookup"><span data-stu-id="6add0-207">-   Use the <xref:System.Windows.Automation.TreeWalker> class to traverse the entire [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree or a subset thereof.</span></span><br /><span data-ttu-id="6add0-208">-跟踪焦点。</span><span class="sxs-lookup"><span data-stu-id="6add0-208">-   Track focus.</span></span><br /><span data-ttu-id="6add0-209">-使用控件的 hWnd。</span><span class="sxs-lookup"><span data-stu-id="6add0-209">-   Use the hWnd of the control.</span></span><br /><span data-ttu-id="6add0-210">-使用屏幕位置，例如鼠标光标的位置。</span><span class="sxs-lookup"><span data-stu-id="6add0-210">-   Use screen location, such as the location of the mouse cursor.</span></span><br /><br /> <span data-ttu-id="6add0-211">请参见 [Obtaining UI Automation Elements](obtaining-ui-automation-elements.md)</span><span class="sxs-lookup"><span data-stu-id="6add0-211">See [Obtaining UI Automation Elements](obtaining-ui-automation-elements.md)</span></span>|  
|<span data-ttu-id="6add0-212">获取控件模式</span><span class="sxs-lookup"><span data-stu-id="6add0-212">Obtain Control Patterns</span></span>|<span data-ttu-id="6add0-213">控件模式公开在功能上相似的控件的常见行为。</span><span class="sxs-lookup"><span data-stu-id="6add0-213">Control patterns expose common behaviors for functionally similar controls.</span></span><br /><br /> <span data-ttu-id="6add0-214">找到需要测试的控件之后，自动测试脚本从这些 UI 自动化元素获取相关的控件模式。</span><span class="sxs-lookup"><span data-stu-id="6add0-214">After locating the controls that require testing, automated test scripts obtain the control patterns of interest from those UI Automation elements.</span></span> <span data-ttu-id="6add0-215">例如，用于典型按钮功能的 <xref:System.Windows.Automation.InvokePattern> 控件模式或用于窗口功能的 <xref:System.Windows.Automation.WindowPattern> 控件模式。</span><span class="sxs-lookup"><span data-stu-id="6add0-215">For example, the <xref:System.Windows.Automation.InvokePattern> control pattern for typical button functionality or the <xref:System.Windows.Automation.WindowPattern> control pattern for window functionality.</span></span><br /><br /> <span data-ttu-id="6add0-216">请参阅 [UI Automation Control Patterns Overview](ui-automation-control-patterns-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="6add0-216">See [UI Automation Control Patterns Overview](ui-automation-control-patterns-overview.md).</span></span>|  
|<span data-ttu-id="6add0-217">自动化 UI</span><span class="sxs-lookup"><span data-stu-id="6add0-217">Automate the UI</span></span>|<span data-ttu-id="6add0-218">自动测试脚本现在可以使用 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 控件模式公开的信息和功能来控制 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 框架中的任何相关 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="6add0-218">Automated test scripts can now control any [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] of interest from a [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] framework using the information and functionality exposed by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] control patterns.</span></span>|  
  
## <a name="related-tools-and-technologies"></a><span data-ttu-id="6add0-219">相关的工具和技术</span><span class="sxs-lookup"><span data-stu-id="6add0-219">Related Tools and Technologies</span></span>  
 <span data-ttu-id="6add0-220">有许多支持使用 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]进行自动测试的相关工具和技术。</span><span class="sxs-lookup"><span data-stu-id="6add0-220">There are a number of related tools and technologies that support automated testing with [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span></span>  
  
- <span data-ttu-id="6add0-221">请检查 .exe 是一个图形用户界面（GUI）应用程序，该应用程序可用于收集提供程序和客户端开发和调试的 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 信息。</span><span class="sxs-lookup"><span data-stu-id="6add0-221">Inspect.exe is a graphical user interface (GUI) application that can be used to gather [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] information for both provider and client development and debugging.</span></span> <span data-ttu-id="6add0-222">Windows SDK 中包含了 "检查 .exe"。</span><span class="sxs-lookup"><span data-stu-id="6add0-222">Inspect.exe is included in the Windows SDK.</span></span>  
  
- <span data-ttu-id="6add0-223">Msaabridge 向向 Active Accessibility 的客户端公开 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 信息。</span><span class="sxs-lookup"><span data-stu-id="6add0-223">MSAABridge exposes [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] information to Active Accessibility clients.</span></span> <span data-ttu-id="6add0-224">将 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 桥接到 Active Accessibility 的主要目的是允许现有 Active Accessibility 客户端能够与已实现 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]的任何框架进行交互。</span><span class="sxs-lookup"><span data-stu-id="6add0-224">The primary goal of bridging [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] to Active Accessibility is to allow existing Active Accessibility clients the ability to interact with any framework that has implemented [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span></span>  
  
## <a name="security"></a><span data-ttu-id="6add0-225">安全性</span><span class="sxs-lookup"><span data-stu-id="6add0-225">Security</span></span>  
 <span data-ttu-id="6add0-226">有关安全信息，请参阅 [UI Automation Security Overview](ui-automation-security-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="6add0-226">For security information, see [UI Automation Security Overview](ui-automation-security-overview.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6add0-227">另请参阅</span><span class="sxs-lookup"><span data-stu-id="6add0-227">See also</span></span>

- [<span data-ttu-id="6add0-228">UI 自动化基础知识</span><span class="sxs-lookup"><span data-stu-id="6add0-228">UI Automation Fundamentals</span></span>](index.md)
