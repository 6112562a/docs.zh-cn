---
title: UI 自动化事件概述
ms.date: 03/30/2017
helpviewer_keywords:
- UI Automation, providers
- UI Automation, events
- clients, UI Automation
- events, UI Automation
- providers, UI Automation
- UI Automation, clients
ms.assetid: 69eebd8b-39ed-40e7-93cc-4457c4caf746
ms.openlocfilehash: ae780da7d6c6d45cb791333e5f0edcf0690f297b
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "61989672"
---
# <a name="ui-automation-events-overview"></a><span data-ttu-id="6c52b-102">UI 自动化事件概述</span><span class="sxs-lookup"><span data-stu-id="6c52b-102">UI Automation Events Overview</span></span>
> [!NOTE]
>  <span data-ttu-id="6c52b-103">本文档适用于想要使用 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 命名空间中定义的托管 <xref:System.Windows.Automation> 类的 .NET Framework 开发人员。</span><span class="sxs-lookup"><span data-stu-id="6c52b-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="6c52b-104">有关最新信息[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]，请参阅[Windows 自动化 API:UI 自动化](https://go.microsoft.com/fwlink/?LinkID=156746)。</span><span class="sxs-lookup"><span data-stu-id="6c52b-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).</span></span>  
  
 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] <span data-ttu-id="6c52b-105">事件通知是屏幕读取器和屏幕放大器等辅助技术的一项重要功能。</span><span class="sxs-lookup"><span data-stu-id="6c52b-105">event notification is a key feature for assistive technologies such as screen readers and screen magnifiers.</span></span> <span data-ttu-id="6c52b-106">这些 UI 自动化客户端跟踪由 UI 自动化提供程序引发的事件（当 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 中发生一些事情时），并使用这些信息通知最终用户。</span><span class="sxs-lookup"><span data-stu-id="6c52b-106">These UI Automation clients track events that are raised by UI Automation providers when something happens in the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] and use the information to notify end users.</span></span>  
  
 <span data-ttu-id="6c52b-107">通过允许提供程序应用程序有选择地引发事件来提高效率，这具体取决于是否有客户端订阅了这些事件，或者如果没有客户端在侦听任意事件，则不会引发任何事件。</span><span class="sxs-lookup"><span data-stu-id="6c52b-107">Efficiency is improved by allowing provider applications to raise events selectively, depending on whether any clients are subscribed to those events, or not at all, if no clients are listening for any events.</span></span>  
  
<a name="Types_of_Events"></a>   
## <a name="types-of-events"></a><span data-ttu-id="6c52b-108">事件类型</span><span class="sxs-lookup"><span data-stu-id="6c52b-108">Types of Events</span></span>  
 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="6c52b-109">事件分为以下几类：</span><span class="sxs-lookup"><span data-stu-id="6c52b-109">events fall into the following categories.</span></span>  
  
|<span data-ttu-id="6c52b-110">事件</span><span class="sxs-lookup"><span data-stu-id="6c52b-110">Event</span></span>|<span data-ttu-id="6c52b-111">描述</span><span class="sxs-lookup"><span data-stu-id="6c52b-111">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="6c52b-112">属性更改</span><span class="sxs-lookup"><span data-stu-id="6c52b-112">Property change</span></span>|<span data-ttu-id="6c52b-113">当 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 元素上的某个属性或控件模式更改时引发。</span><span class="sxs-lookup"><span data-stu-id="6c52b-113">Raised when a property on an [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] element or control pattern changes.</span></span> <span data-ttu-id="6c52b-114">例如，如果客户端需要监视应用程序的复选框控件，它可以注册来侦听 <xref:System.Windows.Automation.TogglePattern.TogglePatternInformation.ToggleState%2A> 属性上的属性更改事件。</span><span class="sxs-lookup"><span data-stu-id="6c52b-114">For example, if a client needs to monitor an application's check box control, it can register to listen for a property change event on the <xref:System.Windows.Automation.TogglePattern.TogglePatternInformation.ToggleState%2A> property.</span></span> <span data-ttu-id="6c52b-115">选中或取消选中该复选框控件时，提供程序会引发事件且客户端会采取必要的操作。</span><span class="sxs-lookup"><span data-stu-id="6c52b-115">When the check box control is checked or unchecked, the provider raises the event and the client can act as necessary.</span></span>|  
|<span data-ttu-id="6c52b-116">元素操作</span><span class="sxs-lookup"><span data-stu-id="6c52b-116">Element action</span></span>|<span data-ttu-id="6c52b-117">当来自最终用户或编程活动的 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 结果出现更改时引发；例如，单击或通过 <xref:System.Windows.Automation.InvokePattern>调用一个按钮。</span><span class="sxs-lookup"><span data-stu-id="6c52b-117">Raised when a change in the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] results from end user or programmatic activity; for example, when a button is clicked or invoked through <xref:System.Windows.Automation.InvokePattern>.</span></span>|  
|<span data-ttu-id="6c52b-118">结构更改</span><span class="sxs-lookup"><span data-stu-id="6c52b-118">Structure change</span></span>|<span data-ttu-id="6c52b-119">当 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 树的结构更改时引发。</span><span class="sxs-lookup"><span data-stu-id="6c52b-119">Raised when the structure of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree changes.</span></span> <span data-ttu-id="6c52b-120">当新的 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 项在桌面上变成可见、隐藏或被删除时，结构发生变化。</span><span class="sxs-lookup"><span data-stu-id="6c52b-120">The structure changes when new [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] items become visible, hidden, or removed on the desktop.</span></span>|  
|<span data-ttu-id="6c52b-121">全局桌面更改</span><span class="sxs-lookup"><span data-stu-id="6c52b-121">Global desktop change</span></span>|<span data-ttu-id="6c52b-122">当与客户端相关的的全局操作发生时引发，例如当焦点从一个元素转换到另一个元素、或窗口关闭时。</span><span class="sxs-lookup"><span data-stu-id="6c52b-122">Raised when actions of global interest to the client occur, such as when the focus shifts from one element to another, or when a window closes.</span></span>|  
  
 <span data-ttu-id="6c52b-123">一些事件不一定意味着 UI 状态已更改。</span><span class="sxs-lookup"><span data-stu-id="6c52b-123">Some events do not necessarily mean that the state of the UI has changed.</span></span> <span data-ttu-id="6c52b-124">例如，当用户通过 tab 键移动到文本输入字段，然后单击一个按钮更新该字段时，如果用户实际上并未更改文本，则会引发 `TextChangedEvent` 。</span><span class="sxs-lookup"><span data-stu-id="6c52b-124">For example, if the user tabs to a text entry field and then clicks a button to update the field, a `TextChangedEvent` is raised even if the user did not actually change the text.</span></span> <span data-ttu-id="6c52b-125">处理事件时，客户端应用程序在执行操作之前可能有必要检查是否实际发生了任何更改。</span><span class="sxs-lookup"><span data-stu-id="6c52b-125">When processing an event, it may be necessary for a client application to check whether anything has actually changed before taking action.</span></span>  
  
 <span data-ttu-id="6c52b-126">即使 UI 的状态未更改，也可能会引发以下事件。</span><span class="sxs-lookup"><span data-stu-id="6c52b-126">The following events may be raised even when the state of the UI has not changed.</span></span>  
  
- <span data-ttu-id="6c52b-127">`AutomationPropertyChangedEvent` （取决于已更改的属性）</span><span class="sxs-lookup"><span data-stu-id="6c52b-127">`AutomationPropertyChangedEvent` (depending on the property that has changed)</span></span>  
  
- `ElementSelectedEvent`  
  
- `InvalidatedEvent`  
  
- `TextChangedEvent`  
  
<a name="UI_Automation_Event_Identifiers"></a>   
## <a name="ui-automation-event-identifiers"></a><span data-ttu-id="6c52b-128">UI 自动化事件标识符</span><span class="sxs-lookup"><span data-stu-id="6c52b-128">UI Automation Event Identifiers</span></span>  
 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] <span data-ttu-id="6c52b-129">事件由 <xref:System.Windows.Automation.AutomationEvent> 对象标识。</span><span class="sxs-lookup"><span data-stu-id="6c52b-129">events are identified by <xref:System.Windows.Automation.AutomationEvent> objects.</span></span> <span data-ttu-id="6c52b-130"><xref:System.Windows.Automation.AutomationIdentifier.Id%2A> 属性包含唯一标识这类事件的值。</span><span class="sxs-lookup"><span data-stu-id="6c52b-130">The <xref:System.Windows.Automation.AutomationIdentifier.Id%2A> property contains a value that uniquely identifies the kind of event.</span></span>  
  
 <span data-ttu-id="6c52b-131">下表给出了 <xref:System.Windows.Automation.AutomationIdentifier.Id%2A> 的可能值，以及用于事件参数的类型。</span><span class="sxs-lookup"><span data-stu-id="6c52b-131">The possible values for <xref:System.Windows.Automation.AutomationIdentifier.Id%2A> are given in the following table, along with the type used for event arguments.</span></span> <span data-ttu-id="6c52b-132">请注意，由客户端和提供程序使用的标识符都是来自不同类的相同命名的字段。</span><span class="sxs-lookup"><span data-stu-id="6c52b-132">Note that the identifiers used by clients and providers are identically named fields from different classes.</span></span>  
  
|<span data-ttu-id="6c52b-133">客户端标识符</span><span class="sxs-lookup"><span data-stu-id="6c52b-133">Client Identifier</span></span>|<span data-ttu-id="6c52b-134">提供程序标识符</span><span class="sxs-lookup"><span data-stu-id="6c52b-134">Provider identifier</span></span>|<span data-ttu-id="6c52b-135">事件参数类型</span><span class="sxs-lookup"><span data-stu-id="6c52b-135">Event Arguments Type</span></span>|  
|-----------------------|-------------------------|--------------------------|  
|<xref:System.Windows.Automation.AutomationElement.AsyncContentLoadedEvent?displayProperty=nameWithType>|<xref:System.Windows.Automation.AutomationElementIdentifiers.AsyncContentLoadedEvent?displayProperty=nameWithType>|<xref:System.Windows.Automation.AsyncContentLoadedEventArgs>|  
|<xref:System.Windows.Automation.SelectionItemPattern.ElementAddedToSelectionEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.SelectionItemPattern.ElementRemovedFromSelectionEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.SelectionItemPattern.ElementSelectedEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.SelectionPattern.InvalidatedEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.InvokePattern.InvokedEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.AutomationElement.LayoutInvalidatedEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.AutomationElement.MenuClosedEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.AutomationElement.MenuOpenedEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.TextPattern.TextChangedEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.TextPattern.TextSelectionChangedEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.AutomationElement.ToolTipClosedEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.AutomationElement.ToolTipOpenedEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.WindowPattern.WindowOpenedEvent?displayProperty=nameWithType>|<xref:System.Windows.Automation.SelectionItemPatternIdentifiers.ElementAddedToSelectionEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.SelectionItemPatternIdentifiers.ElementRemovedFromSelectionEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.SelectionItemPatternIdentifiers.ElementSelectedEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.SelectionPatternIdentifiers.InvalidatedEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.AutomationElementIdentifiers.LayoutInvalidatedEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.AutomationElementIdentifiers.MenuClosedEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.AutomationElementIdentifiers.MenuOpenedEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.TextPatternIdentifiers.TextChangedEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.TextPatternIdentifiers.TextSelectionChangedEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.AutomationElementIdentifiers.ToolTipClosedEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.AutomationElementIdentifiers.ToolTipOpenedEvent?displayProperty=nameWithType><br /><br /> <xref:System.Windows.Automation.WindowPatternIdentifiers.WindowOpenedEvent?displayProperty=nameWithType>|<xref:System.Windows.Automation.AutomationEventArgs>|  
|<xref:System.Windows.Automation.AutomationElement.AutomationFocusChangedEvent?displayProperty=nameWithType>|<xref:System.Windows.Automation.AutomationElementIdentifiers.AutomationFocusChangedEvent?displayProperty=nameWithType>|<xref:System.Windows.Automation.AutomationFocusChangedEventArgs>|  
|<xref:System.Windows.Automation.AutomationElement.AutomationPropertyChangedEvent?displayProperty=nameWithType>|<xref:System.Windows.Automation.AutomationElementIdentifiers.AutomationPropertyChangedEvent?displayProperty=nameWithType>|<xref:System.Windows.Automation.AutomationPropertyChangedEventArgs>|  
|<xref:System.Windows.Automation.AutomationElement.StructureChangedEvent?displayProperty=nameWithType>|<xref:System.Windows.Automation.AutomationElementIdentifiers.StructureChangedEvent?displayProperty=nameWithType>|<xref:System.Windows.Automation.StructureChangedEventArgs>|  
|<xref:System.Windows.Automation.WindowPattern.WindowClosedEvent?displayProperty=nameWithType>|<xref:System.Windows.Automation.WindowPatternIdentifiers.WindowClosedEvent?displayProperty=nameWithType>|<xref:System.Windows.Automation.WindowClosedEventArgs>|  
  
<a name="UI_Automation_Event_Arguments"></a>   
## <a name="ui-automation-event-arguments"></a><span data-ttu-id="6c52b-136">UI 自动化事件参数</span><span class="sxs-lookup"><span data-stu-id="6c52b-136">UI Automation Event Arguments</span></span>  
 <span data-ttu-id="6c52b-137">下列类能封装事件参数。</span><span class="sxs-lookup"><span data-stu-id="6c52b-137">The following classes encapsulate event arguments.</span></span>  
  
|<span data-ttu-id="6c52b-138">类</span><span class="sxs-lookup"><span data-stu-id="6c52b-138">Class</span></span>|<span data-ttu-id="6c52b-139">描述</span><span class="sxs-lookup"><span data-stu-id="6c52b-139">Description</span></span>|  
|-----------|-----------------|  
|<xref:System.Windows.Automation.AsyncContentLoadedEventArgs>|<span data-ttu-id="6c52b-140">包含有关内容异步加载的信息，包括加载已完成的百分比的信息。</span><span class="sxs-lookup"><span data-stu-id="6c52b-140">Contains information about the asynchronous loading of content, including the percentage of loading completed.</span></span>|  
|<xref:System.Windows.Automation.AutomationEventArgs>|<span data-ttu-id="6c52b-141">包含有关无需额外数据的简单事件的信息。</span><span class="sxs-lookup"><span data-stu-id="6c52b-141">Contains information about a simple event that requires no extra data.</span></span>|  
|<xref:System.Windows.Automation.AutomationFocusChangedEventArgs>|<span data-ttu-id="6c52b-142">包含有关输入焦点从一个元素到另一个元素的变化的信息。</span><span class="sxs-lookup"><span data-stu-id="6c52b-142">Contains information about a change in input focus from one element to another.</span></span> <span data-ttu-id="6c52b-143">此类型的事件是由 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 系统引发，而不是由提供程序引发。</span><span class="sxs-lookup"><span data-stu-id="6c52b-143">Events of this type are raised by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] system, not by providers.</span></span>|  
|<xref:System.Windows.Automation.AutomationPropertyChangedEventArgs>|<span data-ttu-id="6c52b-144">包含有关元素或控件模式的属性值的变化的信息。</span><span class="sxs-lookup"><span data-stu-id="6c52b-144">Contains information about a change in a property value of an element or control pattern.</span></span>|  
|<xref:System.Windows.Automation.StructureChangedEventArgs>|<span data-ttu-id="6c52b-145">包含有关 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 树的变化的信息。</span><span class="sxs-lookup"><span data-stu-id="6c52b-145">Contains information about a change in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree.</span></span>|  
|<xref:System.Windows.Automation.WindowClosedEventArgs>|<span data-ttu-id="6c52b-146">包含有关窗口关闭的信息。</span><span class="sxs-lookup"><span data-stu-id="6c52b-146">Contains information about a window closing.</span></span>|  
  
 <span data-ttu-id="6c52b-147">所有事件参数类都包含一个 <xref:System.Windows.Automation.AutomationEventArgs.EventId%2A> 成员。</span><span class="sxs-lookup"><span data-stu-id="6c52b-147">All the event argument classes contain an <xref:System.Windows.Automation.AutomationEventArgs.EventId%2A> member.</span></span> <span data-ttu-id="6c52b-148">此标识符封装在一个 <xref:System.Windows.Automation.AutomationEvent>中。</span><span class="sxs-lookup"><span data-stu-id="6c52b-148">This identifier is encapsulated in an <xref:System.Windows.Automation.AutomationEvent>.</span></span>  
  
 <span data-ttu-id="6c52b-149">提供程序可从 <xref:System.Windows.Automation.AutomationEvent> 中的字段和控件模式标识符类（如 <xref:System.Windows.Automation.AutomationElementIdentifiers> ）获得用于标识事件的 <xref:System.Windows.Automation.DockPatternIdentifiers>对象。</span><span class="sxs-lookup"><span data-stu-id="6c52b-149">The <xref:System.Windows.Automation.AutomationEvent> objects used to identify events are obtained by providers from fields in <xref:System.Windows.Automation.AutomationElementIdentifiers> and control pattern identifier classes such as <xref:System.Windows.Automation.DockPatternIdentifiers>.</span></span> <span data-ttu-id="6c52b-150">应用程序客户端可从 <xref:System.Windows.Automation.AutomationElement> 中的字段和控件模式类（如 <xref:System.Windows.Automation.DockPattern>）获得等效的字段。</span><span class="sxs-lookup"><span data-stu-id="6c52b-150">The equivalent fields are obtained by client applications from fields in <xref:System.Windows.Automation.AutomationElement> and control pattern classes such as <xref:System.Windows.Automation.DockPattern>.</span></span>  
  
 <span data-ttu-id="6c52b-151">有关事件标识符的列表，请参阅 [UI Automation Events for Clients](../../../docs/framework/ui-automation/ui-automation-events-for-clients.md)。</span><span class="sxs-lookup"><span data-stu-id="6c52b-151">For a list of event identifiers, see [UI Automation Events for Clients](../../../docs/framework/ui-automation/ui-automation-events-for-clients.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6c52b-152">请参阅</span><span class="sxs-lookup"><span data-stu-id="6c52b-152">See also</span></span>

- [<span data-ttu-id="6c52b-153">客户端的 UI 自动化事件</span><span class="sxs-lookup"><span data-stu-id="6c52b-153">UI Automation Events for Clients</span></span>](../../../docs/framework/ui-automation/ui-automation-events-for-clients.md)
- [<span data-ttu-id="6c52b-154">服务器端 UI 自动化提供程序实现</span><span class="sxs-lookup"><span data-stu-id="6c52b-154">Server-Side UI Automation Provider Implementation</span></span>](../../../docs/framework/ui-automation/server-side-ui-automation-provider-implementation.md)
- [<span data-ttu-id="6c52b-155">订阅 UI 自动化事件</span><span class="sxs-lookup"><span data-stu-id="6c52b-155">Subscribe to UI Automation Events</span></span>](../../../docs/framework/ui-automation/subscribe-to-ui-automation-events.md)
