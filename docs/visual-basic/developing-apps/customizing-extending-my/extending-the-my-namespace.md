---
title: 扩展 My 命名空间
ms.date: 07/20/2015
f1_keywords:
- vb.AddingMyExtensions
helpviewer_keywords:
- My namespace [Visual Basic], customizing
- My namespace
- My namespace [Visual Basic], extending
ms.assetid: 808e8617-b01c-4135-8b21-babe87389e8e
ms.openlocfilehash: 2a7b0b84061fccd9a333a68e4a19477bd19ca4ff
ms.sourcegitcommit: 17ee6605e01ef32506f8fdc686954244ba6911de
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/22/2019
ms.locfileid: "74330317"
---
# <a name="extending-the-my-namespace-in-visual-basic"></a><span data-ttu-id="55abe-102">扩展 Visual Basic 中的 `My` 命名空间</span><span class="sxs-lookup"><span data-stu-id="55abe-102">Extending the `My` Namespace in Visual Basic</span></span>

<span data-ttu-id="55abe-103">Visual Basic 中的 `My` 命名空间公开使你可以轻松利用 .NET Framework 的强大功能的属性和方法。</span><span class="sxs-lookup"><span data-stu-id="55abe-103">The `My` namespace in Visual Basic exposes properties and methods that enable you to easily take advantage of the power of the .NET Framework.</span></span> <span data-ttu-id="55abe-104">`My` 命名空间简化了常见编程问题，通常可将困难任务简化为一行代码。</span><span class="sxs-lookup"><span data-stu-id="55abe-104">The `My` namespace simplifies common programming problems, often reducing a difficult task to a single line of code.</span></span> <span data-ttu-id="55abe-105">此外，`My` 命名空间完全可扩展，因此，你可以自定义 `My` 的行为并将新服务添加到其层次结构中，以适应特定应用程序需求。</span><span class="sxs-lookup"><span data-stu-id="55abe-105">Additionally, the `My` namespace is fully extensible so that you can customize the behavior of `My` and add new services to its hierarchy to adapt to specific application needs.</span></span> <span data-ttu-id="55abe-106">本主题讨论如何自定义 `My` 命名空间的现有成员以及如何向 `My` 命名空间添加自己的自定义类。</span><span class="sxs-lookup"><span data-stu-id="55abe-106">This topic discusses both how to customize existing members of the `My` namespace and how to add your own custom classes to the `My` namespace.</span></span>

## <a name="customizing-existing-my-namespace-members"></a><span data-ttu-id="55abe-107">自定义现有 `My` 命名空间成员</span><span class="sxs-lookup"><span data-stu-id="55abe-107">Customizing existing `My` namespace members</span></span>

<span data-ttu-id="55abe-108">Visual Basic 中的 `My` 命名空间公开有关应用程序、计算机等的常用信息。</span><span class="sxs-lookup"><span data-stu-id="55abe-108">The `My` namespace in Visual Basic exposes frequently used information about your application, your computer, and more.</span></span> <span data-ttu-id="55abe-109">有关 `My` 命名空间中对象的完整列表，请参阅 [My 引用](../../language-reference/keywords/my-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="55abe-109">For a complete list of the objects in the `My` namespace, see [My Reference](../../language-reference/keywords/my-reference.md).</span></span> <span data-ttu-id="55abe-110">你可能必须自定义 `My` 命名空间的现有成员，以便它们更好地满足你的应用程序的需求。</span><span class="sxs-lookup"><span data-stu-id="55abe-110">You may have to customize existing members of the `My` namespace so that they better match the needs of your application.</span></span> <span data-ttu-id="55abe-111">`My` 命名空间中的对象的所有非只读属性都可以设置为自定义值。</span><span class="sxs-lookup"><span data-stu-id="55abe-111">Any property of an object in the `My` namespace that is not read-only can be set to a custom value.</span></span>

<span data-ttu-id="55abe-112">例如，假设你经常为运行应用程序的用户使用 `My.User` 对象访问当前安全上下文。</span><span class="sxs-lookup"><span data-stu-id="55abe-112">For example, assume that you frequently use the `My.User` object to access the current security context for the user running your application.</span></span> <span data-ttu-id="55abe-113">但是，你的公司使用自定义用户对象为公司内的用户公开其他信息和功能。</span><span class="sxs-lookup"><span data-stu-id="55abe-113">However, your company uses a custom user object to expose additional information and capabilities for users within the company.</span></span> <span data-ttu-id="55abe-114">在此方案中，你可以使用自己的自定义主体对象的实例替换 `My.User.CurrentPrincipal` 属性的默认值，如以下示例所示：</span><span class="sxs-lookup"><span data-stu-id="55abe-114">In this scenario, you can replace the default value of the `My.User.CurrentPrincipal` property with an instance of your own custom principal object, as shown in the following example:</span></span>

[!code-vb[VbVbcnExtendingMy#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#1)]

<span data-ttu-id="55abe-115">在 `My.User` 对象上设置 `CurrentPrincipal` 属性将更改应用程序运行所依据的身份。</span><span class="sxs-lookup"><span data-stu-id="55abe-115">Setting the `CurrentPrincipal` property on the `My.User` object changes the identity under which the application runs.</span></span> <span data-ttu-id="55abe-116">`My.User` 对象反过来会返回有关新指定用户的信息。</span><span class="sxs-lookup"><span data-stu-id="55abe-116">The `My.User` object, in turn, returns information about the newly specified user.</span></span>
  
## <a name="adding-members-to-my-objects"></a><span data-ttu-id="55abe-117">将成员添加到 `My` 对象</span><span class="sxs-lookup"><span data-stu-id="55abe-117">Adding members to `My` objects</span></span>

<span data-ttu-id="55abe-118">从 `My.Application` 和 `My.Computer` 返回的类型定义为 `Partial` 类。</span><span class="sxs-lookup"><span data-stu-id="55abe-118">The types returned from `My.Application` and `My.Computer` are defined as `Partial` classes.</span></span> <span data-ttu-id="55abe-119">因此，可以通过创建名为 `MyApplication` 或 `MyComputer` 的 `Partial` 类来扩展 `My.Application` 和 `My.Computer` 对象。</span><span class="sxs-lookup"><span data-stu-id="55abe-119">Therefore, you can extend the `My.Application` and `My.Computer` objects by creating a `Partial` class named `MyApplication` or `MyComputer`.</span></span> <span data-ttu-id="55abe-120">该类不能是 `Private` 类。</span><span class="sxs-lookup"><span data-stu-id="55abe-120">The class cannot be a `Private` class.</span></span> <span data-ttu-id="55abe-121">如果将类指定为 `My` 命名空间的一部分，则可以添加将包含在 `My.Application` 或 `My.Computer` 对象中的属性和方法。</span><span class="sxs-lookup"><span data-stu-id="55abe-121">If you specify the class as part of the `My` namespace, you can add properties and methods that will be included with the `My.Application` or `My.Computer` objects.</span></span>

<span data-ttu-id="55abe-122">以下示例将名为 `DnsServerIPAddresses` 的属性添加到 `My.Computer` 对象：</span><span class="sxs-lookup"><span data-stu-id="55abe-122">The following example adds a property named `DnsServerIPAddresses` to the `My.Computer` object:</span></span>

[!code-vb[VbVbcnExtendingMy#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class2.vb#2)]

## <a name="adding-custom-objects-to-the-my-namespace"></a><span data-ttu-id="55abe-123">将自定义对象添加到 `My` 命名空间</span><span class="sxs-lookup"><span data-stu-id="55abe-123">Adding custom objects to the `My` namespace</span></span>

<span data-ttu-id="55abe-124">尽管 `My` 命名空间为许多常见的编程任务提供了解决方案，但你可能会遇到 `My` 命名空间未解决的任务。</span><span class="sxs-lookup"><span data-stu-id="55abe-124">Although the `My` namespace provides solutions for many common programming tasks, you may encounter tasks that the `My` namespace does not address.</span></span> <span data-ttu-id="55abe-125">例如，你的应用程序可能会访问用于用户数据的自定义目录服务，或者，你的应用程序可能会使用 Visual Basic 未默认安装的程序集。</span><span class="sxs-lookup"><span data-stu-id="55abe-125">For example, your application might access custom directory services for user data, or your application might use assemblies that are not installed by default with Visual Basic.</span></span> <span data-ttu-id="55abe-126">你可以扩展 `My` 命名空间，以包括针对特定于你的环境的常见任务的自定义解决方案。</span><span class="sxs-lookup"><span data-stu-id="55abe-126">You can extend the `My` namespace to include custom solutions to common tasks that are specific to your environment.</span></span> <span data-ttu-id="55abe-127">`My` 命名空间可以轻松扩展以添加新成员，从而满足不断增长的应用程序需求。</span><span class="sxs-lookup"><span data-stu-id="55abe-127">The `My` namespace can easily be extended to add new members to meet growing application needs.</span></span> <span data-ttu-id="55abe-128">此外，你可以将 `My` 命名空间扩展作为 Visual Basic 模板部署给其他开发人员。</span><span class="sxs-lookup"><span data-stu-id="55abe-128">Additionally, you can deploy your `My` namespace extensions to other developers as a Visual Basic template.</span></span>
  
### <a name="adding-members-to-the-my-namespace"></a><span data-ttu-id="55abe-129">将成员添加到 `My` 命名空间</span><span class="sxs-lookup"><span data-stu-id="55abe-129">Adding members to the `My` namespace</span></span>

<span data-ttu-id="55abe-130">因为 `My` 是与任何其他命名空间一样的命名空间，所以可以通过添加模块并指定 `My` 的 `Namespace` 来为其添加顶级属性。</span><span class="sxs-lookup"><span data-stu-id="55abe-130">Because `My` is a namespace like any other namespace, you can add top-level properties to it by just adding a module and specifying a `Namespace` of `My`.</span></span> <span data-ttu-id="55abe-131">使用 `HideModuleName` 属性注释模块，如下面的示例所示。</span><span class="sxs-lookup"><span data-stu-id="55abe-131">Annotate the module with the `HideModuleName` attribute as shown in the following example.</span></span> <span data-ttu-id="55abe-132">`HideModuleName` 属性可确保 IntelliSense 在显示 `My` 命名空间的成员时不显示模块名称。</span><span class="sxs-lookup"><span data-stu-id="55abe-132">The `HideModuleName` attribute ensures that IntelliSense will not display the module name when it displays the members of the `My` namespace.</span></span>

[!code-vb[VbVbcnExtendingMy#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#3)]

<span data-ttu-id="55abe-133">若要将成员添加到 `My` 命名空间，请根据需要向模块添加属性。</span><span class="sxs-lookup"><span data-stu-id="55abe-133">To add members to the `My` namespace, add properties as needed to the module.</span></span> <span data-ttu-id="55abe-134">对于添加到 `My` 命名空间的每个属性，添加一个类型为 `ThreadSafeObjectProvider(Of T)` 的专用字段，该类型为自定义属性返回的类型。</span><span class="sxs-lookup"><span data-stu-id="55abe-134">For each property added to the `My` namespace, add a private field of type `ThreadSafeObjectProvider(Of T)`, where the type is the type returned by your custom property.</span></span> <span data-ttu-id="55abe-135">此字段用于创建线程安全的对象实例，该实例由属性通过调用 `GetInstance` 方法返回。</span><span class="sxs-lookup"><span data-stu-id="55abe-135">This field is used to create thread-safe object instances to be returned by the property by calling the `GetInstance` method.</span></span> <span data-ttu-id="55abe-136">因此，每个访问扩展属性的线程都会收到其自己的返回类型的实例。</span><span class="sxs-lookup"><span data-stu-id="55abe-136">As a result, each thread that is accessing the extended property receives its own instance of the returned type.</span></span> <span data-ttu-id="55abe-137">以下示例将名为 `SampleExtension` 的属性（类型为 `SampleExtension`）添加到 `My` 命名空间：</span><span class="sxs-lookup"><span data-stu-id="55abe-137">The following example adds a property named `SampleExtension` that is of type `SampleExtension` to the `My` namespace:</span></span>

[!code-vb[VbVbcnExtendingMy#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#4)]

## <a name="adding-events-to-custom-my-objects"></a><span data-ttu-id="55abe-138">将事件添加到自定义 `My` 对象</span><span class="sxs-lookup"><span data-stu-id="55abe-138">Adding events to custom `My` objects</span></span>

<span data-ttu-id="55abe-139">通过扩展 `My` 命名空间中的 `MyApplication` 分部类，可以使用 `My.Application` 对象公开自定义 `My` 对象的事件。</span><span class="sxs-lookup"><span data-stu-id="55abe-139">You can use the `My.Application` object to expose events for your custom `My` objects by extending the `MyApplication` partial class in the `My` namespace.</span></span> <span data-ttu-id="55abe-140">对于基于 Windows 的项目，可以在**解决方案资源管理器**中双击项目的“ My 项目”节点  。</span><span class="sxs-lookup"><span data-stu-id="55abe-140">For Windows-based projects, you can double-click the **My Project** node in for your project in **Solution Explorer**.</span></span> <span data-ttu-id="55abe-141">在 Visual Basic **项目设计器**中，单击“应用程序”选项卡，然后单击“查看应用程序事件”按钮   。</span><span class="sxs-lookup"><span data-stu-id="55abe-141">In the Visual Basic **Project Designer**, click the **Application** tab and then click the **View Application Events** button.</span></span> <span data-ttu-id="55abe-142">将创建一个名为 *ApplicationEvents.vb* 的新文件。</span><span class="sxs-lookup"><span data-stu-id="55abe-142">A new file that is named *ApplicationEvents.vb* will be created.</span></span> <span data-ttu-id="55abe-143">它包含以下用于扩展 `MyApplication` 类的代码：</span><span class="sxs-lookup"><span data-stu-id="55abe-143">It contains the following code for extending the `MyApplication` class:</span></span>

[!code-vb[VbVbcnExtendingMy#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#5)]

<span data-ttu-id="55abe-144">你可以通过向 `MyApplication` 类添加自定义事件处理程序来为自定义 `My` 对象添加事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="55abe-144">You can add event handlers for your custom `My` objects by adding custom event handlers to the `MyApplication` class.</span></span> <span data-ttu-id="55abe-145">借助自定义事件，你可以添加将在添加、删除事件处理程序时或引发事件时执行的代码。</span><span class="sxs-lookup"><span data-stu-id="55abe-145">Custom events enable you to add code that will execute when an event handler is added, removed, or the event is raised.</span></span> <span data-ttu-id="55abe-146">请注意，仅当用户添加了用于处理事件的代码时，才会运行用于自定义事件的 `AddHandler` 代码。</span><span class="sxs-lookup"><span data-stu-id="55abe-146">Note that the `AddHandler` code for a custom event runs only if code is added by a user to handle the event.</span></span> <span data-ttu-id="55abe-147">例如，假设前面部分中的 `SampleExtension` 对象具有要为其添加自定义事件处理程序的 `Load` 事件。</span><span class="sxs-lookup"><span data-stu-id="55abe-147">For example, consider that the `SampleExtension` object from the previous section has a `Load` event that you want to add a custom event handler for.</span></span> <span data-ttu-id="55abe-148">以下代码示例演示了名为 `SampleExtensionLoad` 的自定义事件处理程序，该事件处理程序将在 `My.SampleExtension.Load` 事件发生时被调用。</span><span class="sxs-lookup"><span data-stu-id="55abe-148">The following code example shows a custom event handler named `SampleExtensionLoad` that will be invoked when the `My.SampleExtension.Load` event occurs.</span></span> <span data-ttu-id="55abe-149">添加代码以处理新的 `My.SampleExtensionLoad` 事件时，将执行此自定义事件代码的 `AddHandler` 部分。</span><span class="sxs-lookup"><span data-stu-id="55abe-149">When code is added to handle the new `My.SampleExtensionLoad` event, the `AddHandler` part of this custom event code is executed.</span></span> <span data-ttu-id="55abe-150">代码示例中包含 `MyApplication_SampleExtensionLoad` 方法，以显示处理 `My.SampleExtensionLoad` 事件的事件处理程序的示例。</span><span class="sxs-lookup"><span data-stu-id="55abe-150">The `MyApplication_SampleExtensionLoad` method is included in the code example to show an example of an event handler that handles the `My.SampleExtensionLoad` event.</span></span> <span data-ttu-id="55abe-151">请注意，在你编辑 *ApplicationEvents.vb* 文件时，如果在代码编辑器左上方的下拉列表中选择“My 应用程序事件”选项，则 `SampleExtensionLoad` 事件将可用  。</span><span class="sxs-lookup"><span data-stu-id="55abe-151">Note that the `SampleExtensionLoad` event will be available when you select the **My Application Events** option in the left drop-down list above the Code Editor when you are editing the *ApplicationEvents.vb* file.</span></span>

[!code-vb[VbVbcnExtendingMy#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#6)]

## <a name="design-guidelines"></a><span data-ttu-id="55abe-152">设计指南</span><span class="sxs-lookup"><span data-stu-id="55abe-152">Design guidelines</span></span>

<span data-ttu-id="55abe-153">在开发 `My` 命名空间的扩展时，请遵循以下指南以帮助最大程度地降低扩展组件的维护成本：</span><span class="sxs-lookup"><span data-stu-id="55abe-153">When you develop extensions to the `My` namespace, use the following guidelines to help minimize the maintenance costs of your extension components:</span></span>

- <span data-ttu-id="55abe-154">**仅包含扩展逻辑。**</span><span class="sxs-lookup"><span data-stu-id="55abe-154">**Include only the extension logic.**</span></span> <span data-ttu-id="55abe-155">`My` 命名空间扩展中包含的逻辑应仅包含在 `My` 命名空间中公开所需功能所需的代码。</span><span class="sxs-lookup"><span data-stu-id="55abe-155">The logic included in the `My` namespace extension should include only the code that is needed to expose the required functionality in the `My` namespace.</span></span> <span data-ttu-id="55abe-156">因为扩展将作为源代码驻留在用户项目中，所以更新扩展组件会产生较高的维护成本，应尽可能避免这种情况。</span><span class="sxs-lookup"><span data-stu-id="55abe-156">Because your extension will reside in user projects as source code, updating the extension component incurs a high maintenance cost and should be avoided if possible.</span></span>
- <span data-ttu-id="55abe-157">**最大程度地减少项目假设。**</span><span class="sxs-lookup"><span data-stu-id="55abe-157">**Minimize project assumptions.**</span></span> <span data-ttu-id="55abe-158">在创建 `My` 命名空间的扩展时，请勿假设使用一组引用、项目级导入或特定编译器设置（例如，关闭 `Option Strict`）。</span><span class="sxs-lookup"><span data-stu-id="55abe-158">When you create your extensions of the `My` namespace, do not assume a set of references, project-level imports, or specific compiler settings (for example, `Option Strict` off).</span></span> <span data-ttu-id="55abe-159">相反，请使用 `Global` 关键字最大程度地减少依赖项并完全限定所有类型引用。</span><span class="sxs-lookup"><span data-stu-id="55abe-159">Instead, minimize dependencies and fully qualify all type references by using the `Global` keyword.</span></span> <span data-ttu-id="55abe-160">此外，请确保在打开 `Option Strict` 的情况下编译扩展，以最大程度地减少扩展中的错误。</span><span class="sxs-lookup"><span data-stu-id="55abe-160">Also, ensure that the extension compiles with `Option Strict` on to minimize errors in the extension.</span></span>
- <span data-ttu-id="55abe-161">**隔离扩展代码。**</span><span class="sxs-lookup"><span data-stu-id="55abe-161">**Isolate the extension code.**</span></span> <span data-ttu-id="55abe-162">将代码放在单个文件中可使你的扩展能够作为 Visual Studio 项目模板轻松部署。</span><span class="sxs-lookup"><span data-stu-id="55abe-162">Placing the code in a single file makes your extension easily deployable as a Visual Studio item template.</span></span> <span data-ttu-id="55abe-163">有关详细信息，请参阅本主题后面的“打包和部署扩展”。</span><span class="sxs-lookup"><span data-stu-id="55abe-163">For more information, see "Packaging and Deploying Extensions" later in this topic.</span></span> <span data-ttu-id="55abe-164">将所有 `My` 命名空间扩展代码放在项目中的单个文件或单独文件夹中还将有助于用户找到 `My` 命名空间扩展。</span><span class="sxs-lookup"><span data-stu-id="55abe-164">Placing all the `My` namespace extension code in a single file or a separate folder in a project will also help users locate the `My` namespace extension.</span></span>

## <a name="designing-class-libraries-for-my"></a><span data-ttu-id="55abe-165">为 `My` 设计类库</span><span class="sxs-lookup"><span data-stu-id="55abe-165">Designing class libraries for `My`</span></span>

<span data-ttu-id="55abe-166">与大多数对象模型一样，某些设计模式适用于 `My` 命名空间，而另一些设计模式则不适用。</span><span class="sxs-lookup"><span data-stu-id="55abe-166">As is the case with most object models, some design patterns work well in the `My` namespace and others do not.</span></span> <span data-ttu-id="55abe-167">设计 `My` 命名空间扩展时，请考虑以下原则：</span><span class="sxs-lookup"><span data-stu-id="55abe-167">When designing an extension to the `My` namespace, consider the following principles:</span></span>

- <span data-ttu-id="55abe-168">**无状态方法。**</span><span class="sxs-lookup"><span data-stu-id="55abe-168">**Stateless methods.**</span></span> <span data-ttu-id="55abe-169">`My` 命名空间中的方法应提供针对特定任务的完整解决方案。</span><span class="sxs-lookup"><span data-stu-id="55abe-169">Methods in the `My` namespace should provide a complete solution to a specific task.</span></span> <span data-ttu-id="55abe-170">确保传递给方法的参数值提供完成特定任务所需的全部输入。</span><span class="sxs-lookup"><span data-stu-id="55abe-170">Ensure that the parameter values that are passed to the method provide all the input required to complete the particular task.</span></span> <span data-ttu-id="55abe-171">避免创建依赖于之前状态的方法，例如与资源的开放连接。</span><span class="sxs-lookup"><span data-stu-id="55abe-171">Avoid creating methods that rely on prior state, such as open connections to resources.</span></span>
- <span data-ttu-id="55abe-172">**全局实例。**</span><span class="sxs-lookup"><span data-stu-id="55abe-172">**Global instances.**</span></span> <span data-ttu-id="55abe-173">`My` 命名空间中维护的唯一状态是项目的全局状态。</span><span class="sxs-lookup"><span data-stu-id="55abe-173">The only state that is maintained in the `My` namespace is global to the project.</span></span> <span data-ttu-id="55abe-174">例如，`My.Application.Info` 封装整个应用程序共享的状态。</span><span class="sxs-lookup"><span data-stu-id="55abe-174">For example, `My.Application.Info` encapsulates state that is shared throughout the application.</span></span>
- <span data-ttu-id="55abe-175">**简单参数类型。**</span><span class="sxs-lookup"><span data-stu-id="55abe-175">**Simple parameter types.**</span></span> <span data-ttu-id="55abe-176">通过避免使用复杂参数类型使操作变得简单。</span><span class="sxs-lookup"><span data-stu-id="55abe-176">Keep things simple by avoiding complex parameter types.</span></span> <span data-ttu-id="55abe-177">相反，创建不使用参数输入或使用简单输入类型（例如字符串、基元类型等）的方法。</span><span class="sxs-lookup"><span data-stu-id="55abe-177">Instead, create methods that either take no parameter input or that take simple input types such as strings, primitive types, and so on.</span></span>
- <span data-ttu-id="55abe-178">**工厂方法。**</span><span class="sxs-lookup"><span data-stu-id="55abe-178">**Factory methods.**</span></span> <span data-ttu-id="55abe-179">某些类型必然很难实例化。</span><span class="sxs-lookup"><span data-stu-id="55abe-179">Some types are necessarily difficult to instantiate.</span></span> <span data-ttu-id="55abe-180">提供工厂方法作为 `My` 命名空间的扩展，这样一来，你可以更轻松地发现和使用属于此类别的类型。</span><span class="sxs-lookup"><span data-stu-id="55abe-180">Providing factory methods as extensions to the `My` namespace enables you to more easily discover and consume types that fall into this category.</span></span> <span data-ttu-id="55abe-181">`My.Computer.FileSystem.OpenTextFileReader` 是一个效果很好的工厂方法示例。</span><span class="sxs-lookup"><span data-stu-id="55abe-181">An example of a factory method that works well is `My.Computer.FileSystem.OpenTextFileReader`.</span></span> <span data-ttu-id="55abe-182">.NET Framework 中有几种可用的流类型。</span><span class="sxs-lookup"><span data-stu-id="55abe-182">There are several stream types available in the .NET Framework.</span></span> <span data-ttu-id="55abe-183">通过专门指定文本文件，`OpenTextFileReader` 可帮助用户了解要使用的流。</span><span class="sxs-lookup"><span data-stu-id="55abe-183">By specifying text files specifically, the `OpenTextFileReader` helps the user understand which stream to use.</span></span>

<span data-ttu-id="55abe-184">这些指南不妨碍类库的一般设计原则。</span><span class="sxs-lookup"><span data-stu-id="55abe-184">These guidelines do not preclude general design principles for class libraries.</span></span> <span data-ttu-id="55abe-185">相反，它们是针对正在使用 Visual Basic 和 `My` 命名空间的开发人员进行优化的建议。</span><span class="sxs-lookup"><span data-stu-id="55abe-185">Rather, they are recommendations that are optimized for developers who are using Visual Basic and the `My` namespace.</span></span> <span data-ttu-id="55abe-186">有关创建类库的一般设计原则，请参阅[框架设计指南](../../../standard/design-guidelines/index.md)。</span><span class="sxs-lookup"><span data-stu-id="55abe-186">For general design principles for creating class libraries, see [Framework Design Guidelines](../../../standard/design-guidelines/index.md).</span></span>

## <a name="packaging-and-deploying-extensions"></a><span data-ttu-id="55abe-187">打包和部署扩展</span><span class="sxs-lookup"><span data-stu-id="55abe-187">Packaging and deploying extensions</span></span>

<span data-ttu-id="55abe-188">你可以在 Visual Studio 项目模板中包括 `My` 命名空间扩展，也可以打包扩展并将其作为 Visual Studio 项目模板部署。</span><span class="sxs-lookup"><span data-stu-id="55abe-188">You can include `My` namespace extensions in a Visual Studio project template, or you can package your extensions and deploy them as a Visual Studio item template.</span></span> <span data-ttu-id="55abe-189">将 `My` 命名空间扩展打包为 Visual Studio 项目模板时，可以利用 Visual Basic 提供的其他功能。</span><span class="sxs-lookup"><span data-stu-id="55abe-189">When you package your `My` namespace extensions as a Visual Studio item template, you can take advantage of additional capabilities provided by Visual Basic.</span></span> <span data-ttu-id="55abe-190">这些功能使你可以在项目引用特定程序集时包括扩展，或者使用户能够使用 Visual Basic 项目设计器的“My 扩展”页来显式添加 `My` 命名空间扩展  。</span><span class="sxs-lookup"><span data-stu-id="55abe-190">These capabilities enable you to include an extension when a project references a particular assembly, or enable users to explicitly add your `My` namespace extension by using the **My Extensions** page of the Visual Basic Project Designer.</span></span>

<span data-ttu-id="55abe-191">有关如何部署 `My` 命名空间扩展的详细信息，请参阅[打包和部署自定义 My 扩展](packaging-and-deploying-custom-my-extensions.md)。</span><span class="sxs-lookup"><span data-stu-id="55abe-191">For details about how to deploy `My` namespace extensions, see [Packaging and Deploying Custom My Extensions](packaging-and-deploying-custom-my-extensions.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="55abe-192">请参阅</span><span class="sxs-lookup"><span data-stu-id="55abe-192">See also</span></span>

- [<span data-ttu-id="55abe-193">打包和部署自定义 My 扩展</span><span class="sxs-lookup"><span data-stu-id="55abe-193">Packaging and Deploying Custom My Extensions</span></span>](packaging-and-deploying-custom-my-extensions.md)
- [<span data-ttu-id="55abe-194">扩展 Visual Basic 应用程序模型</span><span class="sxs-lookup"><span data-stu-id="55abe-194">Extending the Visual Basic Application Model</span></span>](extending-the-visual-basic-application-model.md)
- [<span data-ttu-id="55abe-195">自定义 My 中可用的对象</span><span class="sxs-lookup"><span data-stu-id="55abe-195">Customizing Which Objects are Available in My</span></span>](customizing-which-objects-are-available-in-my.md)
- [<span data-ttu-id="55abe-196">“项目设计器”->“My 扩展”页</span><span class="sxs-lookup"><span data-stu-id="55abe-196">My Extensions Page, Project Designer</span></span>](/visualstudio/ide/reference/my-extensions-page-project-designer-visual-basic)
- [<span data-ttu-id="55abe-197">“项目设计器”->“应用程序”页 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="55abe-197">Application Page, Project Designer (Visual Basic)</span></span>](/visualstudio/ide/reference/application-page-project-designer-visual-basic)
- [<span data-ttu-id="55abe-198">Partial</span><span class="sxs-lookup"><span data-stu-id="55abe-198">Partial</span></span>](../../language-reference/modifiers/partial.md)
