---
title: 扩展 Visual Basic 中的 My 命名空间
ms.date: 07/20/2015
f1_keywords:
- vb.AddingMyExtensions
helpviewer_keywords:
- My namespace [Visual Basic], customizing
- My namespace
- My namespace [Visual Basic], extending
ms.assetid: 808e8617-b01c-4135-8b21-babe87389e8e
ms.openlocfilehash: 6da0914c9d2d4dc1220ede5d6fa9f1aa6b43426a
ms.sourcegitcommit: 559259da2738a7b33a46c0130e51d336091c2097
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/22/2019
ms.locfileid: "72775304"
---
# <a name="extending-the-my-namespace-in-visual-basic"></a><span data-ttu-id="8edbf-102">扩展中的 `My` 命名空间 Visual Basic</span><span class="sxs-lookup"><span data-stu-id="8edbf-102">Extending the `My` Namespace in Visual Basic</span></span>

<span data-ttu-id="8edbf-103">Visual Basic 中的 `My` 命名空间公开了一些属性和方法，使你能够轻松利用 .NET Framework 的强大功能。</span><span class="sxs-lookup"><span data-stu-id="8edbf-103">The `My` namespace in Visual Basic exposes properties and methods that enable you to easily take advantage of the power of the .NET Framework.</span></span> <span data-ttu-id="8edbf-104">@No__t_0 命名空间简化了常见编程问题，通常会将很难的任务减少到单个代码行。</span><span class="sxs-lookup"><span data-stu-id="8edbf-104">The `My` namespace simplifies common programming problems, often reducing a difficult task to a single line of code.</span></span> <span data-ttu-id="8edbf-105">此外，`My` 命名空间是完全可扩展的，因此您可以自定义 `My` 的行为，并向其层次结构中添加新服务以适应特定的应用程序需求。</span><span class="sxs-lookup"><span data-stu-id="8edbf-105">Additionally, the `My` namespace is fully extensible so that you can customize the behavior of `My` and add new services to its hierarchy to adapt to specific application needs.</span></span> <span data-ttu-id="8edbf-106">本主题讨论如何自定义 `My` 命名空间的现有成员以及如何将您自己的自定义类添加到 `My` 命名空间。</span><span class="sxs-lookup"><span data-stu-id="8edbf-106">This topic discusses both how to customize existing members of the `My` namespace and how to add your own custom classes to the `My` namespace.</span></span>

## <a name="customizing-existing-my-namespace-members"></a><span data-ttu-id="8edbf-107">自定义现有 `My` 命名空间成员</span><span class="sxs-lookup"><span data-stu-id="8edbf-107">Customizing existing `My` namespace members</span></span>

<span data-ttu-id="8edbf-108">Visual Basic 中的 `My` 命名空间公开有关您的应用程序、您的计算机等的常用信息。</span><span class="sxs-lookup"><span data-stu-id="8edbf-108">The `My` namespace in Visual Basic exposes frequently used information about your application, your computer, and more.</span></span> <span data-ttu-id="8edbf-109">有关 `My` 命名空间中的对象的完整列表，请参阅[我的参考](../../language-reference/keywords/my-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="8edbf-109">For a complete list of the objects in the `My` namespace, see [My Reference](../../language-reference/keywords/my-reference.md).</span></span> <span data-ttu-id="8edbf-110">您可能必须自定义 `My` 命名空间的现有成员，使其更适合您的应用程序的需求。</span><span class="sxs-lookup"><span data-stu-id="8edbf-110">You may have to customize existing members of the `My` namespace so that they better match the needs of your application.</span></span> <span data-ttu-id="8edbf-111">不是只读的 `My` 命名空间中的对象的任何属性都可以设置为自定义值。</span><span class="sxs-lookup"><span data-stu-id="8edbf-111">Any property of an object in the `My` namespace that is not read-only can be set to a custom value.</span></span>

<span data-ttu-id="8edbf-112">例如，假设你经常使用 `My.User` 对象来访问运行应用程序的用户的当前安全上下文。</span><span class="sxs-lookup"><span data-stu-id="8edbf-112">For example, assume that you frequently use the `My.User` object to access the current security context for the user running your application.</span></span> <span data-ttu-id="8edbf-113">但是，公司使用自定义用户对象为公司内的用户公开附加信息和功能。</span><span class="sxs-lookup"><span data-stu-id="8edbf-113">However, your company uses a custom user object to expose additional information and capabilities for users within the company.</span></span> <span data-ttu-id="8edbf-114">在这种情况下，你可以将 `My.User.CurrentPrincipal` 属性的默认值替换为你自己的自定义主体对象的实例，如以下示例中所示：</span><span class="sxs-lookup"><span data-stu-id="8edbf-114">In this scenario, you can replace the default value of the `My.User.CurrentPrincipal` property with an instance of your own custom principal object, as shown in the following example:</span></span>

[!code-vb[VbVbcnExtendingMy#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#1)]

<span data-ttu-id="8edbf-115">设置 `My.User` 对象的 `CurrentPrincipal` 属性将更改运行应用程序时所用的标识。</span><span class="sxs-lookup"><span data-stu-id="8edbf-115">Setting the `CurrentPrincipal` property on the `My.User` object changes the identity under which the application runs.</span></span> <span data-ttu-id="8edbf-116">然后，`My.User` 对象将返回有关新指定用户的信息。</span><span class="sxs-lookup"><span data-stu-id="8edbf-116">The `My.User` object, in turn, returns information about the newly specified user.</span></span>
  
## <a name="adding-members-to-my-objects"></a><span data-ttu-id="8edbf-117">将成员添加到 `My` 对象</span><span class="sxs-lookup"><span data-stu-id="8edbf-117">Adding members to `My` objects</span></span>

<span data-ttu-id="8edbf-118">从 `My.Application` 和 `My.Computer` 返回的类型定义为 `Partial` 类。</span><span class="sxs-lookup"><span data-stu-id="8edbf-118">The types returned from `My.Application` and `My.Computer` are defined as `Partial` classes.</span></span> <span data-ttu-id="8edbf-119">因此，可以通过创建一个名为 `MyApplication` 或 `MyComputer` 的 `Partial` 类来扩展 `My.Application` 和 `My.Computer` 对象。</span><span class="sxs-lookup"><span data-stu-id="8edbf-119">Therefore, you can extend the `My.Application` and `My.Computer` objects by creating a `Partial` class named `MyApplication` or `MyComputer`.</span></span> <span data-ttu-id="8edbf-120">类不能是 `Private` 类。</span><span class="sxs-lookup"><span data-stu-id="8edbf-120">The class cannot be a `Private` class.</span></span> <span data-ttu-id="8edbf-121">如果将类指定为 `My` 命名空间的一部分，则可以添加将包含在 `My.Application` 或 `My.Computer` 对象中的属性和方法。</span><span class="sxs-lookup"><span data-stu-id="8edbf-121">If you specify the class as part of the `My` namespace, you can add properties and methods that will be included with the `My.Application` or `My.Computer` objects.</span></span>

<span data-ttu-id="8edbf-122">下面的示例将名为 `DnsServerIPAddresses` 的属性添加到 `My.Computer` 对象：</span><span class="sxs-lookup"><span data-stu-id="8edbf-122">The following example adds a property named `DnsServerIPAddresses` to the `My.Computer` object:</span></span>

[!code-vb[VbVbcnExtendingMy#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class2.vb#2)]

## <a name="adding-custom-objects-to-the-my-namespace"></a><span data-ttu-id="8edbf-123">将自定义对象添加到 `My` 命名空间</span><span class="sxs-lookup"><span data-stu-id="8edbf-123">Adding custom objects to the `My` namespace</span></span>

<span data-ttu-id="8edbf-124">尽管 `My` 命名空间为许多常见编程任务提供了解决方案，但你可能会遇到 `My` 命名空间未解决的任务。</span><span class="sxs-lookup"><span data-stu-id="8edbf-124">Although the `My` namespace provides solutions for many common programming tasks, you may encounter tasks that the `My` namespace does not address.</span></span> <span data-ttu-id="8edbf-125">例如，你的应用程序可能会访问用户数据的自定义目录服务，或者你的应用程序可能会使用默认情况下未安装 Visual Basic 的程序集。</span><span class="sxs-lookup"><span data-stu-id="8edbf-125">For example, your application might access custom directory services for user data, or your application might use assemblies that are not installed by default with Visual Basic.</span></span> <span data-ttu-id="8edbf-126">您可以扩展 `My` 命名空间，以包含特定于您的环境的常见任务的自定义解决方案。</span><span class="sxs-lookup"><span data-stu-id="8edbf-126">You can extend the `My` namespace to include custom solutions to common tasks that are specific to your environment.</span></span> <span data-ttu-id="8edbf-127">可以轻松扩展 `My` 命名空间，以添加新成员以满足不断增长的应用程序需求。</span><span class="sxs-lookup"><span data-stu-id="8edbf-127">The `My` namespace can easily be extended to add new members to meet growing application needs.</span></span> <span data-ttu-id="8edbf-128">此外，还可以将 `My` 命名空间扩展部署到作为 Visual Basic 模板的其他开发人员。</span><span class="sxs-lookup"><span data-stu-id="8edbf-128">Additionally, you can deploy your `My` namespace extensions to other developers as a Visual Basic template.</span></span>
  
### <a name="adding-members-to-the-my-namespace"></a><span data-ttu-id="8edbf-129">将成员添加到 `My` 命名空间</span><span class="sxs-lookup"><span data-stu-id="8edbf-129">Adding members to the `My` namespace</span></span>

<span data-ttu-id="8edbf-130">由于 `My` 是像任何其他命名空间一样的命名空间，因此可以通过只添加模块并指定 `My` 的 `Namespace`，将顶级属性添加到该命名空间。</span><span class="sxs-lookup"><span data-stu-id="8edbf-130">Because `My` is a namespace like any other namespace, you can add top-level properties to it by just adding a module and specifying a `Namespace` of `My`.</span></span> <span data-ttu-id="8edbf-131">用 `HideModuleName` 特性批注模块，如下面的示例中所示。</span><span class="sxs-lookup"><span data-stu-id="8edbf-131">Annotate the module with the `HideModuleName` attribute as shown in the following example.</span></span> <span data-ttu-id="8edbf-132">@No__t_0 属性可确保 IntelliSense 在显示 `My` 命名空间的成员时不显示模块名称。</span><span class="sxs-lookup"><span data-stu-id="8edbf-132">The `HideModuleName` attribute ensures that IntelliSense will not display the module name when it displays the members of the `My` namespace.</span></span>

[!code-vb[VbVbcnExtendingMy#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#3)]

<span data-ttu-id="8edbf-133">若要将成员添加到 `My` 命名空间，请根据需要将属性添加到模块。</span><span class="sxs-lookup"><span data-stu-id="8edbf-133">To add members to the `My` namespace, add properties as needed to the module.</span></span> <span data-ttu-id="8edbf-134">对于添加到 `My` 命名空间的每个属性，添加类型为 `ThreadSafeObjectProvider(Of T)` 的私有字段，其中类型是自定义属性返回的类型。</span><span class="sxs-lookup"><span data-stu-id="8edbf-134">For each property added to the `My` namespace, add a private field of type `ThreadSafeObjectProvider(Of T)`, where the type is the type returned by your custom property.</span></span> <span data-ttu-id="8edbf-135">此字段用于创建由属性返回的线程安全对象实例，方法是调用 `GetInstance` 方法。</span><span class="sxs-lookup"><span data-stu-id="8edbf-135">This field is used to create thread-safe object instances to be returned by the property by calling the `GetInstance` method.</span></span> <span data-ttu-id="8edbf-136">因此，访问扩展属性的每个线程都接收其自己的返回类型的实例。</span><span class="sxs-lookup"><span data-stu-id="8edbf-136">As a result, each thread that is accessing the extended property receives its own instance of the returned type.</span></span> <span data-ttu-id="8edbf-137">下面的示例将名为 `SampleExtension` `SampleExtension` 的属性添加到 `My` 命名空间的类型：</span><span class="sxs-lookup"><span data-stu-id="8edbf-137">The following example adds a property named `SampleExtension` that is of type `SampleExtension` to the `My` namespace:</span></span>

[!code-vb[VbVbcnExtendingMy#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#4)]

## <a name="adding-events-to-custom-my-objects"></a><span data-ttu-id="8edbf-138">向自定义 `My` 对象添加事件</span><span class="sxs-lookup"><span data-stu-id="8edbf-138">Adding events to custom `My` objects</span></span>

<span data-ttu-id="8edbf-139">您可以使用 `My.Application` 对象通过在 `My` 命名空间中扩展 `MyApplication` 分部类来公开您的自定义 `My` 对象的事件。</span><span class="sxs-lookup"><span data-stu-id="8edbf-139">You can use the `My.Application` object to expose events for your custom `My` objects by extending the `MyApplication` partial class in the `My` namespace.</span></span> <span data-ttu-id="8edbf-140">对于基于 Windows 的项目，您可以在**解决方案资源管理器**中双击项目的 "**我的项目**" 节点。</span><span class="sxs-lookup"><span data-stu-id="8edbf-140">For Windows-based projects, you can double-click the **My Project** node in for your project in **Solution Explorer**.</span></span> <span data-ttu-id="8edbf-141">在 Visual Basic**项目设计器**中，单击 "**应用程序**" 选项卡，然后单击 "**查看应用程序事件**" 按钮。</span><span class="sxs-lookup"><span data-stu-id="8edbf-141">In the Visual Basic **Project Designer**, click the **Application** tab and then click the **View Application Events** button.</span></span> <span data-ttu-id="8edbf-142">将创建一个名为*applicationevents.vb*的新文件。</span><span class="sxs-lookup"><span data-stu-id="8edbf-142">A new file that is named *ApplicationEvents.vb* will be created.</span></span> <span data-ttu-id="8edbf-143">它包含以下用于扩展 `MyApplication` 类的代码：</span><span class="sxs-lookup"><span data-stu-id="8edbf-143">It contains the following code for extending the `MyApplication` class:</span></span>

[!code-vb[VbVbcnExtendingMy#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#5)]

<span data-ttu-id="8edbf-144">通过向 `MyApplication` 类添加自定义事件处理程序，可以为自定义 `My` 对象添加事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="8edbf-144">You can add event handlers for your custom `My` objects by adding custom event handlers to the `MyApplication` class.</span></span> <span data-ttu-id="8edbf-145">自定义事件使你可以添加将在添加、删除事件处理程序或引发事件时执行的代码。</span><span class="sxs-lookup"><span data-stu-id="8edbf-145">Custom events enable you to add code that will execute when an event handler is added, removed, or the event is raised.</span></span> <span data-ttu-id="8edbf-146">请注意，仅当用户添加代码以处理事件时，才会运行自定义事件的 `AddHandler` 代码。</span><span class="sxs-lookup"><span data-stu-id="8edbf-146">Note that the `AddHandler` code for a custom event runs only if code is added by a user to handle the event.</span></span> <span data-ttu-id="8edbf-147">例如，请考虑上一节中的 `SampleExtension` 对象具有要为其添加自定义事件处理程序的 `Load` 事件。</span><span class="sxs-lookup"><span data-stu-id="8edbf-147">For example, consider that the `SampleExtension` object from the previous section has a `Load` event that you want to add a custom event handler for.</span></span> <span data-ttu-id="8edbf-148">下面的代码示例演示一个名为 `SampleExtensionLoad` 的自定义事件处理程序，该处理程序在 `My.SampleExtension.Load` 事件发生时调用。</span><span class="sxs-lookup"><span data-stu-id="8edbf-148">The following code example shows a custom event handler named `SampleExtensionLoad` that will be invoked when the `My.SampleExtension.Load` event occurs.</span></span> <span data-ttu-id="8edbf-149">添加代码以处理新的 `My.SampleExtensionLoad` 事件时，将执行此自定义事件代码的 `AddHandler` 部分。</span><span class="sxs-lookup"><span data-stu-id="8edbf-149">When code is added to handle the new `My.SampleExtensionLoad` event, the `AddHandler` part of this custom event code is executed.</span></span> <span data-ttu-id="8edbf-150">代码示例中包含 `MyApplication_SampleExtensionLoad` 方法，以显示处理 `My.SampleExtensionLoad` 事件的事件处理程序的示例。</span><span class="sxs-lookup"><span data-stu-id="8edbf-150">The `MyApplication_SampleExtensionLoad` method is included in the code example to show an example of an event handler that handles the `My.SampleExtensionLoad` event.</span></span> <span data-ttu-id="8edbf-151">请注意，在编辑*applicationevents.vb*文件时，如果在代码编辑器上方的左侧下拉列表中选择 "**我的应用程序事件**" 选项，则 `SampleExtensionLoad` 事件将可用。</span><span class="sxs-lookup"><span data-stu-id="8edbf-151">Note that the `SampleExtensionLoad` event will be available when you select the **My Application Events** option in the left drop-down list above the Code Editor when you are editing the *ApplicationEvents.vb* file.</span></span>

[!code-vb[VbVbcnExtendingMy#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#6)]

## <a name="design-guidelines"></a><span data-ttu-id="8edbf-152">设计准则</span><span class="sxs-lookup"><span data-stu-id="8edbf-152">Design guidelines</span></span>

<span data-ttu-id="8edbf-153">开发 `My` 命名空间的扩展时，请使用以下准则来帮助最大程度地减少扩展组件的维护成本：</span><span class="sxs-lookup"><span data-stu-id="8edbf-153">When you develop extensions to the `My` namespace, use the following guidelines to help minimize the maintenance costs of your extension components:</span></span>

- <span data-ttu-id="8edbf-154">**仅包含扩展逻辑。**</span><span class="sxs-lookup"><span data-stu-id="8edbf-154">**Include only the extension logic.**</span></span> <span data-ttu-id="8edbf-155">@No__t_0 命名空间扩展中包含的逻辑只应包含在 `My` 命名空间中公开所需功能所需的代码。</span><span class="sxs-lookup"><span data-stu-id="8edbf-155">The logic included in the `My` namespace extension should include only the code that is needed to expose the required functionality in the `My` namespace.</span></span> <span data-ttu-id="8edbf-156">由于你的扩展将作为源代码驻留在用户项目中，因此更新扩展组件会产生较高的维护成本，应尽可能避免使用。</span><span class="sxs-lookup"><span data-stu-id="8edbf-156">Because your extension will reside in user projects as source code, updating the extension component incurs a high maintenance cost and should be avoided if possible.</span></span>
- <span data-ttu-id="8edbf-157">**最小化项目假设。**</span><span class="sxs-lookup"><span data-stu-id="8edbf-157">**Minimize project assumptions.**</span></span> <span data-ttu-id="8edbf-158">当你创建 `My` 命名空间的扩展时，请不要采用一组引用、项目级别导入或特定编译器设置（例如，`Option Strict` off）。</span><span class="sxs-lookup"><span data-stu-id="8edbf-158">When you create your extensions of the `My` namespace, do not assume a set of references, project-level imports, or specific compiler settings (for example, `Option Strict` off).</span></span> <span data-ttu-id="8edbf-159">相反，请使用 `Global` 关键字来最大程度地降低依赖关系，并完全限定所有类型引用。</span><span class="sxs-lookup"><span data-stu-id="8edbf-159">Instead, minimize dependencies and fully qualify all type references by using the `Global` keyword.</span></span> <span data-ttu-id="8edbf-160">此外，请确保该扩展与 `Option Strict` 一起编译，以最大程度地减少扩展中的错误。</span><span class="sxs-lookup"><span data-stu-id="8edbf-160">Also, ensure that the extension compiles with `Option Strict` on to minimize errors in the extension.</span></span>
- <span data-ttu-id="8edbf-161">**隔离扩展代码。**</span><span class="sxs-lookup"><span data-stu-id="8edbf-161">**Isolate the extension code.**</span></span> <span data-ttu-id="8edbf-162">将代码放在一个单独的文件中，可以轻松地将扩展部署为 Visual Studio 项模板。</span><span class="sxs-lookup"><span data-stu-id="8edbf-162">Placing the code in a single file makes your extension easily deployable as a Visual Studio item template.</span></span> <span data-ttu-id="8edbf-163">有关详细信息，请参阅本主题后面的 "打包和部署扩展"。</span><span class="sxs-lookup"><span data-stu-id="8edbf-163">For more information, see "Packaging and Deploying Extensions" later in this topic.</span></span> <span data-ttu-id="8edbf-164">将所有 `My` 命名空间扩展代码置于项目中的单个文件或单独的文件夹中时，还将帮助用户找到 `My` 命名空间扩展。</span><span class="sxs-lookup"><span data-stu-id="8edbf-164">Placing all the `My` namespace extension code in a single file or a separate folder in a project will also help users locate the `My` namespace extension.</span></span>

## <a name="designing-class-libraries-for-my"></a><span data-ttu-id="8edbf-165">为 `My` 设计类库</span><span class="sxs-lookup"><span data-stu-id="8edbf-165">Designing class libraries for `My`</span></span>

<span data-ttu-id="8edbf-166">与大多数对象模型一样，某些设计模式适用于 `My` 命名空间，而其他设计模式则不适用。</span><span class="sxs-lookup"><span data-stu-id="8edbf-166">As is the case with most object models, some design patterns work well in the `My` namespace and others do not.</span></span> <span data-ttu-id="8edbf-167">设计 `My` 命名空间的扩展时，请考虑以下原则：</span><span class="sxs-lookup"><span data-stu-id="8edbf-167">When designing an extension to the `My` namespace, consider the following principles:</span></span>

- <span data-ttu-id="8edbf-168">**无状态方法。**</span><span class="sxs-lookup"><span data-stu-id="8edbf-168">**Stateless methods.**</span></span> <span data-ttu-id="8edbf-169">@No__t_0 命名空间中的方法应为特定的任务提供完整的解决方案。</span><span class="sxs-lookup"><span data-stu-id="8edbf-169">Methods in the `My` namespace should provide a complete solution to a specific task.</span></span> <span data-ttu-id="8edbf-170">确保传递给方法的参数值提供完成特定任务所需的所有输入。</span><span class="sxs-lookup"><span data-stu-id="8edbf-170">Ensure that the parameter values that are passed to the method provide all the input required to complete the particular task.</span></span> <span data-ttu-id="8edbf-171">避免创建依赖于先前状态的方法，例如打开与资源的连接。</span><span class="sxs-lookup"><span data-stu-id="8edbf-171">Avoid creating methods that rely on prior state, such as open connections to resources.</span></span>
- <span data-ttu-id="8edbf-172">**全局实例。**</span><span class="sxs-lookup"><span data-stu-id="8edbf-172">**Global instances.**</span></span> <span data-ttu-id="8edbf-173">@No__t_0 命名空间中维护的唯一状态是项目的全局状态。</span><span class="sxs-lookup"><span data-stu-id="8edbf-173">The only state that is maintained in the `My` namespace is global to the project.</span></span> <span data-ttu-id="8edbf-174">例如，`My.Application.Info` 封装在整个应用程序中共享的状态。</span><span class="sxs-lookup"><span data-stu-id="8edbf-174">For example, `My.Application.Info` encapsulates state that is shared throughout the application.</span></span>
- <span data-ttu-id="8edbf-175">**简单参数类型。**</span><span class="sxs-lookup"><span data-stu-id="8edbf-175">**Simple parameter types.**</span></span> <span data-ttu-id="8edbf-176">避免使用复杂的参数类型，使其保持简单。</span><span class="sxs-lookup"><span data-stu-id="8edbf-176">Keep things simple by avoiding complex parameter types.</span></span> <span data-ttu-id="8edbf-177">而是创建不采用参数输入或采用简单输入类型（如字符串、基元类型等）的方法。</span><span class="sxs-lookup"><span data-stu-id="8edbf-177">Instead, create methods that either take no parameter input or that take simple input types such as strings, primitive types, and so on.</span></span>
- <span data-ttu-id="8edbf-178">**工厂方法。**</span><span class="sxs-lookup"><span data-stu-id="8edbf-178">**Factory methods.**</span></span> <span data-ttu-id="8edbf-179">某些类型一定要实例化。</span><span class="sxs-lookup"><span data-stu-id="8edbf-179">Some types are necessarily difficult to instantiate.</span></span> <span data-ttu-id="8edbf-180">提供工厂方法作为 `My` 命名空间的扩展，使你能够更轻松地发现和使用属于此类别的类型。</span><span class="sxs-lookup"><span data-stu-id="8edbf-180">Providing factory methods as extensions to the `My` namespace enables you to more easily discover and consume types that fall into this category.</span></span> <span data-ttu-id="8edbf-181">@No__t_0 的工厂方法的示例。</span><span class="sxs-lookup"><span data-stu-id="8edbf-181">An example of a factory method that works well is `My.Computer.FileSystem.OpenTextFileReader`.</span></span> <span data-ttu-id="8edbf-182">.NET Framework 中有几种可用的流类型。</span><span class="sxs-lookup"><span data-stu-id="8edbf-182">There are several stream types available in the .NET Framework.</span></span> <span data-ttu-id="8edbf-183">通过具体指定文本文件，`OpenTextFileReader` 可帮助用户了解要使用的流。</span><span class="sxs-lookup"><span data-stu-id="8edbf-183">By specifying text files specifically, the `OpenTextFileReader` helps the user understand which stream to use.</span></span>

<span data-ttu-id="8edbf-184">这些准则不排除类库的一般设计原则。</span><span class="sxs-lookup"><span data-stu-id="8edbf-184">These guidelines do not preclude general design principles for class libraries.</span></span> <span data-ttu-id="8edbf-185">相反，它们是针对使用 Visual Basic 和 `My` 命名空间的开发人员进行了优化的建议。</span><span class="sxs-lookup"><span data-stu-id="8edbf-185">Rather, they are recommendations that are optimized for developers who are using Visual Basic and the `My` namespace.</span></span> <span data-ttu-id="8edbf-186">有关创建类库的一般设计原则，请参阅[框架设计准则](../../../standard/design-guidelines/index.md)。</span><span class="sxs-lookup"><span data-stu-id="8edbf-186">For general design principles for creating class libraries, see [Framework Design Guidelines](../../../standard/design-guidelines/index.md).</span></span>

## <a name="packaging-and-deploying-extensions"></a><span data-ttu-id="8edbf-187">打包和部署扩展</span><span class="sxs-lookup"><span data-stu-id="8edbf-187">Packaging and deploying extensions</span></span>

<span data-ttu-id="8edbf-188">你可以在 Visual Studio 项目模板中包含 `My` 命名空间扩展，也可以打包扩展并将其部署为 Visual Studio 项模板。</span><span class="sxs-lookup"><span data-stu-id="8edbf-188">You can include `My` namespace extensions in a Visual Studio project template, or you can package your extensions and deploy them as a Visual Studio item template.</span></span> <span data-ttu-id="8edbf-189">将 `My` 命名空间扩展打包为 Visual Studio 项模板时，可以利用 Visual Basic 提供的其他功能。</span><span class="sxs-lookup"><span data-stu-id="8edbf-189">When you package your `My` namespace extensions as a Visual Studio item template, you can take advantage of additional capabilities provided by Visual Basic.</span></span> <span data-ttu-id="8edbf-190">通过这些功能，您可以在项目引用特定程序集时包含扩展，或使用户能够通过使用 Visual Basic 项目设计器的 "**我的扩展**" 页显式添加您的 `My` 命名空间扩展。</span><span class="sxs-lookup"><span data-stu-id="8edbf-190">These capabilities enable you to include an extension when a project references a particular assembly, or enable users to explicitly add your `My` namespace extension by using the **My Extensions** page of the Visual Basic Project Designer.</span></span>

<span data-ttu-id="8edbf-191">有关如何部署 `My` 命名空间扩展的详细信息，请参阅[打包和部署自定义 My 扩展](packaging-and-deploying-custom-my-extensions.md)。</span><span class="sxs-lookup"><span data-stu-id="8edbf-191">For details about how to deploy `My` namespace extensions, see [Packaging and Deploying Custom My Extensions](packaging-and-deploying-custom-my-extensions.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="8edbf-192">请参阅</span><span class="sxs-lookup"><span data-stu-id="8edbf-192">See also</span></span>

- [<span data-ttu-id="8edbf-193">打包和部署自定义 My 扩展</span><span class="sxs-lookup"><span data-stu-id="8edbf-193">Packaging and Deploying Custom My Extensions</span></span>](packaging-and-deploying-custom-my-extensions.md)
- [<span data-ttu-id="8edbf-194">扩展 Visual Basic 应用程序模型</span><span class="sxs-lookup"><span data-stu-id="8edbf-194">Extending the Visual Basic Application Model</span></span>](extending-the-visual-basic-application-model.md)
- [<span data-ttu-id="8edbf-195">自定义 My 中可用的对象</span><span class="sxs-lookup"><span data-stu-id="8edbf-195">Customizing Which Objects are Available in My</span></span>](customizing-which-objects-are-available-in-my.md)
- [<span data-ttu-id="8edbf-196">“项目设计器”->“My 扩展”页</span><span class="sxs-lookup"><span data-stu-id="8edbf-196">My Extensions Page, Project Designer</span></span>](/visualstudio/ide/reference/my-extensions-page-project-designer-visual-basic)
- [<span data-ttu-id="8edbf-197">“项目设计器”->“应用程序”页 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="8edbf-197">Application Page, Project Designer (Visual Basic)</span></span>](/visualstudio/ide/reference/application-page-project-designer-visual-basic)
- [<span data-ttu-id="8edbf-198">Partial</span><span class="sxs-lookup"><span data-stu-id="8edbf-198">Partial</span></span>](../../language-reference/modifiers/partial.md)
