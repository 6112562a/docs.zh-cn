---
title: 匿名类型 (Visual Basic)
ms.date: 07/20/2015
f1_keywords:
- vb.AnonymousType
helpviewer_keywords:
- anonymous types [Visual Basic], about anonymous types
- anonymous types [Visual Basic]
- types [Visual Basic], anonymous
ms.assetid: 7b87532c-4b3e-4398-8503-6ea9d67574a4
ms.openlocfilehash: 5ff3b12e85b9ab7fb8341bb8665a057165e78816
ms.sourcegitcommit: 40364ded04fa6cdcb2b6beca7f68412e2e12f633
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/28/2019
ms.locfileid: "56968010"
---
# <a name="anonymous-types-visual-basic"></a><span data-ttu-id="e1327-102">匿名类型 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="e1327-102">Anonymous Types (Visual Basic)</span></span>
<span data-ttu-id="e1327-103">Visual Basic 支持匿名类型，以便你能够而无需编写的数据类型的类定义创建对象。</span><span class="sxs-lookup"><span data-stu-id="e1327-103">Visual Basic supports anonymous types, which enable you to create objects without writing a class definition for the data type.</span></span> <span data-ttu-id="e1327-104">此时，编译器将为你生成类。</span><span class="sxs-lookup"><span data-stu-id="e1327-104">Instead, the compiler generates a class for you.</span></span> <span data-ttu-id="e1327-105">类已没有可用的名称，直接继承自<xref:System.Object>，且包含在声明该对象指定的属性。</span><span class="sxs-lookup"><span data-stu-id="e1327-105">The class has no usable name, inherits directly from <xref:System.Object>, and contains the properties you specify in declaring the object.</span></span> <span data-ttu-id="e1327-106">由于未指定数据类型的名称，因此将它称为*匿名类型*。</span><span class="sxs-lookup"><span data-stu-id="e1327-106">Because the name of the data type is not specified, it is referred to as an *anonymous type*.</span></span>  
  
 <span data-ttu-id="e1327-107">以下示例声明并创建变量`product`视为具有两个属性的匿名类型的实例`Name`和`Price`。</span><span class="sxs-lookup"><span data-stu-id="e1327-107">The following example declares and creates variable `product` as an instance of an anonymous type that has two properties, `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#1)]  
  
 <span data-ttu-id="e1327-108">一个*查询表达式*使用匿名类型将合并的查询所选择的数据列。</span><span class="sxs-lookup"><span data-stu-id="e1327-108">A *query expression* uses anonymous types to combine columns of data selected by a query.</span></span> <span data-ttu-id="e1327-109">因为无法预测的特定查询可能选择的列，不能提前，定义结果的类型。</span><span class="sxs-lookup"><span data-stu-id="e1327-109">You cannot define the type of the result in advance, because you cannot predict the columns a particular query might select.</span></span> <span data-ttu-id="e1327-110">匿名类型，可以编写选择任意数量的列，按任意顺序的查询。</span><span class="sxs-lookup"><span data-stu-id="e1327-110">Anonymous types enable you to write a query that selects any number of columns, in any order.</span></span> <span data-ttu-id="e1327-111">编译器创建的数据类型与指定的属性和指定的顺序匹配。</span><span class="sxs-lookup"><span data-stu-id="e1327-111">The compiler creates a data type that matches the specified properties and the specified order.</span></span>  
  
 <span data-ttu-id="e1327-112">在以下示例中，`products`是一系列产品对象，其中每个有许多属性。</span><span class="sxs-lookup"><span data-stu-id="e1327-112">In the following examples, `products` is a list of product objects, each of which has many properties.</span></span> <span data-ttu-id="e1327-113">变量`namePriceQuery`保存的查询在执行时返回的实例具有两个属性的匿名类型集合的定义`Name`和`Price`。</span><span class="sxs-lookup"><span data-stu-id="e1327-113">Variable `namePriceQuery` holds the definition of a query that, when it is executed, returns a collection of instances of an anonymous type that has two properties, `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#2)]  
  
 <span data-ttu-id="e1327-114">变量`nameQuantityQuery`保存的查询在执行时返回的实例具有两个属性的匿名类型集合的定义`Name`和`OnHand`。</span><span class="sxs-lookup"><span data-stu-id="e1327-114">Variable `nameQuantityQuery` holds the definition of a query that, when it is executed, returns a collection of instances of an anonymous type that has two properties, `Name` and `OnHand`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#3)]  
  
 <span data-ttu-id="e1327-115">有关创建由编译器为匿名类型的代码的详细信息，请参阅[匿名类型定义](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md)。</span><span class="sxs-lookup"><span data-stu-id="e1327-115">For more information about the code created by the compiler for an anonymous type, see [Anonymous Type Definition](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md).</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="e1327-116">匿名类型的名称是编译器生成和编译的而有所不同。</span><span class="sxs-lookup"><span data-stu-id="e1327-116">The name of the anonymous type is compiler generated and may vary from compilation to compilation.</span></span> <span data-ttu-id="e1327-117">你的代码不应使用或依赖的匿名类型的名称，因为重新编译项目时，可能会更改名称。</span><span class="sxs-lookup"><span data-stu-id="e1327-117">Your code should not use or rely on the name of an anonymous type because the name might change when a project is recompiled.</span></span>  
  
## <a name="declaring-an-anonymous-type"></a><span data-ttu-id="e1327-118">声明匿名类型</span><span class="sxs-lookup"><span data-stu-id="e1327-118">Declaring an Anonymous Type</span></span>  
 <span data-ttu-id="e1327-119">匿名类型的实例的声明使用初始值设定项列表来指定类型的属性。</span><span class="sxs-lookup"><span data-stu-id="e1327-119">The declaration of an instance of an anonymous type uses an initializer list to specify the properties of the type.</span></span> <span data-ttu-id="e1327-120">当你声明匿名类型、 不其他类元素，如方法或事件时，可以指定仅属性。</span><span class="sxs-lookup"><span data-stu-id="e1327-120">You can specify only properties when you declare an anonymous type, not other class elements such as methods or events.</span></span> <span data-ttu-id="e1327-121">在以下示例中，`product1`是具有两个属性的匿名类型的实例：`Name`和`Price`。</span><span class="sxs-lookup"><span data-stu-id="e1327-121">In the following example, `product1` is an instance of an anonymous type that has two properties: `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#4)]  
  
 <span data-ttu-id="e1327-122">如果将属性指定为键属性，可以使用它们来比较两个匿名类型实例相等。</span><span class="sxs-lookup"><span data-stu-id="e1327-122">If you designate properties as key properties, you can use them to compare two anonymous type instances for equality.</span></span> <span data-ttu-id="e1327-123">但是，不能更改键属性的值。</span><span class="sxs-lookup"><span data-stu-id="e1327-123">However, the values of key properties cannot be changed.</span></span> <span data-ttu-id="e1327-124">请参阅后面本主题的详细信息的键属性部分。</span><span class="sxs-lookup"><span data-stu-id="e1327-124">See the Key Properties section later in this topic for more information.</span></span>  
  
 <span data-ttu-id="e1327-125">请注意，声明匿名类型的实例是类似于通过使用对象初始值设定项声明命名类型的实例：</span><span class="sxs-lookup"><span data-stu-id="e1327-125">Notice that declaring an instance of an anonymous type is like declaring an instance of a named type by using an object initializer:</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#5)]  
  
 <span data-ttu-id="e1327-126">有关指定匿名类型属性的其他方法的详细信息，请参阅[如何：推断属性名和匿名类型声明中的类型](../../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md)。</span><span class="sxs-lookup"><span data-stu-id="e1327-126">For more information about other ways to specify anonymous type properties, see [How to: Infer Property Names and Types in Anonymous Type Declarations](../../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md).</span></span>  
  
## <a name="key-properties"></a><span data-ttu-id="e1327-127">键属性</span><span class="sxs-lookup"><span data-stu-id="e1327-127">Key Properties</span></span>  
 <span data-ttu-id="e1327-128">键属性不同于非键属性多个重要方面：</span><span class="sxs-lookup"><span data-stu-id="e1327-128">Key properties differ from non-key properties in several fundamental ways:</span></span>  
  
-   <span data-ttu-id="e1327-129">只有键属性的值进行比较以确定两个实例是否相等。</span><span class="sxs-lookup"><span data-stu-id="e1327-129">Only the values of key properties are compared in order to determine whether two instances are equal.</span></span>  
  
-   <span data-ttu-id="e1327-130">键属性的值是只读的并且不能更改。</span><span class="sxs-lookup"><span data-stu-id="e1327-130">The values of key properties are read-only and cannot be changed.</span></span>  
  
-   <span data-ttu-id="e1327-131">仅匿名类型的编译器生成的哈希代码算法中包括键属性值。</span><span class="sxs-lookup"><span data-stu-id="e1327-131">Only key property values are included in the compiler-generated hash code algorithm for an anonymous type.</span></span>  
  
### <a name="equality"></a><span data-ttu-id="e1327-132">相等</span><span class="sxs-lookup"><span data-stu-id="e1327-132">Equality</span></span>  
 <span data-ttu-id="e1327-133">匿名类型的实例可以是同一匿名类型的实例才相等。</span><span class="sxs-lookup"><span data-stu-id="e1327-133">Instances of anonymous types can be equal only if they are instances of the same anonymous type.</span></span> <span data-ttu-id="e1327-134">编译器将两个实例视为相同类型的实例，如果满足以下条件：</span><span class="sxs-lookup"><span data-stu-id="e1327-134">The compiler treats two instances as instances of the same type if they meet the following conditions:</span></span>  
  
-   <span data-ttu-id="e1327-135">在同一程序集中声明它们。</span><span class="sxs-lookup"><span data-stu-id="e1327-135">They are declared in the same assembly.</span></span>  
  
-   <span data-ttu-id="e1327-136">它们的属性具有相同的名称相同的推断类型和声明顺序相同。</span><span class="sxs-lookup"><span data-stu-id="e1327-136">Their properties have the same names, the same inferred types, and are declared in the same order.</span></span> <span data-ttu-id="e1327-137">名称比较不区分大小写。</span><span class="sxs-lookup"><span data-stu-id="e1327-137">Name comparisons are not case-sensitive.</span></span>  
  
-   <span data-ttu-id="e1327-138">在每个相同的属性都标记为键属性。</span><span class="sxs-lookup"><span data-stu-id="e1327-138">The same properties in each are marked as key properties.</span></span>  
  
-   <span data-ttu-id="e1327-139">每个声明中的至少一个属性是键属性。</span><span class="sxs-lookup"><span data-stu-id="e1327-139">At least one property in each declaration is a key property.</span></span>  
  
 <span data-ttu-id="e1327-140">具有任何键属性的匿名类型的实例是只等于其自身。</span><span class="sxs-lookup"><span data-stu-id="e1327-140">An instance of an anonymous types that has no key properties is equal only to itself.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#6)]  
  
 <span data-ttu-id="e1327-141">如果其键属性的值相等，则同一匿名类型的两个实例相等。</span><span class="sxs-lookup"><span data-stu-id="e1327-141">Two instances of the same anonymous type are equal if the values of their key properties are equal.</span></span> <span data-ttu-id="e1327-142">以下示例说明了如何测试相等。</span><span class="sxs-lookup"><span data-stu-id="e1327-142">The following examples illustrate how equality is tested.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#7)]  
  
### <a name="read-only-values"></a><span data-ttu-id="e1327-143">只读的值</span><span class="sxs-lookup"><span data-stu-id="e1327-143">Read-Only Values</span></span>  
 <span data-ttu-id="e1327-144">不能更改键属性的值。</span><span class="sxs-lookup"><span data-stu-id="e1327-144">The values of key properties cannot be changed.</span></span> <span data-ttu-id="e1327-145">例如，在`prod8`在上一示例中，`Name`并`Price`字段`read-only`，但`OnHand`可以更改。</span><span class="sxs-lookup"><span data-stu-id="e1327-145">For example, in `prod8` in the previous example, the `Name` and `Price` fields are `read-only`, but `OnHand` can be changed.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#8](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_8.vb)]  
  
## <a name="anonymous-types-from-query-expressions"></a><span data-ttu-id="e1327-146">查询表达式中的匿名类型</span><span class="sxs-lookup"><span data-stu-id="e1327-146">Anonymous Types from Query Expressions</span></span>  
 <span data-ttu-id="e1327-147">查询表达式始终不需要创建匿名类型。</span><span class="sxs-lookup"><span data-stu-id="e1327-147">Query expressions do not always require the creation of anonymous types.</span></span> <span data-ttu-id="e1327-148">如果可能，它们使用现有类型以保存列数据。</span><span class="sxs-lookup"><span data-stu-id="e1327-148">When possible, they use an existing type to hold the column data.</span></span> <span data-ttu-id="e1327-149">查询从数据源或每条记录中的只有一个字段返回任一整条记录时，将发生这种情况。</span><span class="sxs-lookup"><span data-stu-id="e1327-149">This occurs when the query returns either whole records from the data source, or only one field from each record.</span></span> <span data-ttu-id="e1327-150">在下面的代码示例中，`customers`是一系列的对象`Customer`类。</span><span class="sxs-lookup"><span data-stu-id="e1327-150">In the following code examples, `customers` is a collection of objects of a `Customer` class.</span></span> <span data-ttu-id="e1327-151">类具有许多属性，并可在查询结果中，按任意顺序包含一个或多个。</span><span class="sxs-lookup"><span data-stu-id="e1327-151">The class has many properties, and you can include one or more of them in the query result, in any order.</span></span> <span data-ttu-id="e1327-152">在前两个示例中，任何匿名类型不是必需，因为查询中选择的命名类型的元素：</span><span class="sxs-lookup"><span data-stu-id="e1327-152">In the first two examples, no anonymous types are required because the queries select elements of named types:</span></span>  
  
-   <span data-ttu-id="e1327-153">`custs1` 包含一系列字符串，因为`cust.Name`是一个字符串。</span><span class="sxs-lookup"><span data-stu-id="e1327-153">`custs1` contains a collection of strings, because `cust.Name` is a string.</span></span>  
  
     [!code-vb[VbVbalrAnonymousTypes#30](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#30)]  
  
-   <span data-ttu-id="e1327-154">`custs2` 包含一系列`Customer`对象，因为每个元素的`customers`是`Customer`查询选择对象，并且整个元素。</span><span class="sxs-lookup"><span data-stu-id="e1327-154">`custs2` contains a collection of `Customer` objects, because each element of `customers` is a `Customer` object, and the whole element is selected by the query.</span></span>  
  
     [!code-vb[VbVbalrAnonymousTypes#31](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#31)]  
  
 <span data-ttu-id="e1327-155">但是，相应的命名的类型并非始终可用。</span><span class="sxs-lookup"><span data-stu-id="e1327-155">However, appropriate named types are not always available.</span></span> <span data-ttu-id="e1327-156">您可能想要选择客户名称和地址的一种用途、 客户 ID 号和位置，以及客户名称、 地址和订单历史记录中的第三个。</span><span class="sxs-lookup"><span data-stu-id="e1327-156">You might want to select customer names and addresses for one purpose, customer ID numbers and locations for another, and customer names, addresses, and order histories for a third.</span></span> <span data-ttu-id="e1327-157">匿名类型，可选择任意组合的属性，按任意顺序，而无需第一个声明新的命名的类型以保存结果。</span><span class="sxs-lookup"><span data-stu-id="e1327-157">Anonymous types enable you to select any combination of properties, in any order, without first declaring a new named type to hold the result.</span></span> <span data-ttu-id="e1327-158">相反，编译器会创建每个编译属性的匿名类型。</span><span class="sxs-lookup"><span data-stu-id="e1327-158">Instead, the compiler creates an anonymous type for each compilation of properties.</span></span> <span data-ttu-id="e1327-159">以下查询从每个选择仅客户的姓名和 ID 号`Customer`对象中`customers`。</span><span class="sxs-lookup"><span data-stu-id="e1327-159">The following query selects only the customer's name and ID number from each `Customer` object in `customers`.</span></span> <span data-ttu-id="e1327-160">因此，编译器会创建包含仅这两个属性的匿名类型。</span><span class="sxs-lookup"><span data-stu-id="e1327-160">Therefore, the compiler creates an anonymous type that contains only those two properties.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTYpes#32](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#32)]  
  
 <span data-ttu-id="e1327-161">名称和匿名类型中的属性的数据类型执行的参数从`Select`，`cust.Name`和`cust.ID`。</span><span class="sxs-lookup"><span data-stu-id="e1327-161">Both the names and the data types of the properties in the anonymous type are taken from the arguments to `Select`, `cust.Name` and `cust.ID`.</span></span> <span data-ttu-id="e1327-162">由查询创建的匿名类型中的属性始终是键属性。</span><span class="sxs-lookup"><span data-stu-id="e1327-162">The properties in an anonymous type that is created by a query are always key properties.</span></span> <span data-ttu-id="e1327-163">当`custs3`在下面的示例执行`For Each`循环中，结果是具有两个键属性的匿名类型的实例的集合`Name`和`ID`。</span><span class="sxs-lookup"><span data-stu-id="e1327-163">When `custs3` is executed in the following `For Each` loop, the result is a collection of instances of an anonymous type with two key properties, `Name` and `ID`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#33](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#33)]  
  
 <span data-ttu-id="e1327-164">表示的集合中的元素`custs3`强类型，以及您可以使用 IntelliSense 来浏览可用的属性和以验证它们的类型。</span><span class="sxs-lookup"><span data-stu-id="e1327-164">The elements in the collection represented by `custs3` are strongly typed, and you can use IntelliSense to navigate through the available properties and to verify their types.</span></span>  
  
 <span data-ttu-id="e1327-165">有关详细信息，请参阅[Visual Basic 中的 LINQ 简介](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)。</span><span class="sxs-lookup"><span data-stu-id="e1327-165">For more information, see [Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md).</span></span>  
  
## <a name="deciding-whether-to-use-anonymous-types"></a><span data-ttu-id="e1327-166">确定是否使用匿名类型</span><span class="sxs-lookup"><span data-stu-id="e1327-166">Deciding Whether to Use Anonymous Types</span></span>  
 <span data-ttu-id="e1327-167">作为匿名类的实例创建对象之前，请考虑这是否是最佳选择。</span><span class="sxs-lookup"><span data-stu-id="e1327-167">Before you create an object as an instance of an anonymous class, consider whether that is the best option.</span></span> <span data-ttu-id="e1327-168">例如，如果你想要创建临时对象，以包含相关的数据，并且具有无需其他字段和完整的类可能包含的方法，匿名类型是一个不错的解决方案。</span><span class="sxs-lookup"><span data-stu-id="e1327-168">For example, if you want to create a temporary object to contain related data, and you have no need for other fields and methods that a complete class might contain, an anonymous type is a good solution.</span></span> <span data-ttu-id="e1327-169">如果你想选择不同的属性对于每个声明，或如果你想要更改属性的顺序，匿名类型是还方便。</span><span class="sxs-lookup"><span data-stu-id="e1327-169">Anonymous types are also convenient if you want a different selection of properties for each declaration, or if you want to change the order of the properties.</span></span> <span data-ttu-id="e1327-170">但是，如果你的项目包含几个对象有相同的属性，按固定顺序，您可以声明它们更轻松地通过类构造函数中使用命名的类型。</span><span class="sxs-lookup"><span data-stu-id="e1327-170">However, if your project includes several objects that have the same properties, in a fixed order, you can declare them more easily by using a named type with a class constructor.</span></span> <span data-ttu-id="e1327-171">例如，与相应的构造函数，它是更轻松地声明的多个实例`Product`类不是它是声明匿名类型的多个实例。</span><span class="sxs-lookup"><span data-stu-id="e1327-171">For example, with an appropriate constructor, it is easier to declare several instances of a `Product` class than it is to declare several instances of an anonymous type.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#9](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#9)]  
  
 <span data-ttu-id="e1327-172">命名类型的另一个优点是编译器可以捕获属性名称的无意拼写错误。</span><span class="sxs-lookup"><span data-stu-id="e1327-172">Another advantage of named types is that the compiler can catch an accidental mistyping of a property name.</span></span> <span data-ttu-id="e1327-173">在上一示例中， `firstProd2`， `secondProd2`，和`thirdProd2`都应是相同的匿名类型的实例。</span><span class="sxs-lookup"><span data-stu-id="e1327-173">In the previous examples, `firstProd2`, `secondProd2`, and `thirdProd2` are intended to be instances of the same anonymous type.</span></span> <span data-ttu-id="e1327-174">但是，如果您意外声明`thirdProd2`通过以下方式之一，其类型应为不同于`firstProd2`和`secondProd2`。</span><span class="sxs-lookup"><span data-stu-id="e1327-174">However, if you were to accidentally declare `thirdProd2` in one of the following ways, its type would be different from that of `firstProd2` and `secondProd2`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#10](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#10)]  
  
 <span data-ttu-id="e1327-175">更重要的是，有的不适用于已命名类型的实例的匿名类型的使用限制。</span><span class="sxs-lookup"><span data-stu-id="e1327-175">More importantly, there are limitations on the use of anonymous types that do not apply to instances of named types.</span></span> <span data-ttu-id="e1327-176">`firstProd2``secondProd2`，和`thirdProd2`是相同的匿名类型的实例。</span><span class="sxs-lookup"><span data-stu-id="e1327-176">`firstProd2`, `secondProd2`, and `thirdProd2` are instances of the same anonymous type.</span></span> <span data-ttu-id="e1327-177">但是，共享的匿名类型的名称不可用，并且不能出现在代码中预期的类型名称的。</span><span class="sxs-lookup"><span data-stu-id="e1327-177">However, the name for the shared anonymous type is not available and cannot appear where a type name is expected in your code.</span></span> <span data-ttu-id="e1327-178">例如，匿名类型不能用于定义方法签名，若要声明另一个变量或字段，或任何类型声明中。</span><span class="sxs-lookup"><span data-stu-id="e1327-178">For example, an anonymous type cannot be used to define a method signature, to declare another variable or field, or in any type declaration.</span></span> <span data-ttu-id="e1327-179">因此，如果您不得不在方法之间共享的信息匿名类型不适合。</span><span class="sxs-lookup"><span data-stu-id="e1327-179">As a result, anonymous types are not appropriate when you have to share information across methods.</span></span>  
  
## <a name="an-anonymous-type-definition"></a><span data-ttu-id="e1327-180">匿名类型定义</span><span class="sxs-lookup"><span data-stu-id="e1327-180">An Anonymous Type Definition</span></span>  
 <span data-ttu-id="e1327-181">在响应的匿名类型的实例声明时，编译器会创建包含指定的属性的新类定义。</span><span class="sxs-lookup"><span data-stu-id="e1327-181">In response to the declaration of an instance of an anonymous type, the compiler creates a new class definition that contains the specified properties.</span></span>  
  
 <span data-ttu-id="e1327-182">如果匿名类型包含至少一个键属性，定义将重写继承的三个成员<xref:System.Object>: <xref:System.Object.Equals%2A>， <xref:System.Object.GetHashCode%2A>，和<xref:System.Object.ToString%2A>。</span><span class="sxs-lookup"><span data-stu-id="e1327-182">If the anonymous type contains at least one key property, the definition overrides three members inherited from <xref:System.Object>: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, and <xref:System.Object.ToString%2A>.</span></span> <span data-ttu-id="e1327-183">代码生成测试相等性，并确定哈希代码值将视为仅的键属性。</span><span class="sxs-lookup"><span data-stu-id="e1327-183">The code produced for testing equality and determining the hash code value considers only the key properties.</span></span> <span data-ttu-id="e1327-184">如果匿名类型包含任何键属性，仅<xref:System.Object.ToString%2A>被重写。</span><span class="sxs-lookup"><span data-stu-id="e1327-184">If the anonymous type contains no key properties, only <xref:System.Object.ToString%2A> is overridden.</span></span> <span data-ttu-id="e1327-185">显式命名的匿名类型属性不能与这些生成的方法发生冲突。</span><span class="sxs-lookup"><span data-stu-id="e1327-185">Explicitly named properties of an anonymous type cannot conflict with these generated methods.</span></span> <span data-ttu-id="e1327-186">也就是说，不能使用`.Equals`， `.GetHashCode`，或`.ToString`命名属性。</span><span class="sxs-lookup"><span data-stu-id="e1327-186">That is, you cannot use `.Equals`, `.GetHashCode`, or `.ToString` to name a property.</span></span>  
  
 <span data-ttu-id="e1327-187">具有至少一个匿名类型定义的键属性还实现<xref:System.IEquatable%601?displayProperty=nameWithType>接口，其中`T`是匿名类型的类型。</span><span class="sxs-lookup"><span data-stu-id="e1327-187">Anonymous type definitions that have at least one key property also implement the <xref:System.IEquatable%601?displayProperty=nameWithType> interface, where `T` is the type of the anonymous type.</span></span>  
  
 <span data-ttu-id="e1327-188">有关由编译器和重写方法的功能创建的代码的详细信息，请参阅[匿名类型定义](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md)。</span><span class="sxs-lookup"><span data-stu-id="e1327-188">For more information about the code created by the compiler and the functionality of the overridden methods, see [Anonymous Type Definition](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e1327-189">请参阅</span><span class="sxs-lookup"><span data-stu-id="e1327-189">See also</span></span>
- [<span data-ttu-id="e1327-190">对象初始值设定项：命名和匿名类型</span><span class="sxs-lookup"><span data-stu-id="e1327-190">Object Initializers: Named and Anonymous Types</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)
- [<span data-ttu-id="e1327-191">局部类型推理</span><span class="sxs-lookup"><span data-stu-id="e1327-191">Local Type Inference</span></span>](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)
- [<span data-ttu-id="e1327-192">Visual Basic 中的 LINQ 简介</span><span class="sxs-lookup"><span data-stu-id="e1327-192">Introduction to LINQ in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)
- [<span data-ttu-id="e1327-193">如何：推断属性名和匿名类型声明中的类型</span><span class="sxs-lookup"><span data-stu-id="e1327-193">How to: Infer Property Names and Types in Anonymous Type Declarations</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md)
- [<span data-ttu-id="e1327-194">匿名类型定义</span><span class="sxs-lookup"><span data-stu-id="e1327-194">Anonymous Type Definition</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md)
- [<span data-ttu-id="e1327-195">Key</span><span class="sxs-lookup"><span data-stu-id="e1327-195">Key</span></span>](../../../../visual-basic/language-reference/modifiers/key.md)
