---
title: 在 MaskedTextBox 控件中使用正则表达式
ms.date: 07/20/2015
helpviewer_keywords:
- strings [Visual Basic], regular expressions
- strings [Visual Basic], masked edit
ms.assetid: 2a048fb0-7053-487d-b2c5-ffa5e22ed6f9
ms.openlocfilehash: b997f6f495fca51e888bb995fee0361d29d68048
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/12/2020
ms.locfileid: "79148279"
---
# <a name="using-regular-expressions-with-the-maskedtextbox-control-in-visual-basic"></a><span data-ttu-id="2e412-102">在 MaskedTextBox 控件中使用正则表达式 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="2e412-102">Using Regular Expressions with the MaskedTextBox Control in Visual Basic</span></span>
<span data-ttu-id="2e412-103">此示例演示如何转换简单的正则表达式以使用<xref:System.Windows.Forms.MaskedTextBox>控件。</span><span class="sxs-lookup"><span data-stu-id="2e412-103">This example demonstrates how to convert simple regular expressions to work with the <xref:System.Windows.Forms.MaskedTextBox> control.</span></span>  
  
## <a name="description-of-the-masking-language"></a><span data-ttu-id="2e412-104">掩蔽语言的描述</span><span class="sxs-lookup"><span data-stu-id="2e412-104">Description of the Masking Language</span></span>  
 <span data-ttu-id="2e412-105">标准<xref:System.Windows.Forms.MaskedTextBox>掩蔽语言基于 Visual Basic 6.0`Masked Edit`中控件所使用的语言，并且对于从该平台迁移的用户应熟悉。</span><span class="sxs-lookup"><span data-stu-id="2e412-105">The standard <xref:System.Windows.Forms.MaskedTextBox> masking language is based on the one used by the `Masked Edit` control in Visual Basic 6.0 and should be familiar to users migrating from that platform.</span></span>  
  
 <span data-ttu-id="2e412-106">控件<xref:System.Windows.Forms.MaskedTextBox.Mask%2A>的属性<xref:System.Windows.Forms.MaskedTextBox>指定要使用的输入掩码。</span><span class="sxs-lookup"><span data-stu-id="2e412-106">The <xref:System.Windows.Forms.MaskedTextBox.Mask%2A> property of the <xref:System.Windows.Forms.MaskedTextBox> control specifies what input mask to use.</span></span> <span data-ttu-id="2e412-107">掩码必须是由下表中的一个或多个掩蔽元素组成的字符串。</span><span class="sxs-lookup"><span data-stu-id="2e412-107">The mask must be a string composed of one or more of the masking elements from the following table.</span></span>  
  
|<span data-ttu-id="2e412-108">遮蔽元素</span><span class="sxs-lookup"><span data-stu-id="2e412-108">Masking element</span></span>|<span data-ttu-id="2e412-109">说明</span><span class="sxs-lookup"><span data-stu-id="2e412-109">Description</span></span>|<span data-ttu-id="2e412-110">正则表达式元素</span><span class="sxs-lookup"><span data-stu-id="2e412-110">Regular expression element</span></span>|  
|---------------------|-----------------|--------------------------------|  
|<span data-ttu-id="2e412-111">0</span><span class="sxs-lookup"><span data-stu-id="2e412-111">0</span></span>|<span data-ttu-id="2e412-112">0 和 9 之间的任何位数字。</span><span class="sxs-lookup"><span data-stu-id="2e412-112">Any single digit between 0 and 9.</span></span> <span data-ttu-id="2e412-113">需要输入。</span><span class="sxs-lookup"><span data-stu-id="2e412-113">Entry required.</span></span>|<span data-ttu-id="2e412-114">\d</span><span class="sxs-lookup"><span data-stu-id="2e412-114">\d</span></span>|  
|<span data-ttu-id="2e412-115">9</span><span class="sxs-lookup"><span data-stu-id="2e412-115">9</span></span>|<span data-ttu-id="2e412-116">数字或空格。</span><span class="sxs-lookup"><span data-stu-id="2e412-116">Digit or space.</span></span> <span data-ttu-id="2e412-117">条目可选。</span><span class="sxs-lookup"><span data-stu-id="2e412-117">Entry optional.</span></span>|<span data-ttu-id="2e412-118">[d]？</span><span class="sxs-lookup"><span data-stu-id="2e412-118">[ \d]?</span></span>|  
|#|<span data-ttu-id="2e412-119">数字或空格。</span><span class="sxs-lookup"><span data-stu-id="2e412-119">Digit or space.</span></span> <span data-ttu-id="2e412-120">条目可选。</span><span class="sxs-lookup"><span data-stu-id="2e412-120">Entry optional.</span></span> <span data-ttu-id="2e412-121">如果此位置在蒙版中留空，则该位置将呈现为空格。</span><span class="sxs-lookup"><span data-stu-id="2e412-121">If this position is left blank in the mask, it will be rendered as a space.</span></span> <span data-ttu-id="2e412-122">允许加上 （+） 和减 （-） 标志。</span><span class="sxs-lookup"><span data-stu-id="2e412-122">Plus (+) and minus (-) signs are allowed.</span></span>|<span data-ttu-id="2e412-123">[d]-？</span><span class="sxs-lookup"><span data-stu-id="2e412-123">[ \d+-]?</span></span>|  
|<span data-ttu-id="2e412-124">L</span><span class="sxs-lookup"><span data-stu-id="2e412-124">L</span></span>|<span data-ttu-id="2e412-125">ASCII 字母。</span><span class="sxs-lookup"><span data-stu-id="2e412-125">ASCII letter.</span></span> <span data-ttu-id="2e412-126">需要输入。</span><span class="sxs-lookup"><span data-stu-id="2e412-126">Entry required.</span></span>|<span data-ttu-id="2e412-127">[a-zA-Z]</span><span class="sxs-lookup"><span data-stu-id="2e412-127">[a-zA-Z]</span></span>|  
|<span data-ttu-id="2e412-128">?</span><span class="sxs-lookup"><span data-stu-id="2e412-128">?</span></span>|<span data-ttu-id="2e412-129">ASCII 字母。</span><span class="sxs-lookup"><span data-stu-id="2e412-129">ASCII letter.</span></span> <span data-ttu-id="2e412-130">条目可选。</span><span class="sxs-lookup"><span data-stu-id="2e412-130">Entry optional.</span></span>|<span data-ttu-id="2e412-131">[a-zA-Z]？</span><span class="sxs-lookup"><span data-stu-id="2e412-131">[a-zA-Z]?</span></span>|  
|&|<span data-ttu-id="2e412-132">字符。</span><span class="sxs-lookup"><span data-stu-id="2e412-132">Character.</span></span> <span data-ttu-id="2e412-133">需要输入。</span><span class="sxs-lookup"><span data-stu-id="2e412-133">Entry required.</span></span>|<span data-ttu-id="2e412-134">[p]ll_p_l_p_p_Lo_]</span><span class="sxs-lookup"><span data-stu-id="2e412-134">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]</span></span>|  
|<span data-ttu-id="2e412-135">C</span><span class="sxs-lookup"><span data-stu-id="2e412-135">C</span></span>|<span data-ttu-id="2e412-136">字符。</span><span class="sxs-lookup"><span data-stu-id="2e412-136">Character.</span></span> <span data-ttu-id="2e412-137">条目可选。</span><span class="sxs-lookup"><span data-stu-id="2e412-137">Entry optional.</span></span>|<span data-ttu-id="2e412-138">[p]ll_p_l_p_l_p_Lo_？</span><span class="sxs-lookup"><span data-stu-id="2e412-138">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]?</span></span>|  
|<span data-ttu-id="2e412-139">A</span><span class="sxs-lookup"><span data-stu-id="2e412-139">A</span></span>|<span data-ttu-id="2e412-140">字母。</span><span class="sxs-lookup"><span data-stu-id="2e412-140">Alphanumeric.</span></span> <span data-ttu-id="2e412-141">条目可选。</span><span class="sxs-lookup"><span data-stu-id="2e412-141">Entry optional.</span></span>|<span data-ttu-id="2e412-142">\W</span><span class="sxs-lookup"><span data-stu-id="2e412-142">\W</span></span>|  
|<span data-ttu-id="2e412-143">.</span><span class="sxs-lookup"><span data-stu-id="2e412-143">.</span></span>|<span data-ttu-id="2e412-144">适合区域性的小数位符。</span><span class="sxs-lookup"><span data-stu-id="2e412-144">Culture-appropriate decimal placeholder.</span></span>|<span data-ttu-id="2e412-145">不可用。</span><span class="sxs-lookup"><span data-stu-id="2e412-145">Not available.</span></span>|  
|<span data-ttu-id="2e412-146">,</span><span class="sxs-lookup"><span data-stu-id="2e412-146">,</span></span>|<span data-ttu-id="2e412-147">文化适当的数千个占位符。</span><span class="sxs-lookup"><span data-stu-id="2e412-147">Culture-appropriate thousands placeholder.</span></span>|<span data-ttu-id="2e412-148">不可用。</span><span class="sxs-lookup"><span data-stu-id="2e412-148">Not available.</span></span>|  
|<span data-ttu-id="2e412-149">:</span><span class="sxs-lookup"><span data-stu-id="2e412-149">:</span></span>|<span data-ttu-id="2e412-150">适合区域性的时间分隔符。</span><span class="sxs-lookup"><span data-stu-id="2e412-150">Culture-appropriate time separator.</span></span>|<span data-ttu-id="2e412-151">不可用。</span><span class="sxs-lookup"><span data-stu-id="2e412-151">Not available.</span></span>|  
|/|<span data-ttu-id="2e412-152">适合区域性的日期分隔符。</span><span class="sxs-lookup"><span data-stu-id="2e412-152">Culture-appropriate date separator.</span></span>|<span data-ttu-id="2e412-153">不可用。</span><span class="sxs-lookup"><span data-stu-id="2e412-153">Not available.</span></span>|  
|$|<span data-ttu-id="2e412-154">文化适当的货币符号。</span><span class="sxs-lookup"><span data-stu-id="2e412-154">Culture-appropriate currency symbol.</span></span>|<span data-ttu-id="2e412-155">不可用。</span><span class="sxs-lookup"><span data-stu-id="2e412-155">Not available.</span></span>|  
|\<|<span data-ttu-id="2e412-156">将以下所有字符转换为小写。</span><span class="sxs-lookup"><span data-stu-id="2e412-156">Converts all characters that follow to lowercase.</span></span>|<span data-ttu-id="2e412-157">不可用。</span><span class="sxs-lookup"><span data-stu-id="2e412-157">Not available.</span></span>|  
|>|<span data-ttu-id="2e412-158">将随后的所有字符转换为大写。</span><span class="sxs-lookup"><span data-stu-id="2e412-158">Converts all characters that follow to uppercase.</span></span>|<span data-ttu-id="2e412-159">不可用。</span><span class="sxs-lookup"><span data-stu-id="2e412-159">Not available.</span></span>|  
|<span data-ttu-id="2e412-160">&#124;</span><span class="sxs-lookup"><span data-stu-id="2e412-160">&#124;</span></span>|<span data-ttu-id="2e412-161">撤消上一个移位或向下移动。</span><span class="sxs-lookup"><span data-stu-id="2e412-161">Undoes a previous shift up or shift down.</span></span>|<span data-ttu-id="2e412-162">不可用。</span><span class="sxs-lookup"><span data-stu-id="2e412-162">Not available.</span></span>|  
|<span data-ttu-id="2e412-163">&#92;</span><span class="sxs-lookup"><span data-stu-id="2e412-163">&#92;</span></span>|<span data-ttu-id="2e412-164">转义蒙版字符，将其转换为文本。</span><span class="sxs-lookup"><span data-stu-id="2e412-164">Escapes a mask character, turning it into a literal.</span></span> <span data-ttu-id="2e412-165">""\\\\是反斜杠的转义序列。</span><span class="sxs-lookup"><span data-stu-id="2e412-165">"\\\\" is the escape sequence for a backslash.</span></span>|<span data-ttu-id="2e412-166">&#92;</span><span class="sxs-lookup"><span data-stu-id="2e412-166">&#92;</span></span>|  
|<span data-ttu-id="2e412-167">所有其他字符。</span><span class="sxs-lookup"><span data-stu-id="2e412-167">All other characters.</span></span>|<span data-ttu-id="2e412-168">文字。</span><span class="sxs-lookup"><span data-stu-id="2e412-168">Literals.</span></span> <span data-ttu-id="2e412-169">所有非掩码元素都将在 中<xref:System.Windows.Forms.MaskedTextBox>显示为自身。</span><span class="sxs-lookup"><span data-stu-id="2e412-169">All non-mask elements will appear as themselves within <xref:System.Windows.Forms.MaskedTextBox>.</span></span>|<span data-ttu-id="2e412-170">所有其他字符。</span><span class="sxs-lookup"><span data-stu-id="2e412-170">All other characters.</span></span>|  
  
 <span data-ttu-id="2e412-171">十进制 （.）、千分之一 （、时间（:)、日期 （/） 和货币 （$） 符号默认显示应用程序区域性定义的这些符号。</span><span class="sxs-lookup"><span data-stu-id="2e412-171">The decimal (.), thousandths (,), time (:), date (/), and currency ($) symbols default to displaying those symbols as defined by the application's culture.</span></span> <span data-ttu-id="2e412-172">可以使用<xref:System.Windows.Forms.MaskedTextBox.FormatProvider%2A>属性强制它们显示其他区域性的符号。</span><span class="sxs-lookup"><span data-stu-id="2e412-172">You can force them to display symbols for another culture by using the <xref:System.Windows.Forms.MaskedTextBox.FormatProvider%2A> property.</span></span>  
  
## <a name="regular-expressions-and-masks"></a><span data-ttu-id="2e412-173">正则表达式和蒙版</span><span class="sxs-lookup"><span data-stu-id="2e412-173">Regular Expressions and Masks</span></span>  
 <span data-ttu-id="2e412-174">尽管可以使用正则表达式和蒙版来验证用户输入，但它们并不完全等效。</span><span class="sxs-lookup"><span data-stu-id="2e412-174">Although you can use regular expressions and masks to validate user input, they are not completely equivalent.</span></span> <span data-ttu-id="2e412-175">正则表达式可以表达比蒙版更复杂的模式，但蒙版可以更简洁地以与文化相关的格式表达相同的信息。</span><span class="sxs-lookup"><span data-stu-id="2e412-175">Regular expressions can express more complex patterns than masks, but masks can express the same information more succinctly and in a culturally relevant format.</span></span>  
  
 <span data-ttu-id="2e412-176">下表比较了四个正则表达式和每个表达式的等效掩码。</span><span class="sxs-lookup"><span data-stu-id="2e412-176">The following table compares four regular expressions and the equivalent mask for each.</span></span>  
  
|<span data-ttu-id="2e412-177">Regular Expression</span><span class="sxs-lookup"><span data-stu-id="2e412-177">Regular Expression</span></span>|<span data-ttu-id="2e412-178">Mask</span><span class="sxs-lookup"><span data-stu-id="2e412-178">Mask</span></span>|<span data-ttu-id="2e412-179">说明</span><span class="sxs-lookup"><span data-stu-id="2e412-179">Notes</span></span>|  
|------------------------|----------|-----------|  
|`\d{2}/\d{2}/\d{4}`|`00/00/0000`|<span data-ttu-id="2e412-180">掩`/`码中的字符是逻辑日期分隔符，在用户看来，它将显示为适合应用程序当前区域性的日期分隔符。</span><span class="sxs-lookup"><span data-stu-id="2e412-180">The `/` character in the mask is a logical date separator, and it will appear to the user as the date separator appropriate to the application's current culture.</span></span>|  
|`\d{2}-[A-Z][a-z]{2}-\d{4}`|`00->L<LL-0000`|<span data-ttu-id="2e412-181">以美国格式显示三个字母的月缩写的日期（天、月缩写和年份），其中以大写字母后跟两个小写字母显示。</span><span class="sxs-lookup"><span data-stu-id="2e412-181">A date (day, month abbreviation, and year) in United States format in which the three-letter month abbreviation is displayed with an initial uppercase letter followed by two lowercase letters.</span></span>|  
|`(\(\d{3}\)-)?\d{3}-d{4}`|`(999)-000-0000`|<span data-ttu-id="2e412-182">美国电话号码，区号可选。</span><span class="sxs-lookup"><span data-stu-id="2e412-182">United States phone number, area code optional.</span></span> <span data-ttu-id="2e412-183">如果用户不希望输入可选字符，他们可以输入空格或将鼠标指针直接放在由前 0 表示的蒙版中的位置。</span><span class="sxs-lookup"><span data-stu-id="2e412-183">If the user does not wish to enter the optional characters, they can either enter spaces or place the mouse pointer directly at the position in the mask represented by the first 0.</span></span>|  
|`$\d{6}.00`|`$999,999.00`|<span data-ttu-id="2e412-184">0 到 999999 范围内的货币值。</span><span class="sxs-lookup"><span data-stu-id="2e412-184">A currency value in the range of 0 to 999999.</span></span> <span data-ttu-id="2e412-185">货币、千分之和十进制字符将在运行时替换为特定于区域性的等效字符。</span><span class="sxs-lookup"><span data-stu-id="2e412-185">The currency, thousandth, and decimal characters will be replaced at run time with their culture-specific equivalents.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="2e412-186">另请参阅</span><span class="sxs-lookup"><span data-stu-id="2e412-186">See also</span></span>

- <xref:System.Windows.Forms.MaskedTextBox.Mask%2A>
- <xref:System.Windows.Forms.MaskedTextBox>
- [<span data-ttu-id="2e412-187">验证字符串 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="2e412-187">Validating Strings in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/strings/validating-strings.md)
- [<span data-ttu-id="2e412-188">MaskedTextBox 控件</span><span class="sxs-lookup"><span data-stu-id="2e412-188">MaskedTextBox Control</span></span>](../../../../framework/winforms/controls/maskedtextbox-control-windows-forms.md)
